{"config":{"lang":["de"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Ta-SIEMPlus Dokumentation","text":"<p>Operative Dokumentation f\u00fcr standardisierte Wazuh SIEM Wartungsabl\u00e4ufe. Reproduzierbar \u00b7 Auditierbar \u00b7 Operator-freundlich</p>"},{"location":"#einstieg","title":"Einstieg","text":"Beschreibung Erste Schritte Schritt-f\u00fcr-Schritt f\u00fcr alle Haupt-Szenarien Installation Setup-Anleitung (Web / Docker / Python) Schnellreferenz Copy-Paste Befehle &amp; Health Checks Projekt\u00fcbersicht Visuelle Karte durch alle Ressourcen"},{"location":"#inhalte","title":"Inhalte","text":"Bereich Beschreibung Overview Architekturprinzipien &amp; Workflow-\u00dcbersicht Runbooks Detaillierte SOPs (Upgrade, Agent Groups) Checklists Change-Management-Checklisten Upgrade Guides Versionsspezifische Upgrade-Prozeduren Anleitungen How-To f\u00fcr Checklisten &amp; Katalog Referenz Deployment &amp; Versioning Katalog Kunden- &amp; Infrastruktur-Registry Templates Dokumentationsvorlagen Config Templates Bef\u00fcllbare Konfigurationsvorlagen mit <code>{{ VARIABLE }}</code>-Syntax"},{"location":"#kernprinzipien","title":"Kernprinzipien","text":"<p>No-Go Gates \u2013 Obligatorische Stopkriterien:</p> <ul> <li>Disk-Belegung &gt; 90% \u2192 STOP</li> <li>Services nicht <code>active (running)</code> \u2192 STOP</li> <li>Kein Backup/Snapshot \u2192 STOP</li> <li>Change nicht genehmigt \u2192 STOP</li> </ul> <p>Health Snapshots \u2013 Systemzustand vor und nach jeder \u00c4nderung dokumentieren.</p> <p>Secrets \u2013 Niemals direkt im Repository. Immer <code>vault://pfad/zum/secret</code> verwenden.</p> <p>Lizenz: MIT | Repository: istagmbh/Ta-SIEMPlus</p>"},{"location":"getting-started/","title":"\ud83d\ude80 GETTING STARTED \u2013 Dein Einstieg in Ta-SIEMPlus","text":"<p>Willkommen! Dieses Dokument f\u00fchrt dich Schritt f\u00fcr Schritt durch die wichtigsten Szenarien.</p>"},{"location":"getting-started/#hauptzugriff-web-formulare-neu","title":"\ud83c\udf10 Hauptzugriff: Web-Formulare (NEU!)","text":"<p>\u2728 Alle Werkzeuge sind jetzt \u00fcber interaktive Web-Formulare zug\u00e4nglich!</p>"},{"location":"getting-started/#schnellstart-2-minuten","title":"Schnellstart (2 Minuten)","text":"<pre><code># 1. Repository klonen (falls noch nicht geschehen)\ngit clone https://github.com/istagmbh/Ta-SIEMPlus.git\ncd Ta-SIEMPlus\n\n# 2. Web-Formulare \u00f6ffnen\nopen webforms/index.html  # Mac\nxdg-open webforms/index.html  # Linux\nstart webforms\\index.html  # Windows\n</code></pre>"},{"location":"getting-started/#verfugbare-web-tools","title":"Verf\u00fcgbare Web-Tools","text":"<ul> <li>\ud83d\udd04 Upgrade-Formular - Wazuh AIO Upgrades mit PDF-Export</li> <li>\u2705 Checklisten-Generator - Individuelle Checklisten</li> <li>\ud83d\udc65 Agent-Verwaltung - Befehls-Generator f\u00fcr Agenten</li> <li>\ud83d\udccb Wartungsprotokoll - Strukturierte Dokumentation</li> </ul> <p>Vorteile der Web-Formulare: - \u2705 Keine Installation oder Setup notwendig - \u2705 Funktioniert offline im Browser - \u2705 Automatische Befehlsgenerierung - \u2705 PDF-Export f\u00fcr Dokumentation - \u2705 Copy-Paste freundliche Kommandos - \u2705 Persistente Datenspeicherung (LocalStorage)</p>"},{"location":"getting-started/#neu-hier-installationsanleitung","title":"\ud83d\udce6 Neu hier? Installationsanleitung","text":"<p>Falls du Ta-SIEMPlus zum ersten Mal einrichtest:</p> <p>\u2192 \ud83d\udce6 Siehe INSTALLATION.md f\u00fcr eine komplette Setup-Anleitung</p>"},{"location":"getting-started/#was-brauchst-du","title":"\u2753 Was Brauchst Du?","text":"<p>Klicke auf dein Szenario, um die richtige Anleitung zu finden:</p>"},{"location":"getting-started/#1-ich-fuhre-ein-wazuh-upgrade-durch-upgrade-prozess","title":"1\ufe0f\u20e3 Ich f\u00fchre ein Wazuh-Upgrade durch \u2192 \ud83d\udc49 Upgrade-Prozess","text":""},{"location":"getting-started/#2-ich-verwalte-agentengruppen-agentengruppen","title":"2\ufe0f\u20e3 Ich verwalte Agentengruppen \u2192 \ud83d\udc49 Agentengruppen","text":""},{"location":"getting-started/#3-ich-registriere-einen-neuen-kunden-kundeneintrag-erstellen","title":"3\ufe0f\u20e3 Ich registriere einen neuen Kunden \u2192 \ud83d\udc49 Kundeneintrag erstellen","text":""},{"location":"getting-started/#4-ich-habe-ein-problem-beim-upgrade-troubleshooting","title":"4\ufe0f\u20e3 Ich habe ein Problem beim Upgrade \u2192 \ud83d\udc49 Troubleshooting","text":""},{"location":"getting-started/#5-ich-mochte-ein-runbookeine-checkliste-andern-beitragen","title":"5\ufe0f\u20e3 Ich m\u00f6chte ein Runbook/eine Checkliste \u00e4ndern \u2192 \ud83d\udc49 Beitragen","text":""},{"location":"getting-started/#6-ich-bin-neu-und-will-das-projekt-verstehen-uberblick","title":"6\ufe0f\u20e3 Ich bin neu und will das Projekt verstehen \u2192 \ud83d\udc49 \u00dcberblick","text":""},{"location":"getting-started/#upgrade-prozess","title":"\ud83d\udd04 UPGRADE-PROZESS","text":""},{"location":"getting-started/#schritt-1-wahle-deinen-ansatz","title":"Schritt 1: W\u00e4hle deinen Ansatz","text":"<p>Du kannst einen Upgrade 3 Wege dokumentieren:</p>"},{"location":"getting-started/#weg-a-web-formular-empfohlen-schnell-modern","title":"Weg A: Web-Formular (Empfohlen - Schnell &amp; Modern)","text":"<ul> <li>\u2705 \u00d6ffne das interaktive Formular: webforms/upgrade-form.html</li> <li>\u2705 F\u00fclle Felder aus, generiere Befehle automatisch</li> <li>\u2705 Exportiere als PDF f\u00fcr Dokumentation</li> <li>\u2705 Keine Installation n\u00f6tig, funktioniert offline</li> <li>\u2705 Persistente Speicherung im Browser</li> </ul> <p>Workflow: 1. \u00d6ffne <code>webforms/upgrade-form.html</code> im Browser 2. F\u00fclle Metadaten aus (Kunde, Infrastruktur, Versionen, etc.) 3. Folge den 5 Schritten mit automatischer Befehlsgenerierung 4. F\u00fchre Health Checks durch 5. Exportiere PDF f\u00fcr Ticket-Dokumentation</p>"},{"location":"getting-started/#weg-b-markdown-checkliste-fur-ticket-systeme","title":"Weg B: Markdown Checkliste (F\u00fcr Ticket-Systeme)","text":"<ul> <li>Kopiere die Checkliste direkt ins Change-Ticket</li> <li>Arbeite Schritt-f\u00fcr-Schritt ab mit Runbook-Referenzen</li> <li>Versionskontrolle via Git</li> <li>Datei: checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md</li> </ul>"},{"location":"getting-started/#weg-c-mkdocs-dokumentation-fur-teams","title":"Weg C: MkDocs Dokumentation (F\u00fcr Teams)","text":"<ul> <li>Vollst\u00e4ndige, durchsuchbare Dokumentation</li> <li>Docker-basiertes Deployment</li> <li>Versionierung und Navigation</li> <li>Start: <code>docker-compose up -d</code> \u2192 http://localhost:8080</li> </ul> <p>\u2192 Wir empfehlen: Weg A (Web-Formular) f\u00fcr neue Nutzer und schnelle Erfassung.</p>"},{"location":"getting-started/#schritt-2-metadaten-vorbereiten","title":"Schritt 2: Metadaten vorbereiten","text":"<p>Du brauchst diese Informationen f\u00fcr dein Change-Ticket:</p> <pre><code>Operator:              David Dutler / Ivan Stricker\nKunde:                 z.B. DeepCloud AG\nInfrastruktur:         z.B. DeepInfra\nChange-Ticket-ID:      z.B. CHG-2026-00123\nWartungsfenster:       YYYY-MM-DD HH:MM - YYYY-MM-DD HH:MM (Europe/Zurich)\nIst-Version:           z.B. 4.9.0\nZiel-Version:          z.B. 4.12.0\nSnapshot/Backup-ID:    z.B. snap-0123456789abcdef0\n</code></pre> <p>\ud83d\udca1 Tipp: Diese Infos findest du in <code>Catalog/CUSTOMERS.md</code></p>"},{"location":"getting-started/#automatisches-ausfullen-im-web-formular","title":"\ud83d\udcab Automatisches Ausf\u00fcllen im Web-Formular","text":"<p>Das Web-Formular bietet automatische Metadaten-Verwaltung: - Trage die Metadaten im ersten Schritt ein - Das Formular speichert die Daten automatisch im Browser (LocalStorage) - Alle Schritte werden automatisch vorausgef\u00fcllt - Die Daten bleiben auch nach Browser-Neustart erhalten - PDF-Export enth\u00e4lt alle Metadaten automatisch</p>"},{"location":"getting-started/#schritt-3-formular-ausfullen-befehle-ausfuhren","title":"Schritt 3: Formular ausf\u00fcllen &amp; Befehle ausf\u00fchren","text":""},{"location":"getting-started/#option-a-web-formular-empfohlen","title":"OPTION A: Web-Formular (empfohlen)","text":"<ol> <li>\u00d6ffne im Browser:    <pre><code>webforms/upgrade-form.html\n</code></pre></li> <li>F\u00fclle das Formular Schritt f\u00fcr Schritt aus:</li> <li>Schritt 1: Metadaten &amp; Pre-Flight Checks</li> <li>Schritt 2: Service-Stop &amp; Backup</li> <li>Schritt 3: Package-Upgrade</li> <li>Schritt 4: Service-Start &amp; Validation</li> <li>Schritt 5: Post-Checks &amp; Documentation</li> <li>Kopiere die generierten Befehle</li> <li>F\u00fchre sie auf dem Server aus</li> <li>Klicke \"PDF generieren\" f\u00fcr die Dokumentation</li> </ol>"},{"location":"getting-started/#option-b-markdown-checkliste","title":"OPTION B: Markdown Checkliste","text":"<ol> <li>\u00d6ffne die Datei:    <pre><code>checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md\n</code></pre></li> <li>Kopiere den kompletten Inhalt (\u2318C oder Strg+C)</li> <li>F\u00fcge ihn in dein Change-Ticket ein</li> <li>Trage alle Metadaten-Felder ein (siehe Schritt 2)</li> <li>Arbeite die Checkliste Punkt f\u00fcr Punkt ab</li> </ol> <p>\u2192 Welche Option passt zu dir? - Web-Formular: Schnell, modern, PDF-Export \u2705 - Markdown-Checkliste: Git-Versioniert, Ticket-System-freundlich \u2705</p>"},{"location":"getting-started/#schritt-4-pre-go-checken-kritisch","title":"Schritt 4: Pre-Go Checken (Kritisch!)","text":"<p>Arbeite die Pre-Flight Checks ab (in Schritt 1 des Web-Formulars oder Abschnitt B der Checkliste). </p> <p>Wenn auch nur EINE Box nicht \u2713 ist:</p> <p>\u26d4 STOPP \u2013 Upgrade verschieben!</p> <p>Kritische No-Go Gates: - \u274c Disk-Belegung &gt; 90% - \u274c Services nicht <code>active (running)</code> - \u274c Kein Backup/Snapshot vorhanden - \u274c Change nicht genehmigt - \u274c Au\u00dferhalb Wartungsfenster</p>"},{"location":"getting-started/#schritt-5-befehle-ausfuhren","title":"Schritt 5: Befehle ausf\u00fchren","text":"<p>F\u00fcr jeden Punkt:</p> <ol> <li>Lies die Anweisung (im Web-Formular oder in der Checkliste)</li> <li>Kopiere den Befehl (automatisch generiert im Web-Formular, oder aus Runbook)</li> <li>F\u00fchre ihn auf dem Server aus</li> <li>Validiere das Ergebnis</li> <li>Hake die Box ab (im Formular oder <code>[x]</code> in Checkliste)</li> </ol> <p>\ud83d\udca1 Tipp: Nutze das Upgrade Runbook parallel f\u00fcr detaillierte Befehle und Troubleshooting.</p>"},{"location":"getting-started/#schritt-6-health-snapshots-dokumentieren","title":"Schritt 6: Health Snapshots dokumentieren","text":"<p>Vor dem Upgrade: - Im Web-Formular: F\u00fclle \"Pre-Upgrade Health Check\" in Schritt 1 aus - In Markdown: F\u00fchre die Befehle aus Abschnitt 1 des Runbooks aus</p> <p><pre><code># Kopiere diesen Befehl:\ndate -Is &amp;&amp; systemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat &amp;&amp; dpkg -l | grep -E 'wazuh|filebeat'\n</code></pre> \u2192 Speichere die Ausgabe (im Formular-Feld oder im Change-Ticket)</p> <p>Nach dem Upgrade: - Im Web-Formular: F\u00fclle \"Post-Upgrade Health Check\" in Schritt 5 aus - In Markdown: F\u00fchre denselben Befehl nochmal aus \u2192 Vergleiche die Ausgaben</p>"},{"location":"getting-started/#schritt-7-bei-problemen-rollback","title":"Schritt 7: Bei Problemen \u2192 Rollback","text":"<p>Wenn etwas schiefgeht:</p> <ol> <li>Gehe zu \"Rollback\"-Abschnitt (im Web-Formular oder Abschnitt E der Checkliste)</li> <li>Folge den Rollback-Anweisungen</li> <li>Dokumentiere was schief ging im Change-Ticket</li> <li>Erstelle ein Incident-Ticket</li> </ol> <p>\ud83d\udca1 Siehe auch: Runbook Abschnitt 10 - Rollback</p>"},{"location":"getting-started/#agentengruppen-verwalten","title":"\ud83d\udc65 AGENTENGRUPPEN-VERWALTEN","text":""},{"location":"getting-started/#was-sind-agentengruppen","title":"Was sind Agentengruppen?","text":"<p>Wazuh Agentengruppen erm\u00f6glichen die zentrale Verwaltung von Agent-Konfigurationen.  Agenten k\u00f6nnen einer oder mehreren Gruppen zugeordnet werden und erhalten automatisch  die kombinierten Konfigurationen aller Gruppen.</p>"},{"location":"getting-started/#schnellstart","title":"Schnellstart","text":"<p>1. Web-Formular \u00f6ffnen (Empfohlen): <pre><code>\u00d6ffne: webforms/agent-management.html\n</code></pre></p> <p>Das Web-Formular bietet: - \u2705 Interaktive Befehlsgenerierung f\u00fcr alle Operationen - \u2705 7 vordefinierte Beispiele zum Kopieren - \u2705 Erkl\u00e4rungen zu merged.mg und ar.conf - \u2705 Copy-Paste freundliche Kommandos - \u2705 Keine Installation n\u00f6tig</p> <p>Verf\u00fcgbare Operationen: 1. Gruppe erstellen 2. Agent zu Gruppe hinzuf\u00fcgen 3. Agent aus Gruppe entfernen 4. Gruppen auflisten 5. Agenten einer Gruppe anzeigen 6. Multi-Gruppen Zuweisung 7. Gruppen-Konfiguration anzeigen</p> <p>2. Oder nutze die Kommandozeile direkt:</p> <pre><code># Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g linux-servers\n\n# Agent zu Gruppe hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i 001 -g linux-servers\n\n# Alle Gruppen auflisten\n/var/ossec/bin/agent_groups -l\n\n# Agent zu mehreren Gruppen (Multi-Gruppen)\n/var/ossec/bin/agent_groups -a -i 002 -g linux-servers,web-servers,prod\n</code></pre>"},{"location":"getting-started/#detaillierte-dokumentation","title":"Detaillierte Dokumentation","text":"<p>F\u00fcr mehr Details: - \ud83c\udf10 Web-Tool: webforms/agent-management.html - Interaktives Formular (NEU!) - \ud83d\udcd8 Runbook: runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT.md - Vollst\u00e4ndige Dokumentation - \u26a1 Quick Reference: QUICK_REFERENCE.md - Alle Befehle auf einen Blick</p>"},{"location":"getting-started/#neuer-kunde","title":"\ud83d\udc64 NEUER KUNDE","text":""},{"location":"getting-started/#schritt-1-kundendaten-sammeln","title":"Schritt 1: Kundendaten sammeln","text":"<p>Du brauchst: <pre><code>Kundenname:          z.B. DeepCloud AG\nInfrastruktur-Name:  z.B. DeepInfra\nUmgebung:            prod / test / dev\nWazuh-Typ:           Ubuntu AIO (APT) / Docker / etc.\nHaupt-Host FQDN:     z.B. wazuh01.example.tld\nManagement-IP:       z.B. 10.10.10.10\nDashboard-URL:       https://wazuh01.example.tld\nAPI-URL:             https://wazuh01.example.tld:55000\nIndexer-URL:         https://wazuh01.example.tld:9200\n</code></pre></p>"},{"location":"getting-started/#schritt-2-eintrag-hinzufugen","title":"Schritt 2: Eintrag hinzuf\u00fcgen","text":"<ol> <li> <p>\u00d6ffne: <code>Catalog/CUSTOMERS.md</code></p> </li> <li> <p>Scrolle ans Ende der Datei</p> </li> <li> <p>Kopiere den YAML-Template-Block (dort zu finden)</p> </li> <li> <p>Ersetze alle UNSET-Werte mit echten Daten:</p> </li> </ol> <pre><code>customer: \"DeepCloud AG\"              # \u2190 Kundenname\ninfrastructure: \"DeepInfra\"           # \u2190 Infrastruktur\nenvironment: \"prod\"                   # \u2190 prod/test/dev\nwazuh_type: \"Ubuntu AIO (APT)\"        # \u2190 Installationstyp\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"wazuh01.example.tld\"       # \u2190 Hostname\n    mgmt_ip: \"10.10.10.10\"            # \u2190 Management-IP\nurls:\n  dashboard: \"https://wazuh01.example.tld\"\n  api: \"https://wazuh01.example.tld:55000\"\n  indexer: \"https://wazuh01.example.tld:9200\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nsecrets_ref:\n  admin_user: \"vault://deepcloud/wazuh/admin_user\"\n  admin_password: \"vault://deepcloud/wazuh/admin_password\"\nchange_policy: \"Within business hours (08:00 - 17:00 CET)\"\ncontact_email: \"siem-team@deepcloud.example.tld\"\n</code></pre> <p>\u26a0\ufe0f WICHTIG: Keine echten Passw\u00f6rter eintragen! Nur <code>vault://...</code> Pfade!</p>"},{"location":"getting-started/#schritt-3-anderung-einreichen","title":"Schritt 3: \u00c4nderung einreichen","text":"<pre><code># Terminal-Befehle zum Einreichen (Copy-Paste):\ngit checkout -b add/customer-deepcloud\ngit add Catalog/CUSTOMERS.md\ngit commit -m \"catalog: Add DeepCloud AG infrastructure entry\"\ngit push origin add/customer-deepcloud\n</code></pre> <p>Dann: Pull Request erstellen und warten auf Review \u2705</p>"},{"location":"getting-started/#troubleshooting","title":"\ud83d\udd27 TROUBLESHOOTING","text":""},{"location":"getting-started/#problem-service-startet-nicht-nach-upgrade","title":"Problem: Service startet nicht nach Upgrade","text":"<ol> <li> <p>Gehe zu Abschnitt 11 im Runbook: <pre><code>runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md \u2192 Troubleshooting\n</code></pre></p> </li> <li> <p>F\u00fchre die Diagnose-Befehle aus (alle grau hinterlegt)</p> </li> <li> <p>Wenn es nicht hilft:</p> </li> <li>\u2705 Lies die Wazuh offizielle Dokumentation</li> <li>\u2705 Erstelle ein Incident-Ticket</li> <li>\u2705 Kontaktiere das Support-Team</li> </ol>"},{"location":"getting-started/#problem-upgrade-abbruch-rollback-notwendig","title":"Problem: Upgrade-Abbruch (Rollback notwendig)","text":"<p>Folge Abschnitt 10 des Runbooks: \"Rollback / Notfall\"</p>"},{"location":"getting-started/#contribution-anderungen","title":"\ud83d\udca1 CONTRIBUTION (\u00c4nderungen)","text":""},{"location":"getting-started/#ich-mochte-ein-runbook-andern","title":"Ich m\u00f6chte ein Runbook \u00e4ndern","text":"<ol> <li>\u00d6ffne die Datei (z.B. <code>runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md</code>)</li> <li>Mache deine \u00c4nderung</li> <li>Dokumentiere das Warum:</li> <li>Begr\u00fcndung?</li> <li>Welche Risiken?</li> <li>Wie rollback?</li> <li>Erstelle einen Pull Request: <pre><code>git checkout -b fix/upgrade-runbook-xyz\ngit add runbooks/RUNBOOK_*.md\ngit commit -m \"fix: Correct command for service restart (because: Wazuh 4.12 requires...)\"\ngit push origin fix/upgrade-runbook-xyz\n</code></pre></li> <li>Warte auf Review (min. 1 Person muss zustimmen)</li> </ol> <p>\ud83d\udc40 Siehe auch: CONTRIBUTING.md</p>"},{"location":"getting-started/#uberblick-projektstruktur","title":"\ud83d\udcda \u00dcBERBLICK (Projektstruktur)","text":"<pre><code>Ta-SIEMPlus/\n\u251c\u2500\u2500 README.md                          \u2190 Projekt-\u00dcbersicht\n\u251c\u2500\u2500 GETTING_STARTED.md                 \u2190 DU BIST HIER \ud83d\udc48\n\u251c\u2500\u2500 QUICK_REFERENCE.md                 \u2190 Schnelle Lookups\n\u2502\n\u251c\u2500\u2500 runbooks/                          \u2190 Detaillierte Anleitungen\n\u2502   \u251c\u2500\u2500 RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md\n\u2502   \u2514\u2500\u2500 RUNBOOK-TEMPLATE.md\n\u2502\n\u251c\u2500\u2500 checklists/                        \u2190 Ticket-Checklisten\n\u2502   \u251c\u2500\u2500 CHECKLIST_WAZUH_UPGRADE_AIO.md\n\u2502   \u2514\u2500\u2500 CHECKLIST-TEMPLATE.md\n\u2502\n\u251c\u2500\u2500 Catalog/                           \u2190 Kunden-Registry\n\u2502   \u2514\u2500\u2500 CUSTOMERS.md\n\u2502\n\u251c\u2500\u2500 templates/                         \u2190 Vorlagen\n\u2502   \u2514\u2500\u2500 CHANGE_NOTE_TEMPLATE.md\n\u2502\n\u251c\u2500\u2500 docs/                              \u2190 Web-Tools\n\u2502   \u251c\u2500\u2500 index.html                     \u2190 \u00dcbersicht\n\u2502   \u251c\u2500\u2500 maintenance-form.html          \u2190 Digitales Formular\n\u2502   \u2514\u2500\u2500 README.md\n\u2502\n\u2514\u2500\u2500 CONTRIBUTING.md                    \u2190 Governance\n</code></pre> <p>Welche Datei f\u00fcr was?</p> Szenario Datei Upgrade durchf\u00fchren Checkliste + Runbook Neuen Kunden hinzuf\u00fcgen Catalog/CUSTOMERS.md Befehle verstehen Runbooks Prozess dokumentieren Templates \u00c4nderung einreichen CONTRIBUTING.md"},{"location":"getting-started/#schnelle-hilfe","title":"\ud83c\udd98 Schnelle Hilfe","text":"Frage Antwort Wie starte ich ein Upgrade? \ud83d\udc46 Oben: Upgrade-Prozess Wo finde ich Befehle? <code>runbooks/RUNBOOK_*.md</code> (grau hinterlegte Felder) Darf ich Passw\u00f6rter eintragen? \u274c NEIN! Nur <code>vault://...</code> Referenzen Ich bin fertig \u2013 was nun? \u00dcberpr\u00fcfe: \u2705 Alle Checkboxen? \u2705 Health Snapshots dokumentiert? \u2705 Kunden informiert? Wer kann \u00c4nderungen genehmigen? Mindestens 1 Reviewer (siehe CONTRIBUTING.md)"},{"location":"getting-started/#nachste-schritte","title":"\u2705 N\u00e4chste Schritte","text":"<p>\u2192 Suchst du einen bestimmten Workflow? Gehe zur\u00fcck nach oben und klicke auf dein Szenario.</p> <p>\u2192 Brauchst du schnelle Befehle? Siehe: QUICK_REFERENCE.md</p> <p>\u2192 Du willst beitragen? Lese: CONTRIBUTING.md</p> <p>Fragen? \u00d6ffne ein Issue oder kontaktiere das Team! \ud83d\udc4b</p>"},{"location":"installation/","title":"\ud83d\udce6 Installation &amp; Setup Guide","text":"<p>Dieses Dokument beschreibt die Installation und Inbetriebnahme von Ta-SIEMPlus.</p>"},{"location":"installation/#uberblick","title":"\ud83d\udccb \u00dcberblick","text":"<p>Ta-SIEMPlus ist ein dokumentationsbasiertes System - es erfordert keine Installation im traditionellen Sinne. Allerdings gibt es verschiedene Nutzungsszenarien, f\u00fcr die unterschiedliche Setup-Schritte erforderlich sind.</p> <p>W\u00e4hlen Sie Ihr Szenario: - \ud83c\udf10 Option A: Web-Interface (Empfohlen) - F\u00fcr interaktive Nutzung mit Formularen - \ud83d\udcdd Option B: Markdown-Only - F\u00fcr direkten Zugriff auf Markdown-Dateien - \ud83d\udc33 Option C: Docker Deployment - F\u00fcr Team-/Produktiv-Nutzung</p>"},{"location":"installation/#systemvoraussetzungen","title":"\ud83c\udfaf Systemvoraussetzungen","text":""},{"location":"installation/#minimale-anforderungen-markdown-only","title":"Minimale Anforderungen (Markdown-Only)","text":"<ul> <li>Git (Version 2.x oder h\u00f6her)</li> <li>Texteditor (VS Code, Sublime, Vim, etc.)</li> <li>Markdown-Viewer (optional, aber empfohlen)</li> </ul>"},{"location":"installation/#erweiterte-anforderungen-web-interface","title":"Erweiterte Anforderungen (Web-Interface)","text":"<ul> <li>Option 1 - Browser-basiert: Moderner Webbrowser (Chrome, Firefox, Safari, Edge)</li> <li>Option 2 - HTTP-Server: Python 3.x oder Node.js</li> <li>Option 3 - MkDocs: Python 3.8+, pip</li> </ul>"},{"location":"installation/#docker-deployment","title":"Docker Deployment","text":"<ul> <li>Docker 20.x oder h\u00f6her</li> <li>Docker Compose 2.x oder h\u00f6her</li> <li>512 MB freier RAM</li> <li>1 GB freier Speicherplatz</li> </ul>"},{"location":"installation/#option-a-web-interface-empfohlen","title":"\ud83d\ude80 Option A: Web-Interface (Empfohlen)","text":"<p>Dies ist die einfachste und schnellste Methode f\u00fcr neue Benutzer.</p>"},{"location":"installation/#schritt-1-repository-klonen","title":"Schritt 1: Repository klonen","text":"<pre><code># HTTPS (empfohlen f\u00fcr read-only)\ngit clone https://github.com/istagmbh/Ta-SIEMPlus.git\n\n# oder SSH (f\u00fcr Contributors)\ngit clone git@github.com:istagmbh/Ta-SIEMPlus.git\n\n# In Verzeichnis wechseln\ncd Ta-SIEMPlus\n</code></pre>"},{"location":"installation/#schritt-2-web-formulare-offnen","title":"Schritt 2: Web-Formulare \u00f6ffnen","text":"<p>Variante 2.1: Direkt im Browser (keine Installation)</p> <pre><code># macOS\nopen webforms/index.html\n\n# Linux\nxdg-open webforms/index.html\n\n# Windows\nstart webforms\\index.html\n</code></pre> <p>\u2705 Fertig! Die Web-Formulare funktionieren sofort ohne Server.</p> <p>Variante 2.2: Mit lokalem HTTP-Server (optional)</p> <p>Wenn direkte Datei-URLs nicht funktionieren:</p> <pre><code># Mit Python (empfohlen)\ncd webforms\npython3 -m http.server 8000\n\n# Mit Node.js\nnpx http-server webforms -p 8000\n\n# Dann \u00f6ffnen: http://localhost:8000\n</code></pre>"},{"location":"installation/#schritt-3-web-interface-nutzen","title":"Schritt 3: Web-Interface nutzen","text":"<p>Nach dem \u00d6ffnen sehen Sie: - \u00dcbersichtsseite mit Links zu allen Formularen - Upgrade-Formular - F\u00fcr Wazuh-Upgrades - Checklisten-Generator - Interaktive Checklisten - Agent-Verwaltung - Wazuh-Agentengruppen - Wartungsprotokolle - Dokumentation von Wartungsarbeiten</p> <p>Erste Schritte: 1. \u00d6ffnen Sie <code>webforms/index.html</code> 2. W\u00e4hlen Sie das gew\u00fcnschte Formular 3. F\u00fcllen Sie die Felder aus 4. Generieren Sie PDF oder exportieren Sie Markdown</p> <p>\ud83d\udcd6 Siehe auch: Web-Formular Dokumentation</p>"},{"location":"installation/#option-b-markdown-only","title":"\ud83d\udcdd Option B: Markdown-Only","text":"<p>F\u00fcr Nutzer, die direkt mit Markdown-Dateien arbeiten m\u00f6chten.</p>"},{"location":"installation/#schritt-1-repository-klonen_1","title":"Schritt 1: Repository klonen","text":"<pre><code>git clone https://github.com/istagmbh/Ta-SIEMPlus.git\ncd Ta-SIEMPlus\n</code></pre>"},{"location":"installation/#schritt-2-editor-offnen","title":"Schritt 2: Editor \u00f6ffnen","text":"<pre><code># VS Code (empfohlen)\ncode .\n\n# Oder \u00f6ffne einzelne Dateien\nopen README.md\n</code></pre>"},{"location":"installation/#schritt-3-navigation-verstehen","title":"Schritt 3: Navigation verstehen","text":"<pre><code>Ta-SIEMPlus/\n\u251c\u2500\u2500 README.md                 \u2190 Projekt-\u00dcberblick (START HIER)\n\u251c\u2500\u2500 GETTING_STARTED.md        \u2190 Erste Schritte\n\u251c\u2500\u2500 NAVIGATION.md             \u2190 Karte aller Dateien\n\u251c\u2500\u2500 runbooks/                 \u2190 Detaillierte Anleitungen\n\u251c\u2500\u2500 checklists/               \u2190 Ticket-Templates\n\u251c\u2500\u2500 Catalog/                  \u2190 Kunden-Registry\n\u2514\u2500\u2500 templates/                \u2190 Dokumentationsvorlagen\n</code></pre>"},{"location":"installation/#schritt-4-workflow-starten","title":"Schritt 4: Workflow starten","text":"<ol> <li>Lesen Sie GETTING_STARTED.md</li> <li>W\u00e4hlen Sie Ihr Szenario (Upgrade, Agent-Verwaltung, etc.)</li> <li>Folgen Sie den Runbooks in <code>runbooks/</code></li> <li>Nutzen Sie Checklisten aus <code>checklists/</code></li> </ol>"},{"location":"installation/#option-c-docker-deployment","title":"\ud83d\udc33 Option C: Docker Deployment","text":"<p>F\u00fcr Team-Nutzung oder Produktiv-Deployments mit MkDocs.</p>"},{"location":"installation/#schritt-1-repository-klonen_2","title":"Schritt 1: Repository klonen","text":"<pre><code>git clone https://github.com/istagmbh/Ta-SIEMPlus.git\ncd Ta-SIEMPlus\n</code></pre>"},{"location":"installation/#schritt-2-docker-container-starten","title":"Schritt 2: Docker Container starten","text":"<pre><code># Container bauen und starten\ndocker-compose up -d\n\n# Status pr\u00fcfen\ndocker-compose ps\n\n# Logs anzeigen\ndocker-compose logs -f docs\n</code></pre>"},{"location":"installation/#schritt-3-dokumentation-aufrufen","title":"Schritt 3: Dokumentation aufrufen","text":"<p>\u00d6ffnen Sie im Browser: <pre><code>http://localhost:8080\n</code></pre></p> <p>Sie sehen eine vollst\u00e4ndige, durchsuchbare MkDocs-Dokumentation mit: - \u2705 Navigation durch alle Bereiche - \u2705 Volltextsuche - \u2705 Dark/Light Mode - \u2705 Versionierung (Upgrade Guides) - \u2705 Responsive Design</p>"},{"location":"installation/#schritt-4-container-verwalten","title":"Schritt 4: Container verwalten","text":"<pre><code># Container stoppen\ndocker-compose down\n\n# Container neu starten\ndocker-compose restart\n\n# Container entfernen (Daten bleiben erhalten)\ndocker-compose down -v\n\n# Neu bauen nach \u00c4nderungen\ndocker-compose up -d --build\n</code></pre>"},{"location":"installation/#produktiv-deployment","title":"Produktiv-Deployment","text":"<p>F\u00fcr Produktion mit eigenem Hostnamen:</p> <pre><code># 1. docker-compose.yml anpassen\nnano docker-compose.yml\n\n# 2. Nginx-Konfiguration anpassen\nnano nginx.conf\n\n# 3. SSL-Zertifikate hinzuf\u00fcgen (optional)\nmkdir -p ssl/\ncp /path/to/cert.pem ssl/\ncp /path/to/key.pem ssl/\n\n# 4. Container starten\ndocker-compose up -d\n</code></pre> <p>Nginx Reverse Proxy Beispiel:</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name docs.example.com;\n\n    ssl_certificate /etc/nginx/ssl/cert.pem;\n    ssl_certificate_key /etc/nginx/ssl/key.pem;\n\n    location / {\n        proxy_pass http://localhost:8080;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n    }\n}\n</code></pre>"},{"location":"installation/#mkdocs-lokal-ohne-docker","title":"\ud83d\udd27 MkDocs Lokal (ohne Docker)","text":"<p>F\u00fcr Entwickler oder lokale Dokumentations-Entwicklung.</p>"},{"location":"installation/#schritt-1-python-umgebung-vorbereiten","title":"Schritt 1: Python-Umgebung vorbereiten","text":"<pre><code># Python 3.8+ erforderlich\npython3 --version\n\n# Virtual Environment erstellen (empfohlen)\npython3 -m venv venv\nsource venv/bin/activate  # Linux/Mac\n# oder\nvenv\\Scripts\\activate  # Windows\n</code></pre>"},{"location":"installation/#schritt-2-abhangigkeiten-installieren","title":"Schritt 2: Abh\u00e4ngigkeiten installieren","text":"<pre><code># MkDocs und Plugins installieren\npip install mkdocs mkdocs-material mike\n\n# oder aus requirements.txt (wenn vorhanden)\npip install -r requirements.txt\n</code></pre>"},{"location":"installation/#schritt-3-entwicklungsserver-starten","title":"Schritt 3: Entwicklungsserver starten","text":"<pre><code># MkDocs Dev-Server starten\nmkdocs serve\n\n# \u00d6ffne http://localhost:8000\n</code></pre> <p>Features des Dev-Servers: - \u2705 Live-Reload bei \u00c4nderungen - \u2705 Sofortiges Feedback - \u2705 Perfekt f\u00fcr Dokumentations-Entwicklung</p>"},{"location":"installation/#schritt-4-statische-site-bauen-optional","title":"Schritt 4: Statische Site bauen (optional)","text":"<pre><code># Site bauen\nmkdocs build\n\n# Ergebnis in site/ Verzeichnis\nls -l site/\n\n# Site mit einfachem HTTP-Server testen\npython3 -m http.server -d site 8000\n</code></pre>"},{"location":"installation/#versionierung-fur-upgrade-guides","title":"\ud83d\udcda Versionierung (f\u00fcr Upgrade Guides)","text":"<p>Ta-SIEMPlus nutzt mike f\u00fcr versionierte Dokumentation.</p>"},{"location":"installation/#mike-setup","title":"Mike Setup","text":"<pre><code># Mike ist bereits installiert (siehe Schritt 2 oben)\n\n# Versionen anzeigen\nmike list\n\n# Neue Version deployen\nmike deploy 4.12 latest --update-aliases\n\n# Version als Default setzen\nmike set-default latest\n\n# Lokales Testen\nmike serve\n</code></pre>"},{"location":"installation/#versionierungs-workflow","title":"Versionierungs-Workflow","text":"<pre><code># 1. Upgrade Guide f\u00fcr Version 4.13 erstellen\nmkdir -p docs/upgrade-guides/4.13\nnano docs/upgrade-guides/4.13/index.md\n\n# 2. In mkdocs.yml eintragen\nnano mkdocs.yml\n\n# 3. Version deployen\nmike deploy 4.13 --update-aliases\n\n# 4. Als \"latest\" markieren\nmike deploy 4.13 latest --update-aliases\n</code></pre> <p>\ud83d\udcd6 Details: Siehe Mike Versioning Guide</p>"},{"location":"installation/#validierung-troubleshooting","title":"\u2705 Validierung &amp; Troubleshooting","text":""},{"location":"installation/#installation-uberprufen","title":"Installation \u00fcberpr\u00fcfen","text":"<p>Nach der Installation sollten folgende Tests erfolgreich sein:</p> <pre><code># Test 1: Repository-Struktur\nls -l README.md GETTING_STARTED.md runbooks/ checklists/\n# Erwartung: Alle Dateien existieren\n\n# Test 2: Web-Formulare (Browser)\n# \u00d6ffne webforms/index.html\n# Erwartung: Formulare laden ohne Fehler\n\n# Test 3: MkDocs (wenn installiert)\nmkdocs serve\n# Erwartung: Server startet auf http://localhost:8000\n\n# Test 4: Docker (wenn genutzt)\ndocker-compose ps\n# Erwartung: Container \"ta-siemplus-docs\" l\u00e4uft\n</code></pre>"},{"location":"installation/#haufige-probleme","title":"H\u00e4ufige Probleme","text":""},{"location":"installation/#problem-git-clone-schlagt-fehl","title":"Problem: Git Clone schl\u00e4gt fehl","text":"<p>Symptom: <code>Permission denied</code> oder <code>Repository not found</code></p> <p>L\u00f6sung: <pre><code># Verwende HTTPS statt SSH\ngit clone https://github.com/istagmbh/Ta-SIEMPlus.git\n\n# Oder konfiguriere SSH-Key\nssh-keygen -t ed25519 -C \"your_email@example.com\"\n# F\u00fcge Key zu GitHub hinzu: https://github.com/settings/keys\n</code></pre></p>"},{"location":"installation/#problem-web-formulare-laden-nicht","title":"Problem: Web-Formulare laden nicht","text":"<p>Symptom: Wei\u00dfe Seite oder Fehler beim \u00d6ffnen</p> <p>L\u00f6sung: <pre><code># Option 1: HTTP-Server nutzen (siehe Option A, Variante 2.2)\npython3 -m http.server 8000\n\n# Option 2: Browser-Einstellungen pr\u00fcfen\n# - JavaScript aktiviert?\n# - Pop-up-Blocker deaktiviert?\n# - Console-Fehler (F12) pr\u00fcfen\n</code></pre></p>"},{"location":"installation/#problem-docker-container-startet-nicht","title":"Problem: Docker Container startet nicht","text":"<p>Symptom: <code>docker-compose up</code> schl\u00e4gt fehl</p> <p>L\u00f6sung: <pre><code># Docker l\u00e4uft?\ndocker info\n\n# Port 8080 bereits belegt?\nlsof -i :8080  # Mac/Linux\nnetstat -ano | findstr :8080  # Windows\n\n# Port in docker-compose.yml \u00e4ndern\nnano docker-compose.yml\n# \u00c4ndere \"8080:80\" zu \"8888:80\"\n\n# Neu starten\ndocker-compose down\ndocker-compose up -d\n</code></pre></p>"},{"location":"installation/#problem-mkdocs-build-schlagt-fehl","title":"Problem: MkDocs Build schl\u00e4gt fehl","text":"<p>Symptom: <code>mkdocs build</code> gibt Fehler aus</p> <p>L\u00f6sung: <pre><code># Python-Version pr\u00fcfen (mind. 3.8)\npython3 --version\n\n# Abh\u00e4ngigkeiten neu installieren\npip install --upgrade mkdocs mkdocs-material mike\n\n# Cache l\u00f6schen\nrm -rf site/\n\n# Neu bauen\nmkdocs build\n</code></pre></p>"},{"location":"installation/#problem-markdown-links-funktionieren-nicht","title":"Problem: Markdown-Links funktionieren nicht","text":"<p>Symptom: Klick auf Links f\u00fchrt zu 404</p> <p>L\u00f6sung: - F\u00fcr lokale Datei-URLs: Relative Pfade verwenden - F\u00fcr HTTP-Server: Absolute Pfade ab Repository-Root - F\u00fcr MkDocs: Pfade relativ zu <code>docs/</code> Verzeichnis</p>"},{"location":"installation/#updates-wartung","title":"\ud83d\udd04 Updates &amp; Wartung","text":""},{"location":"installation/#repository-aktualisieren","title":"Repository aktualisieren","text":"<pre><code># In Repository-Verzeichnis\ncd Ta-SIEMPlus\n\n# Aktuelle \u00c4nderungen abrufen\ngit fetch\n\n# Auf neueste Version aktualisieren\ngit pull origin main\n\n# Bei Docker: Container neu bauen\ndocker-compose up -d --build\n</code></pre>"},{"location":"installation/#automatische-updates-optional","title":"Automatische Updates (optional)","text":"<pre><code># Cron-Job f\u00fcr t\u00e4gliche Updates (Linux/Mac)\ncrontab -e\n\n# F\u00fcge hinzu:\n0 2 * * * cd /path/to/Ta-SIEMPlus &amp;&amp; git pull &amp;&amp; docker-compose up -d --build\n</code></pre>"},{"location":"installation/#nachste-schritte","title":"\ud83c\udf93 N\u00e4chste Schritte","text":"<p>Nach erfolgreicher Installation:</p> <ol> <li> <p>\ud83d\udcd6 Erste Schritte lesen <pre><code>open GETTING_STARTED.md\n</code></pre></p> </li> <li> <p>\ud83d\uddfa\ufe0f Navigation verstehen <pre><code>open NAVIGATION.md\n</code></pre></p> </li> <li> <p>\u26a1 Schnellreferenz bookmarken <pre><code>open QUICK_REFERENCE.md\n</code></pre></p> </li> <li> <p>\ud83d\udd27 Erstes Szenario durchf\u00fchren</p> </li> <li>W\u00e4hle in GETTING_STARTED.md dein Szenario</li> <li>Folge der Schritt-f\u00fcr-Schritt-Anleitung</li> <li>Nutze Web-Formulare oder Markdown-Checklisten</li> </ol>"},{"location":"installation/#support-hilfe","title":"\ud83d\udcde Support &amp; Hilfe","text":"Frage Antwort Welche Option soll ich w\u00e4hlen? Web-Interface (Option A) f\u00fcr Anf\u00e4nger, Markdown (Option B) f\u00fcr Power-User, Docker (Option C) f\u00fcr Teams Brauche ich Internet? Nur f\u00fcr Git Clone. Danach funktioniert alles offline (au\u00dfer MkDocs-Suche) Kann ich mehrere Optionen nutzen? Ja! Web-Formulare + Markdown ist eine gute Kombination Wo finde ich Beispiele? In GETTING_STARTED.md unter \"Workflow-Beispiel\" Wie aktualisiere ich? <code>git pull</code> f\u00fcr Updates, <code>docker-compose up -d --build</code> f\u00fcr Docker <p>Weitere Hilfe: - \ud83d\udcd6 README.md - Projekt-\u00dcberblick - \ud83d\ude80 GETTING_STARTED.md - Erste Schritte - \ud83d\uddfa\ufe0f NAVIGATION.md - Dateien-Karte - \ud83d\udcac GitHub Issues - Fragen &amp; Probleme</p>"},{"location":"installation/#zusammenfassung","title":"\u2728 Zusammenfassung","text":"<p>Einfachste Installation (5 Minuten): <pre><code># 1. Klonen\ngit clone https://github.com/istagmbh/Ta-SIEMPlus.git\ncd Ta-SIEMPlus\n\n# 2. Web-Formulare \u00f6ffnen\nopen webforms/index.html  # Mac\nxdg-open webforms/index.html  # Linux\nstart webforms\\index.html  # Windows\n\n# 3. Loslegen! \ud83d\ude80\n</code></pre></p> <p>F\u00fcr Teams (Docker): <pre><code># 1. Klonen\ngit clone https://github.com/istagmbh/Ta-SIEMPlus.git\ncd Ta-SIEMPlus\n\n# 2. Docker starten\ndocker-compose up -d\n\n# 3. \u00d6ffnen: http://localhost:8080\n</code></pre></p> <p>Installation erfolgreich! Viel Erfolg mit Ta-SIEMPlus! \ud83c\udf89</p> <p>N\u00e4chster Schritt \u2192 GETTING_STARTED.md</p>"},{"location":"navigation/","title":"\ud83d\uddfa\ufe0f Projekt-Navigations-Guide","text":"<p>Eine visuelle Karte durch Ta-SIEMPlus \u2013 f\u00fcr alle F\u00e4lle.</p>"},{"location":"navigation/#hauptzugriff-web-formulare-neu","title":"\ud83c\udf10 HAUPTZUGRIFF: Web-Formulare (NEU!)","text":"<p>Alle Werkzeuge sind jetzt \u00fcber interaktive Web-Formulare zug\u00e4nglich!</p>"},{"location":"navigation/#start-hier-webformsindexhtml","title":"\ud83d\ude80 Start hier: webforms/index.html","text":"<p>Verf\u00fcgbare Tools: - \ud83d\udd04 upgrade-form.html - Wazuh Upgrade Wizard mit 5-Schritt-Prozess - \u2705 checklist-generator.html - Dynamischer Checklisten-Generator - \ud83d\udc65 agent-management.html - Agentengruppen-Verwaltung mit Befehlsgenerator - \ud83d\udccb maintenance-protocol.html - Wartungsdokumentation mit Timer - \ud83d\udcda README.md - Webforms-Dokumentation</p> <p>Vorteile: - \u2705 Keine Installation notwendig - \u2705 Funktioniert offline im Browser - \u2705 Automatische Befehlsgenerierung - \u2705 PDF-Export f\u00fcr Dokumentation - \u2705 LocalStorage Persistenz - \u2705 Mobile-responsive Design</p>"},{"location":"navigation/#was-brauchst-du-entscheider","title":"\ud83c\udfaf WAS BRAUCHST DU? (Entscheider)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Was willst du tun?                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193\n    W\u00c4HLE DEIN SZENARIO:\n</code></pre>"},{"location":"navigation/#1-ich-bin-vollig-neu-hier","title":"1\ufe0f\u20e3 ICH BIN V\u00d6LLIG NEU HIER","text":"<p>\u2192 Installation: INSTALLATION.md (NEU!)    \u2192 Erste Schritte: GETTING_STARTED.md    - \u2713 Komplette Setup-Anleitung    - \u2713 3 Installations-Optionen    - \u2713 Alle Haupt-Szenarien erkl\u00e4rt    - \u2713 F\u00fcr absolute Anf\u00e4nger geeignet</p>"},{"location":"navigation/#2-ich-muss-ein-wazuh-upgrade-durchfuhren","title":"2\ufe0f\u20e3 ICH MUSS EIN WAZUH-UPGRADE DURCHF\u00dcHREN","text":"<p>\u2192 Web-Tool: webforms/upgrade-form.html (NEU!)    \u2192 Oder Anleitung: CHECKLIST_HOWTO.md    - \u2713 Interaktiver 5-Schritt-Wizard    - \u2713 Automatische Befehlsgenerierung    - \u2713 PDF-Export f\u00fcr Dokumentation    - \u2713 Oder: Markdown-Checkliste f\u00fcr Tickets    - Dann: CHECKLIST_WAZUH_UPGRADE_AIO.md</p>"},{"location":"navigation/#3-ich-verwalte-agentengruppen","title":"3\ufe0f\u20e3 ICH VERWALTE AGENTENGRUPPEN","text":"<p>\u2192 Web-Tool: webforms/agent-management.html (NEU!)    \u2192 Runbook: runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT.md    - \u2713 Befehls-Generator f\u00fcr 7 Operationen    - \u2713 7 vordefinierte Beispiele    - \u2713 merged.mg und ar.conf erkl\u00e4rt    - \u2713 agent_groups CLI Befehle    - \u2713 Best Practices</p>"},{"location":"navigation/#4-ich-brauche-schnelle-befehle","title":"4\ufe0f\u20e3 ICH BRAUCHE SCHNELLE BEFEHLE","text":"<p>\u2192 Datei: QUICK_REFERENCE.md    - \u2713 Alle wichtigen Commands zum Copy-Paste    - \u2713 Health Checks    - \u2713 Troubleshooting    - \u2713 Pro-Tips</p>"},{"location":"navigation/#5-ich-registriere-einen-neuen-kunden","title":"5\ufe0f\u20e3 ICH REGISTRIERE EINEN NEUEN KUNDEN","text":"<p>\u2192 Anleitung: CATALOG_HOWTO.md    \u2192 Katalog: Catalog/CUSTOMERS.md    - \u2713 Daten sammeln    - \u2713 YAML-Eintrag erstellen    - \u2713 Pull Request einreichen</p>"},{"location":"navigation/#6-ich-mochte-ein-wartungsprotokoll-erstellen","title":"6\ufe0f\u20e3 ICH M\u00d6CHTE EIN WARTUNGSPROTOKOLL ERSTELLEN","text":"<p>\u2192 Web-Tool: webforms/maintenance-protocol.html (NEU!)    - \u2713 Strukturierte Erfassung    - \u2713 Integrierter Timer    - \u2713 Problem-Tracking    - \u2713 PDF-Export</p>"},{"location":"navigation/#7-ich-mochte-das-projekt-andern-beitragen","title":"7\ufe0f\u20e3 ICH M\u00d6CHTE DAS PROJEKT \u00c4NDERN / BEITRAGEN","text":"<p>\u2192 Datei: CONTRIBUTING.md    - \u2713 Pull Request Prozess    - \u2713 Richtlinien f\u00fcr Runbooks/Checklisten    - \u2713 Git Workflow    - \u2713 Review Standards</p>"},{"location":"navigation/#7-ich-brauche-detaillierte-befehle-troubleshooting","title":"7\ufe0f\u20e3 ICH BRAUCHE DETAILLIERTE BEFEHLE / TROUBLESHOOTING","text":"<p>\u2192 Datei: RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md    - \u2713 Alle Befehle mit Erkl\u00e4rungen    - \u2713 Voraussetzungen &amp; No-Go Gates    - \u2713 Troubleshooting-Abschnitt    - \u2713 Rollback-Verfahren</p>"},{"location":"navigation/#datenfluss-diagramm","title":"\ud83d\udcca DATENFLUSS-DIAGRAMM","text":"<pre><code>WORKFLOW:\n\nSTART\n  \u2502\n  \u251c\u2500\u2192 [1] CHECKLIST_HOWTO.md\n  \u2502       \"Wie f\u00fclle ich eine Checkliste aus?\"\n  \u2502       \u2193\n  \u251c\u2500\u2192 [2] Catalog/CUSTOMERS.md\n  \u2502       \"Kundendaten nachschlagen\"\n  \u2502       \u2193\n  \u251c\u2500\u2192 [3] CHECKLIST_WAZUH_UPGRADE_AIO.md\n  \u2502       \"Checkliste ins Ticket kopieren\"\n  \u2502       \u2193\n  \u251c\u2500\u2192 [4] RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md\n  \u2502       \"Befehle f\u00fcr jeden Schritt\"\n  \u2502       \u2193\n  \u251c\u2500\u2192 [5] QUICK_REFERENCE.md\n  \u2502       \"Health Snapshots, Diagnostik\"\n  \u2502       \u2193\n  \u2514\u2500\u2192 [6] CHANGE_NOTE_TEMPLATE.md\n          \"Abschluss-Dokumentation\"\n            \u2193\n          FERTIG \u2705\n\nALTERNATIVE (Experten):\n\n  \u251c\u2500\u2192 QUICK_REFERENCE.md\n  \u2502    \"Schnell alle Commands\"\n  \u2502       \u2193\n  \u2514\u2500\u2192 RUNBOOK... \"Nur bei Problemen\"\n</code></pre>"},{"location":"navigation/#datei-ubersicht","title":"\ud83d\udcc1 DATEI-\u00dcBERSICHT","text":""},{"location":"navigation/#neue-dateien-fur-bessere-ux","title":"\ud83d\udfe2 NEUE DATEIEN (f\u00fcr bessere UX)","text":"Datei Zweck F\u00fcr wen INSTALLATION.md Setup-Anleitung (3 Optionen) Neue Benutzer GETTING_STARTED.md Einstieg in Hauptszenarien Anf\u00e4nger + Neue User QUICK_REFERENCE.md Schnelle Befehls-Lookups Erfahrene Operatoren CHECKLIST_HOWTO.md Checkliste richtig ausf\u00fcllen Alle Operatoren CATALOG_HOWTO.md Kunde hinzuf\u00fcgen Admin + DevOps PROJECT_COMPLETION.md Projekt-Finalisierung Status Contributors webforms/ \ud83c\udd95 Interaktive Web-Tools Alle (Web-Nutzer) README.md (\u00fcberarbeitet) Projekt-\u00dcberblick Alle"},{"location":"navigation/#kerndate-bereits-vorhanden","title":"\ud83d\udd35 KERNDATE (bereits vorhanden)","text":"Datei Zweck Typ CHECKLIST_WAZUH_UPGRADE_AIO.md Upgrade-Checkliste (Markdown) Template CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED.md Verbesserte Checkliste Template RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md Detailliertes Runbook Anleitung Catalog/CUSTOMERS.md Kunden-Registry YAML CHANGE_NOTE_TEMPLATE.md Abschluss-Template Template CONTRIBUTING.md Governance Regeln"},{"location":"navigation/#tools-docs","title":"\ud83d\udfe1 TOOLS &amp; DOCS","text":"Datei Zweck Typ docs/index.html \u00dcbersichtsseite Web docs/maintenance-form.html Digitales Formular Web docs/README.md Tool-Dokumentation Doc"},{"location":"navigation/#suche-ich-etwas","title":"\ud83d\udd0d SUCHE ICH ETWAS?","text":""},{"location":"navigation/#wie-fuhre-ich-einen-befehl-aus","title":"\"Wie f\u00fchre ich einen Befehl aus?\"","text":"<ol> <li>QUICK_REFERENCE.md \u2192 Suchfeld</li> <li>Wenn nicht gefunden \u2192 RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md</li> <li>Wenn immer noch nicht \u2192 Wazuh Official Docs</li> </ol>"},{"location":"navigation/#welche-kundendaten-brauche-ich","title":"\"Welche Kundendaten brauche ich?\"","text":"<ol> <li>Catalog/CUSTOMERS.md \u2192 Kunden suchen</li> <li>Alle URLs/IPs sind dort dokumentiert</li> <li>Falls nicht da \u2192 CATALOG_HOWTO.md \u2192 \"Neuen Kunden hinzuf\u00fcgen\"</li> </ol>"},{"location":"navigation/#was-ist-die-richtige-reihenfolge","title":"\"Was ist die richtige Reihenfolge?\"","text":"<ol> <li>RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md \u2192 Abschnitte 1-11</li> <li>Oder: CHECKLIST_HOWTO.md \u2192 \"Schritt-f\u00fcr-Schritt\"</li> </ol>"},{"location":"navigation/#wie-trage-ich-eine-anderung-bei","title":"\"Wie trage ich eine \u00c4nderung bei?\"","text":"<ol> <li>CONTRIBUTING.md \u2192 Prozess</li> <li>Oder: CATALOG_HOWTO.md \u2192 \"Katalog-Verwaltung\"</li> </ol>"},{"location":"navigation/#ich-habe-einen-fehler-was-nun","title":"\"Ich habe einen Fehler \u2013 was nun?\"","text":"<ol> <li>QUICK_REFERENCE.md \u2192 Diagnose-Befehle</li> <li>RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md \u2192 Troubleshooting (Abschnitt 11)</li> <li>Wenn kritisch \u2192 Rollback (Abschnitt 10 des Runbooks)</li> </ol>"},{"location":"navigation/#learning-path-fur-anfanger","title":"\ud83c\udf93 LEARNING PATH (f\u00fcr Anf\u00e4nger)","text":"<pre><code>TAG 1: VERSTEHEN\n\u251c\u2500 [GETTING_STARTED.md](GETTING_STARTED.md) durchlesen\n\u251c\u2500 [README.md](README.md) durchschauen\n\u2514\u2500 [Projekt-\u00dcberblick](NAVIGATION.md) verstehen\n\nTAG 2: VORBEREITUNG\n\u251c\u2500 [CHECKLIST_HOWTO.md](CHECKLIST_HOWTO.md) durcharbeiten\n\u251c\u2500 Eine echte Checkliste durchlesen\n\u2514\u2500 Kundendaten in [Catalog/CUSTOMERS.md](Catalog/CUSTOMERS.md) suchen\n\nTAG 3: EXECUTION (unter Anleitung!)\n\u251c\u2500 Mit erfahrenem Operator zusammen\n\u251c\u2500 Erste Checkliste durcharbeiten\n\u251c\u2500 Befehle aus [QUICK_REFERENCE.md](QUICK_REFERENCE.md) kopieren\n\u2514\u2500 Health Snapshots dokumentieren\n\nTAG 4: SOLO UPGRADE\n\u251c\u2500 Eigenes Upgrade alleine durchf\u00fchren\n\u251c\u2500 [RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md](runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md) als Referenz\n\u2514\u2500 Feedback geben\n\nZUS\u00c4TZLICH: BEITRAGEN\n\u2514\u2500 [CONTRIBUTING.md](CONTRIBUTING.md) \u2192 Erste PR einreichen\n</code></pre>"},{"location":"navigation/#haufige-fragen","title":"\ud83d\udca1 H\u00c4UFIGE FRAGEN","text":""},{"location":"navigation/#f-wo-finde-ich-den-befehl-zum-starten-von-wazuh-manager","title":"F: Wo finde ich den Befehl zum Starten von wazuh-manager?","text":"<p>A:  1. QUICK_REFERENCE.md \u2192 \"H\u00e4ufige Prozess-Schritte\" \u2192 \"Step 4\" 2. Oder: RUNBOOK... \u2192 Ctrl+F \"start wazuh-manager\"</p>"},{"location":"navigation/#f-wie-starte-ich-mein-erstes-upgrade","title":"F: Wie starte ich mein erstes Upgrade?","text":"<p>A:  1. GETTING_STARTED.md \u2192 \"UPGRADE-PROZESS\" 2. Oder: CHECKLIST_HOWTO.md \u2192 \"Komplette Anleitung\"</p>"},{"location":"navigation/#f-ich-wei-nicht-welche-metadaten-ich-brauche","title":"F: Ich wei\u00df nicht, welche Metadaten ich brauche!","text":"<p>A:  1. CHECKLIST_HOWTO.md \u2192 \"SCHRITT 1: Metadaten sammeln\" 2. Kundendaten nachschauen: Catalog/CUSTOMERS.md</p>"},{"location":"navigation/#f-muss-ich-die-checkliste-ausfullen","title":"F: Muss ich die Checkliste ausf\u00fcllen?","text":"<p>A: Ja! Sie ist notwendig f\u00fcr: - Audit-Trail (wer hat was gemacht?) - Nachverfolgung (Status \u00fcberpr\u00fcfen) - Rollback (wenn etwas schiefgeht)</p>"},{"location":"navigation/#f-darf-ich-befehle-in-eine-andere-reihenfolge-andern","title":"F: Darf ich Befehle in eine andere Reihenfolge \u00e4ndern?","text":"<p>A: NEIN! Die Reihenfolge ist getestet. Siehe RUNBOOK... \u2192 Abschnitte m\u00fcssen in Ordnung sein!</p>"},{"location":"navigation/#f-was-passiert-wenn-ich-einen-fehler-mache","title":"F: Was passiert, wenn ich einen Fehler mache?","text":"<p>A: 1. Ruhe bewahren \u2705 2. Runbook \u2192 Abschnitt 11 \"Troubleshooting\" 3. Diagnose-Befehle aus QUICK_REFERENCE.md ausf\u00fchren 4. Wenn kritisch: Abschnitt 10 \"Rollback\"</p>"},{"location":"navigation/#quick-links-copy-paste","title":"\ud83d\ude80 QUICK LINKS (Copy-Paste)","text":"Datei \u00d6ffnen Getting Started <code>GETTING_STARTED.md</code> Quick Reference <code>QUICK_REFERENCE.md</code> Checklist HOWTO <code>CHECKLIST_HOWTO.md</code> Catalog HOWTO <code>CATALOG_HOWTO.md</code> Upgrade Checklist <code>checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md</code> Upgrade Runbook <code>runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md</code> Customer Catalog <code>Catalog/CUSTOMERS.md</code> Contributing <code>CONTRIBUTING.md</code> Change Note Template <code>templates/CHANGE_NOTE_TEMPLATE.md</code>"},{"location":"navigation/#checkliste-bin-ich-bereit","title":"\u2705 Checkliste: \"Bin ich bereit?\"","text":"<p>Bevor du ein Upgrade startest:</p> <ul> <li> Ich habe GETTING_STARTED.md gelesen (oder QUICK_REFERENCE.md)</li> <li> Ich habe die Kundendaten in Catalog/CUSTOMERS.md gefunden</li> <li> Ich habe CHECKLIST_HOWTO.md verstanden</li> <li> Ich habe eine Checkliste vorbereitet</li> <li> Ich kenne die No-Go Gates (Abschnitt B in der Checkliste)</li> <li> Ich habe einen Backup/Snapshot erstellt</li> <li> Ich habe ein Change-Ticket</li> </ul> <p>\u2192 Ja zu allen? Dann los geht's! \ud83d\ude80</p> <p>Version: 1.0 Letzte Aktualisierung: 30. Januar 2026 Maintain via: CONTRIBUTING.md</p>"},{"location":"quick-reference/","title":"\u26a1 QUICK REFERENCE \u2013 Schnelle Lookups","text":"<p>Ein Cheat-Sheet f\u00fcr erfahrene Operatoren. Alle Befehle zum Kopieren.</p>"},{"location":"quick-reference/#wazuh-upgrade-ubuntu-aio","title":"\ud83c\udfaf Wazuh Upgrade (Ubuntu AIO)","text":""},{"location":"quick-reference/#datei-locations","title":"Datei-Locations","text":"<pre><code>Checkliste (Markdown):     checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md\nCheckliste (Web):          docs/maintenance-form.html\nRunbook:                   runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md\nTemplate:                  templates/CHANGE_NOTE_TEMPLATE.md\nKunden-Info:               Catalog/CUSTOMERS.md\n</code></pre>"},{"location":"quick-reference/#metadaten-fur-change-ticket-copy-paste-template","title":"Metadaten f\u00fcr Change-Ticket (Copy-Paste Template)","text":"<pre><code>operator: \"UNSET\"\ncustomer: \"UNSET\"\ninfrastructure: \"UNSET\"\nchange_ticket: \"UNSET\"\nmaintenance_window_start: \"UNSET\"      # Europe/Zurich\nmaintenance_window_end: \"UNSET\"        # Europe/Zurich\ntarget_version: \"UNSET\"\ncurrent_version: \"UNSET\"\nsnapshot_id: \"UNSET\"\nsystem: \"Ubuntu AIO (APT)\"\nrunbook_ref: \"../runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md\"\n</code></pre>"},{"location":"quick-reference/#health-snapshot-prepost-upgrade","title":"\ud83d\udccb Health Snapshot (Pre/Post Upgrade)","text":""},{"location":"quick-reference/#pre-snapshot-vor-upgrade","title":"Pre-Snapshot (vor Upgrade)","text":"<pre><code>date -Is\necho \"=== DISK ===\"\ndf -h | grep -v tmpfs\necho \"=== MEMORY ===\"\nfree -h\necho \"=== SERVICES ===\"\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\necho \"=== VERSIONS ===\"\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\necho \"=== CLUSTER HEALTH ===\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n</code></pre>"},{"location":"quick-reference/#post-snapshot-nach-upgrade","title":"Post-Snapshot (nach Upgrade)","text":"<pre><code># Exakt denselben Befehl wie oben nochmal ausf\u00fchren\n# Vergleichen &amp; dokumentieren\n</code></pre>"},{"location":"quick-reference/#diagnose-befehle-troubleshooting","title":"\ud83d\udd0d Diagnose-Befehle (Troubleshooting)","text":""},{"location":"quick-reference/#service-status-check","title":"Service-Status Check","text":"<pre><code>systemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat -l\n</code></pre>"},{"location":"quick-reference/#letzte-50-fehler-im-journal","title":"Letzte 50 Fehler im Journal","text":"<pre><code>journalctl -u wazuh-indexer -n 50 --no-pager -p err\njournalctl -u wazuh-manager -n 50 --no-pager -p err\njournalctl -u wazuh-dashboard -n 50 --no-pager -p err\njournalctl -u filebeat -n 50 --no-pager -p err\n</code></pre>"},{"location":"quick-reference/#cluster-health-indexer","title":"Cluster Health (Indexer)","text":"<pre><code>curl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/shards?v\n</code></pre>"},{"location":"quick-reference/#manager-api-health","title":"Manager API Health","text":"<pre><code>curl -sk -u admin:admin https://127.0.0.1:55000/api/v1/manager/info\n</code></pre>"},{"location":"quick-reference/#disk-space","title":"Disk Space","text":"<pre><code>df -h\ndu -sh /var/ossec/*\ndu -sh /var/lib/wazuh/*\n</code></pre>"},{"location":"quick-reference/#haufige-prozess-schritte","title":"\ud83d\udd04 H\u00e4ufige Prozess-Schritte","text":""},{"location":"quick-reference/#1-services-stoppen-fur-upgrade","title":"1. Services stoppen (f\u00fcr Upgrade)","text":"<pre><code>systemctl stop filebeat\nsystemctl stop wazuh-dashboard\nsystemctl stop wazuh-manager\nsystemctl stop wazuh-indexer\n</code></pre>"},{"location":"quick-reference/#2-paketliste-aktualisieren","title":"2. Paketliste aktualisieren","text":"<pre><code>apt update\n</code></pre>"},{"location":"quick-reference/#3-upgrade-durchfuhren-alle-komponenten","title":"3. Upgrade durchf\u00fchren (alle Komponenten)","text":"<pre><code>apt install --only-upgrade wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n</code></pre>"},{"location":"quick-reference/#4-services-starten-nach-upgrade","title":"4. Services starten (nach Upgrade)","text":"<pre><code>systemctl start wazuh-indexer\nsystemctl start wazuh-manager\nsystemctl start wazuh-dashboard\nsystemctl start filebeat\n</code></pre>"},{"location":"quick-reference/#5-status-verifizieren","title":"5. Status verifizieren","text":"<pre><code>systemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n</code></pre>"},{"location":"quick-reference/#agentengruppen-verwaltung","title":"\ud83d\udc65 Agentengruppen-Verwaltung","text":""},{"location":"quick-reference/#datei-locations_1","title":"Datei-Locations","text":"<pre><code>Web-Formular:           webforms/agent-groups.html\nRunbook:                runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT.md\n</code></pre>"},{"location":"quick-reference/#wichtige-dateien","title":"Wichtige Dateien","text":"<p>merged.mg - Konsolidierte Konfiguration Pfad: <code>/var/ossec/etc/shared/&lt;agent-id&gt;/merged.mg</code> - Wird vom Wazuh-Manager generiert - Enth\u00e4lt konsolidierte Konfiguration aller Gruppen eines Agents - Bei jeder \u00c4nderung automatisch aktualisiert und an Agent gesendet - \u00dcber Dashboard einsehbar, aber nicht editierbar</p> <p>ar.conf - Active Response Befehle Pfad: <code>/var/ossec/etc/shared/&lt;group-name&gt;/ar.conf</code> - Liste von Befehlen f\u00fcr Active Response - Skripte/Programme f\u00fcr Wartung und Problembehebung - Service-Neustart-Anweisungen (Wazuh, OSSEC) - \u00dcber Dashboard einsehbar, aber nicht editierbar</p>"},{"location":"quick-reference/#grundlegende-befehle","title":"Grundlegende Befehle","text":"<pre><code># Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g &lt;group-name&gt;\n\n# Alle Gruppen auflisten\n/var/ossec/bin/agent_groups -l\n\n# Spezifische Gruppe mit Details\n/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n\n# Agent zu Gruppe(n) hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i &lt;agent-id&gt; -g &lt;group-name&gt;\n\n# Agent zu mehreren Gruppen hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i &lt;agent-id&gt; -g &lt;group1&gt;,&lt;group2&gt;,&lt;group3&gt;\n\n# Agent aus Gruppe entfernen\n/var/ossec/bin/agent_groups -r -i &lt;agent-id&gt; -g &lt;group-name&gt;\n\n# Agent aus allen Gruppen entfernen\n/var/ossec/bin/agent_groups -r -i &lt;agent-id&gt;\n\n# Alle Agenten mit Gruppenzugeh\u00f6rigkeit\n/var/ossec/bin/manage_agents -l\n</code></pre>"},{"location":"quick-reference/#beispiele","title":"Beispiele","text":"<pre><code># Linux-Server-Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g linux-servers\n\n# Agent zu Gruppe hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i 001 -g linux-servers\n\n# Agent zu mehreren Gruppen (Multi-Gruppen)\n/var/ossec/bin/agent_groups -a -i 002 -g linux-servers,web-servers,prod\n\n# Gruppe l\u00f6schen (3 Schritte)\n/var/ossec/bin/agent_groups -r -g old-servers\nrm -rf /var/ossec/etc/shared/old-servers\nsystemctl restart wazuh-manager\n</code></pre>"},{"location":"quick-reference/#gruppenkonfiguration","title":"Gruppenkonfiguration","text":"<pre><code># agent.conf erstellen/bearbeiten\nvi /var/ossec/etc/shared/&lt;group-name&gt;/agent.conf\n\n# ar.conf erstellen/bearbeiten (optional)\nvi /var/ossec/etc/shared/&lt;group-name&gt;/ar.conf\n\n# Konfiguration validieren\n/var/ossec/bin/wazuh-logtest-config\n\n# Manager neu laden\nsystemctl restart wazuh-manager\n</code></pre>"},{"location":"quick-reference/#health-checks","title":"Health Checks","text":"<pre><code># Gruppen-Verzeichnisse pr\u00fcfen\nls -la /var/ossec/etc/shared/\n\n# Konfigurationsdateien finden\nfind /var/ossec/etc/shared/ -name \"agent.conf\" -o -name \"ar.conf\" -o -name \"merged.mg\"\n\n# Manager-Logs f\u00fcr Gruppen-Events\ngrep -i \"group\" /var/ossec/logs/ossec.log | tail -n 50\n\n# Agent-Verbindungsstatus\n/var/ossec/bin/agent_control -l\n\n# Agent-Synchronisation erzwingen\n/var/ossec/bin/agent_control -R &lt;agent-id&gt;\n</code></pre>"},{"location":"quick-reference/#best-practices","title":"Best Practices","text":"<pre><code># Backup vor \u00c4nderungen\ntar -czf /backup/wazuh-groups-$(date +%F).tar.gz /var/ossec/etc/shared/\n\n# Namenskonvention\n# &lt;umgebung&gt;-&lt;funktion&gt;-&lt;location&gt;\n# Beispiel: prod-web-servers, dev-db-servers\n\n# Multi-Gruppen nutzen\n# Basis + Funktion + Umgebung\n/var/ossec/bin/agent_groups -a -i 001 -g linux-base,web-servers,prod\n</code></pre>"},{"location":"quick-reference/#katalog-eintrage","title":"\ud83d\udcc1 Katalog-Eintr\u00e4ge","text":""},{"location":"quick-reference/#neue-infra-schnell-finden","title":"Neue Infra schnell finden","text":"<pre><code>grep -A 10 \"customer: \\\"DeepCloud AG\\\"\" Catalog/CUSTOMERS.md\n</code></pre>"},{"location":"quick-reference/#template-fur-neuen-kunden-copy-paste","title":"Template f\u00fcr neuen Kunden (copy-paste)","text":"<pre><code>---\ncustomer: \"UNSET\"\ninfrastructure: \"UNSET\"\nenvironment: \"prod|test|dev\"\nwazuh_type: \"Ubuntu AIO (APT)\"\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"wazuh01.example.tld\"\n    mgmt_ip: \"10.10.10.10\"\nurls:\n  dashboard: \"https://wazuh01.example.tld\"\n  api: \"https://wazuh01.example.tld:55000\"\n  indexer: \"https://wazuh01.example.tld:9200\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nsecrets_ref:\n  admin_user: \"vault://path/to/secret\"\n  admin_password: \"vault://path/to/secret\"\nchange_policy: \"Within business hours (08:00 - 17:00 CET)\"\ncontact_email: \"team@example.tld\"\n---\n</code></pre>"},{"location":"quick-reference/#no-go-gates-stop-wenn-erfullt","title":"\ud83d\udea8 No-Go Gates (STOP wenn erf\u00fcllt!)","text":"Gate Check Disk &gt; 90% <code>df -h</code> \u2192 Freigeben vor Upgrade Services nicht running <code>systemctl status ...</code> \u2192 Starten/Debuggen Keine Backup VM-Snapshot ODER tar-Backup erstellen Au\u00dferhalb Fenster Verschieben auf geplante Zeit Manager &lt; Agent Version Upgrade Manager ZUERST"},{"location":"quick-reference/#git-workflow-schnell","title":"\ud83d\udcdd Git Workflow (schnell)","text":""},{"location":"quick-reference/#anderung-einreichen","title":"\u00c4nderung einreichen","text":"<pre><code># Feature-Branch\ngit checkout -b fix/upgrade-command\n\n# Datei \u00e4ndern...\n\n# Committe\ngit add runbooks/RUNBOOK_*.md\ngit commit -m \"fix: Update command for service restart (Wazuh 4.12)\"\ngit push origin fix/upgrade-command\n\n# \u2192 Pull Request erstellen im Web\n</code></pre>"},{"location":"quick-reference/#anderung-reviewen","title":"\u00c4nderung reviewen","text":"<pre><code># Feature-Branch auschecken\ngit fetch origin fix/upgrade-command\ngit checkout -b review/fix-upgrade-command origin/fix/upgrade-command\n\n# Review &amp; test...\n\n# Mergen (nach Approval)\ngit checkout main\ngit merge --ff-only review/fix-upgrade-command\n</code></pre>"},{"location":"quick-reference/#secrets-management","title":"\ud83d\udd10 Secrets Management","text":"<p>Richtig: <pre><code>secrets_ref:\n  password: \"vault://deepcloud/wazuh/admin_password\"\n</code></pre></p> <p>FALSCH (NIE!): <pre><code>secrets_ref:\n  password: \"MySecretPassword123!\"  # \u274c NICHT!\n</code></pre></p> <p>Alle Credentials m\u00fcssen via Secret-Store referenziert sein!</p>"},{"location":"quick-reference/#support-links","title":"\ud83d\udcde Support-Links","text":"Resource URL Wazuh Upgrade Guide https://documentation.wazuh.com/current/upgrade-guide/ Wazuh Official Docs https://documentation.wazuh.com/ Project Repo /Users/i.stricker/docker/dev/Ta-SIEMPlus Contributing Guide CONTRIBUTING.md"},{"location":"quick-reference/#pro-tips","title":"\ud83d\udca1 Pro-Tips","text":""},{"location":"quick-reference/#tip-1-mehrere-befehle-in-serie-mit-verketten","title":"Tip 1: Mehrere Befehle in Serie mit &amp;&amp; verketten","text":"<pre><code>systemctl stop filebeat &amp;&amp; systemctl stop wazuh-dashboard &amp;&amp; echo \"Stopped successfully\"\n</code></pre>"},{"location":"quick-reference/#tip-2-health-check-in-einer-datei-speichern","title":"Tip 2: Health Check in einer Datei speichern","text":"<pre><code>date -Is &gt; /tmp/pre-upgrade-health.txt\nsystemctl status wazuh-* &gt;&gt; /tmp/pre-upgrade-health.txt\ndpkg -l | grep wazuh &gt;&gt; /tmp/pre-upgrade-health.txt\ncat /tmp/pre-upgrade-health.txt  # Sp\u00e4ter im Ticket posten\n</code></pre>"},{"location":"quick-reference/#tip-3-schnell-in-katalog-suchen","title":"Tip 3: Schnell in Katalog suchen","text":"<pre><code>grep -n \"infrastructure:\" Catalog/CUSTOMERS.md | grep DeepInfra\n</code></pre>"},{"location":"quick-reference/#tip-4-checkliste-lokal-offnen","title":"Tip 4: Checkliste lokal \u00f6ffnen","text":"<pre><code># Mac:\nopen checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md\n\n# Linux:\nxdg-open checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md\n\n# Windows (PowerShell):\nstart checklists\\CHECKLIST_WAZUH_UPGRADE_AIO.md\n</code></pre> <p>Brauchst du mehr Details? \u2192 GETTING_STARTED.md</p> <p>\u00c4nderung einreichen? \u2192 CONTRIBUTING.md</p> <p>Projekt-\u00dcberblick? \u2192 README.md</p>"},{"location":"catalog/","title":"Catalog","text":"<p>Customer infrastructure registry and configuration metadata for Wazuh SIEM installations.</p>"},{"location":"catalog/#overview","title":"\ud83d\udccb Overview","text":"<p>The catalog maintains a structured registry of: - Customer information - Infrastructure configurations - System identifiers - Secret references (vault paths only) - Contact information</p>"},{"location":"catalog/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>The catalog serves as a single source of truth for: - Planning maintenance operations - Documenting infrastructure details - Managing customer relationships - Tracking deployed systems - Referencing configuration metadata</p>"},{"location":"catalog/#available-catalog-resources","title":"\ud83d\udcda Available Catalog Resources","text":""},{"location":"catalog/#customer-registry","title":"Customer Registry","text":"<p>Complete registry of customers and their Wazuh infrastructure configurations.</p> <p>Includes: - Customer identification - Infrastructure details (hostnames, IPs, versions) - Contact information - Secret vault references - Maintenance windows - System specifications</p>"},{"location":"catalog/#catalog-documentation","title":"Catalog Documentation","text":"<p>Guidelines for maintaining and updating the catalog.</p>"},{"location":"catalog/#using-the-catalog","title":"\ud83d\udd27 Using the Catalog","text":""},{"location":"catalog/#for-planning-maintenance","title":"For Planning Maintenance","text":"<ol> <li>Look up customer in CUSTOMERS.md</li> <li>Retrieve infrastructure details:</li> <li>Hostnames and IPs</li> <li>Current versions</li> <li>Access credentials (vault references)</li> <li>Check maintenance windows</li> <li>Note contact information for notifications</li> </ol>"},{"location":"catalog/#for-documentation","title":"For Documentation","text":"<p>When documenting a procedure: - Reference customer by registered name - Use infrastructure identifiers from catalog - Include catalog metadata in checklists:   <pre><code>customer: Example Corp\ninfrastructure: wazuh-prod-01\n</code></pre></p>"},{"location":"catalog/#for-onboarding-new-customers","title":"For Onboarding New Customers","text":"<ol> <li>Follow the structure in CUSTOMERS.md</li> <li>Document all required fields</li> <li>Store secrets in vault (reference only)</li> <li>Update catalog via Pull Request</li> <li>Get review before merging</li> </ol>"},{"location":"catalog/#catalog-schema","title":"\ud83d\udcca Catalog Schema","text":""},{"location":"catalog/#customer-entry-template","title":"Customer Entry Template","text":"<pre><code>customer_name: \"Example Corporation\"\ncustomer_id: \"CUST-001\"\ncontact:\n  primary: \"John Doe &lt;john.doe@example.com&gt;\"\n  technical: \"Jane Smith &lt;jane.smith@example.com&gt;\"\n  phone: \"+41 XX XXX XX XX\"\n\ninfrastructure:\n  - name: \"wazuh-prod-01\"\n    type: \"All-in-One\"\n    environment: \"Production\"\n\n    access:\n      hostname: \"wazuh.example.com\"\n      ip_address: \"10.0.1.10\"\n      ssh_port: 22\n      secrets_ref: \"vault://example-corp/wazuh-prod\"\n\n    components:\n      wazuh_manager:\n        version: \"4.12.0\"\n        installed: \"2025-01-15\"\n      wazuh_indexer:\n        version: \"4.12.0\"\n        installed: \"2025-01-15\"\n      wazuh_dashboard:\n        version: \"4.12.0\"\n        installed: \"2025-01-15\"\n      filebeat:\n        version: \"7.10.2\"\n        installed: \"2025-01-15\"\n\n    agents:\n      count: 150\n      versions:\n        - \"4.12.0\": 140\n        - \"4.11.0\": 10\n\n    system:\n      os: \"Ubuntu 22.04 LTS\"\n      cpu: \"8 cores\"\n      memory: \"32 GB\"\n      disk: \"500 GB\"\n\n    maintenance:\n      window: \"Saturday 02:00-06:00 CET\"\n      frequency: \"Monthly\"\n      next_scheduled: \"2026-03-01\"\n\n    notes: |\n      - Critical production system\n      - 24/7 monitoring required\n      - Customer requires 2-day advance notice\n</code></pre>"},{"location":"catalog/#secrets-management","title":"\ud83d\udd10 Secrets Management","text":"<p>CRITICAL: Never store secrets directly in the catalog.</p>"},{"location":"catalog/#correct-approach","title":"\u2705 Correct Approach","text":"<pre><code>secrets_ref: \"vault://example-corp/wazuh-prod\"\n</code></pre> <p>The vault path should contain: - SSH credentials - API passwords - Certificate passphrases - Any other sensitive data</p>"},{"location":"catalog/#wrong-approach","title":"\u274c Wrong Approach","text":"<pre><code># NEVER DO THIS!\npassword: \"MySecretPassword123\"\napi_key: \"abc123def456\"\n</code></pre>"},{"location":"catalog/#catalog-maintenance","title":"\ud83d\udcdd Catalog Maintenance","text":""},{"location":"catalog/#adding-a-new-customer","title":"Adding a New Customer","text":"<ol> <li>Create entry following template</li> <li>Validate all required fields</li> <li>Store secrets in vault first</li> <li>Reference vault path in catalog</li> <li>Submit PR with description</li> <li>Get review from team</li> <li>Merge after approval</li> </ol>"},{"location":"catalog/#updating-customer-information","title":"Updating Customer Information","text":"<ol> <li>Locate customer entry</li> <li>Update changed fields</li> <li>Document reason in PR</li> <li>Update version numbers</li> <li>Update last_modified date</li> <li>Submit PR for review</li> </ol>"},{"location":"catalog/#version-tracking","title":"Version Tracking","text":"<p>After each upgrade: 1. Update component versions 2. Update agent version distribution 3. Note upgrade date 4. Update \"last_modified\" timestamp</p>"},{"location":"catalog/#regular-reviews","title":"Regular Reviews","text":"<ul> <li>Monthly: Verify contact information</li> <li>Quarterly: Audit version currency</li> <li>Annually: Review and archive inactive customers</li> </ul>"},{"location":"catalog/#quick-lookup","title":"\ud83d\udd0d Quick Lookup","text":""},{"location":"catalog/#finding-customer-information","title":"Finding Customer Information","text":"<pre><code># Search by customer name\ngrep -A 20 \"customer_name: \\\"Example\\\"\" CUSTOMERS.md\n\n# Find by infrastructure name\ngrep -A 30 \"name: \\\"wazuh-prod-01\\\"\" CUSTOMERS.md\n\n# List all customers\ngrep \"customer_name:\" CUSTOMERS.md\n</code></pre>"},{"location":"catalog/#verifying-current-versions","title":"Verifying Current Versions","text":"<pre><code># Extract version information for a customer\ngrep -A 5 \"wazuh_manager:\" CUSTOMERS.md | grep version\n</code></pre>"},{"location":"catalog/#integration-with-workflows","title":"\ud83d\udccb Integration with Workflows","text":"<p>The catalog integrates with operational workflows:</p>"},{"location":"catalog/#in-checklists","title":"In Checklists","text":"<p>Reference customer and infrastructure from catalog: <pre><code>customer: Example Corporation  # From catalog\ninfrastructure: wazuh-prod-01  # From catalog\n</code></pre></p>"},{"location":"catalog/#in-runbooks","title":"In Runbooks","text":"<p>Retrieve access details and system specs from catalog before executing procedures.</p>"},{"location":"catalog/#in-change-notes","title":"In Change Notes","text":"<p>Include catalog references for audit trail: <pre><code>Customer: Example Corporation (CUST-001)\nInfrastructure: wazuh-prod-01\n</code></pre></p>"},{"location":"catalog/#related-resources","title":"\ud83d\udd17 Related Resources","text":"<ul> <li>Customer Registry (YAML)</li> <li>Catalog Guidelines</li> <li>Checklists - Using catalog data in checklists</li> <li>Templates - Change documentation templates</li> </ul>"},{"location":"catalog/#additional-documentation","title":"\ud83d\udcda Additional Documentation","text":"<p>For more details on managing the catalog: - Review existing entries in CUSTOMERS.md as examples - Review existing entries as examples - Follow the contributing guidelines for updates</p>"},{"location":"catalog/CATALOG/","title":"Kundenkatalog \u2013 Verwaltete SIEM-Infrastrukturen","text":"<p>Dieses Dokument katalogisiert alle verwalteten Wazuh-Instanzen und deren Zugeh\u00f6rigkeiten.</p> <p>Status: \u2705 Production Zuletzt aktualisiert: 30. Januar 2026 Verwaltung: Dieses Dokument wird von der Web-basierte Katalog-Funktion (docs/catalog.html) synchronisiert.</p>"},{"location":"catalog/CATALOG/#1-deepcloud-ag","title":"1. Deepcloud AG","text":"<p>Kunde: Deepcloud AG Region: Schweiz (CH) Kontakt: [vault://deepcloud/contact] Supportlevel: 24/7 Premium  </p>"},{"location":"catalog/CATALOG/#infrastrukturen","title":"Infrastrukturen","text":"ID Name Region Status Wazuh-Version Upgrade-Plan <code>deeppay</code> DeepPay CH \ud83d\udfe2 Active 4.7.0 Q2 2026 <code>deepcloud</code> DeepCloud CH \ud83d\udfe2 Active 4.7.0 Q2 2026 <code>payinfra</code> PayInfra CH \ud83d\udfe2 Active 4.6.0 Q1 2026 <code>deepinfra</code> DeepInfra CH \ud83d\udfe2 Active 4.7.0 Q2 2026 <p>Besonderheiten: - Multi-Node-Cluster (payinfra &amp; deepinfra) - Geoverteilte Datenzentren - Compliance-Anforderungen: PCI-DSS, GDPR</p> <p>Kontakt-Informationen: <pre><code>Ansprechpartner: [vault://deepcloud/primary_contact]\nBackup-Kontakt: [vault://deepcloud/secondary_contact]\nChange-Window: Dienstags 02:00\u201306:00 UTC\n</code></pre></p>"},{"location":"catalog/CATALOG/#2-wagner-international-group-ag","title":"2. Wagner International Group AG","text":"<p>Kunde: Wagner International Group AG Region: Deutschland (DE) Kontakt: [vault://wagner/contact] Supportlevel: Business Hours + Escalation  </p>"},{"location":"catalog/CATALOG/#infrastrukturen_1","title":"Infrastrukturen","text":"ID Name Region Status Wazuh-Version Upgrade-Plan <code>altst\u00e4tten</code> Altst\u00e4tten DE/CH \ud83d\udfe2 Active 4.6.0 Q1 2026 <code>markdorf</code> Markdorf DE \ud83d\udfe2 Active 4.5.0 Q4 2025 <p>Besonderheiten: - Dual-Region-Setup - Legacy-System (Markdorf) mit schrittweisem Upgrade-Plan - Redundante Failover-Architektur</p> <p>Kontakt-Informationen: <pre><code>Ansprechpartner: [vault://wagner/primary_contact]\nChange-Window: Mittwochs 22:00\u201302:00 UTC (Maintenance-Fenster)\nNotfall-Hotline: [vault://wagner/emergency_number]\n</code></pre></p>"},{"location":"catalog/CATALOG/#3-abacus-research-ag","title":"3. Abacus Research AG","text":"<p>Kunde: Abacus Research AG Region: Schweiz (CH) Kontakt: [vault://abacus/contact] Supportlevel: Standard Business Hours  </p>"},{"location":"catalog/CATALOG/#infrastrukturen_2","title":"Infrastrukturen","text":"ID Name Region Status Wazuh-Version Upgrade-Plan <code>mito</code> MITO CH \ud83d\udfe2 Active 4.7.0 Q2 2026 <code>aba_infra</code> ABA Infrastructure CH \ud83d\udfe2 Active 4.7.0 Q2 2026 <p>Besonderheiten: - Research-fokussierte Umgebungen - H\u00e4ufige Test-Deployments - Flexible Upgrade-Windows</p> <p>Kontakt-Informationen: <pre><code>Ansprechpartner: [vault://abacus/primary_contact]\nIT-Lead: [vault://abacus/it_lead]\nChange-Window: Freitags 15:00\u201319:00 UTC\n</code></pre></p>"},{"location":"catalog/CATALOG/#4-oro-de-cacao","title":"4. Oro de Cacao","text":"<p>Kunde: Oro de Cacao Region: Sonstige EU (EU) Kontakt: [vault://orodecacao/contact] Supportlevel: Standard  </p>"},{"location":"catalog/CATALOG/#infrastrukturen_3","title":"Infrastrukturen","text":"ID Name Region Status Wazuh-Version Upgrade-Plan <code>default</code> Default Infrastructure EU \ud83d\udfe2 Active 4.6.0 Q1 2026 <p>Besonderheiten: - Single-Node-Instanz - Standard-Konfiguration - Cost-optimiert</p> <p>Kontakt-Informationen: <pre><code>Ansprechpartner: [vault://orodecacao/primary_contact]\nChange-Window: Montags 01:00\u201305:00 UTC\nTimezone: Europe/Madrid\n</code></pre></p>"},{"location":"catalog/CATALOG/#upgrade-roadmap","title":"Upgrade-Roadmap","text":""},{"location":"catalog/CATALOG/#q4-2025","title":"Q4 2025","text":"<ul> <li>\u2b1c Wagner / Markdorf: 4.5.0 \u2192 4.6.0</li> <li>\u2b1c Oro de Cacao: 4.6.0 \u2192 4.7.0</li> </ul>"},{"location":"catalog/CATALOG/#q1-2026","title":"Q1 2026","text":"<ul> <li>\ud83d\udd04 Wagner / Altst\u00e4tten: 4.6.0 \u2192 4.7.0</li> <li>\ud83d\udd04 Abacus / MITO &amp; ABA: 4.7.0 \u2192 4.8.0 (geplant)</li> </ul>"},{"location":"catalog/CATALOG/#q2-2026","title":"Q2 2026","text":"<ul> <li>\ud83d\udd04 Deepcloud / Alle: 4.7.0 \u2192 4.8.0 (geplant)</li> </ul>"},{"location":"catalog/CATALOG/#verwaltungsrichtlinien","title":"Verwaltungsrichtlinien","text":""},{"location":"catalog/CATALOG/#katalog-aktualisierungen","title":"Katalog-Aktualisierungen","text":"<ol> <li>Kundendaten: Updates via Pull Request auf dieses Dokument</li> <li>Versions\u00e4nderungen: Nach erfolgreicher Upgrade, mit Change-Ticket-Referenz</li> <li>Kontaktwechsel: SOFORT aktualisieren (Safety-Critical)</li> <li>Infrastruktur hinzuf\u00fcgen: Neue Zeile in entsprechender Tabelle + neue Sektion falls neuer Kunde</li> </ol>"},{"location":"catalog/CATALOG/#geheime-daten-vault-referenzen","title":"Geheime Daten (Vault-Referenzen)","text":"<p>\u26a0\ufe0f NIEMALS direkt commiten: - Passw\u00f6rter - API-Keys - SSH-Keys - Private-IPs (sofern klassifiziert)</p> <p>Stattdessen: Vault-Referenzen verwenden: <code>vault://customer/secret_key</code></p>"},{"location":"catalog/CATALOG/#integration-mit-web-tools","title":"Integration mit Web-Tools","text":"<p>Die Katalog-Daten werden in der Web-Anwendung (docs/catalog.html) angezeigt: - Kunden und Infrastrukturen sind interaktiv selektierbar - Auswahl wird automatisch in Formular, Checkliste und Runbook \u00fcbernommen - LocalStorage erm\u00f6glicht Persistierung w\u00e4hrend der Session</p>"},{"location":"catalog/CATALOG/#schnellerkennung-region-nach-kunde","title":"Schnellerkennung: Region nach Kunde","text":"Kunde Prim\u00e4re Region Failover-Region Timezone Deepcloud AG CH CH Europe/Zurich Wagner International Group AG DE CH Europe/Berlin / Europe/Zurich Abacus Research AG CH \u2014 Europe/Zurich Oro de Cacao EU \u2014 Europe/Madrid"},{"location":"catalog/CATALOG/#haufige-aufgaben","title":"H\u00e4ufige Aufgaben","text":""},{"location":"catalog/CATALOG/#ich-muss-eine-upgrade-durchfuhren-fur-kunden-x","title":"\"Ich muss eine Upgrade durchf\u00fchren f\u00fcr Kunden X\"","text":"<ol> <li>Geh zu Web-Katalog (docs/catalog.html)</li> <li>Suche den Kunden, w\u00e4hle die Infrastruktur</li> <li>Klicke \"Im Formular verwenden\"</li> <li>Metadaten werden automatisch gef\u00fcllt \u2705</li> <li>\u00d6ffne das Wartungsformular (maintenance-form.html)</li> <li>Folge Schritt 1\u20135 mit der Runbook und Checkliste</li> </ol>"},{"location":"catalog/CATALOG/#ich-muss-neue-kontaktdaten-fur-kunden-x-hinzufugen","title":"\"Ich muss neue Kontaktdaten f\u00fcr Kunden X hinzuf\u00fcgen\"","text":"<ol> <li>Dieses Dokument editieren (MARKDOWN)</li> <li>Vault-Referenzen hinzuf\u00fcgen: <code>vault://kunde/secret_key</code></li> <li>Pull Request erstellen + 1 Reviewer</li> <li>Merged \u2192 Dokumentation ist aktuell</li> <li>Web-Katalog wird durch JavaScript aktualisiert (cache invalidation)</li> </ol>"},{"location":"catalog/CATALOG/#welche-infrastrukturen-brauchen-upgrades","title":"\"Welche Infrastrukturen brauchen Upgrades?\"","text":"<p>Siehe Upgrade-Roadmap oben oder nutze die Web-Katalog-Suchfunktion.</p>"},{"location":"catalog/CATALOG/#feedback-erweiterungen","title":"Feedback &amp; Erweiterungen","text":"<p>Dieses Katalog-System ist gemeinschaftlich wartbar:</p> <ul> <li>Neue Infrastruktur? \u2192 Zeile in Tabelle + Upgrade-Plan hinzuf\u00fcgen</li> <li>Neue Kundin? \u2192 Neue Sektion mit Kontakt-Infos + Upgrade-Plan</li> <li>Datenfehler? \u2192 Pull Request mit Correction</li> <li>Sicherheitsbedenken? \u2192 Private Issue oder Email an Ops-Team</li> </ul> <p>Ziel: Ein einziger Katalog, synchron zwischen Markdown und Web.</p> <p>Anh\u00e4nge: - Web-Katalog: docs/catalog.html - Upgrade-Runbook: runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md - Change-Checkliste: checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md</p>"},{"location":"catalog/CUSTOMERS/","title":"Kunden- &amp; Infrastruktur-Katalog (Managed SIEM)","text":"<p>Purpose: Central, version-controlled catalog for operational details. Scope: All managed Wazuh installations for customers.  </p> <p>IMPORTANT SECURITY NOTICE: \u26a0\ufe0f NO SECRETS IN THIS FILE! \u26a0\ufe0f Credentials must only be referenced as paths to your secret store (e.g., Vault/1Password/Keepass/Passwordstate).</p>"},{"location":"catalog/CUSTOMERS/#how-to-use-this-file","title":"How to Use This File","text":"<ol> <li>Adding a New Customer/Infrastructure:</li> <li>Copy the YAML template at the bottom of this file</li> <li>Fill in all fields with actual values</li> <li>Replace <code>UNSET</code> placeholders with real data</li> <li>For secrets, use references like <code>vault://path/to/secret</code></li> <li> <p>Submit changes via Pull Request for review</p> </li> <li> <p>Updating Existing Entries:</p> </li> <li>Locate the customer's YAML block</li> <li>Make necessary changes</li> <li>Update any affected runbooks or checklists</li> <li> <p>Submit via Pull Request</p> </li> <li> <p>Reference During Operations:</p> </li> <li>Use this catalog to find URLs, hosts, and ports during maintenance</li> <li>Check <code>change_policy</code> before scheduling maintenance windows</li> <li>Reference <code>secrets_ref</code> paths when retrieving credentials</li> </ol>"},{"location":"catalog/CUSTOMERS/#schema-pro-kundeinfrastruktur","title":"Schema (pro Kunde/Infrastruktur)","text":"<pre><code>customer: \"DeepCloud AG\"\ninfrastructure: \"DeepInfra\"\nenvironment: \"prod\"\nwazuh_type: \"Ubuntu AIO (APT)\"\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"wazuh01.example.tld\"\n    mgmt_ip: \"10.10.10.10\"\nurls:\n  dashboard: \"https://wazuh01.example.tld\"\n  api: \"https://wazuh01.example.tld:55000\"\n  indexer: \"https://wazuh01.example.tld:9200\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nmonitoring:\n  log_sources:\n    - \"wazuh-manager journal\"\n    - \"wazuh-indexer journal\"\n    - \"wazuh-dashboard journal\"\n    - \"filebeat journal\"\n  health_notes: \"z.B. t\u00e4gliche Checks, Disk Schwellen, Backup Job\"\nsecrets_ref:\n  indexer_admin_creds: \"vault://\u2026/indexer-admin\"\n  wazuh_api_creds: \"vault://\u2026/wazuh-api\"\n  tls_material: \"vault://\u2026/tls\"\nchange_policy:\n  window: \"z.B. Mo 20:00\u201322:00 CET\"\n  customer_contacts: [\"\u2026\"]\n</code></pre>"},{"location":"catalog/CUSTOMERS/#eintrage","title":"Eintr\u00e4ge","text":"<p>Pro Kunde/Infrastruktur einen Block einf\u00fcgen (copy/paste des Schemas).</p>"},{"location":"catalog/CUSTOMERS/#template-bitte-kopieren","title":"TEMPLATE \u2013 bitte kopieren","text":"<pre><code>customer: \"UNSET\"\ninfrastructure: \"UNSET\"\nenvironment: \"prod|stage|dev\"\nwazuh_type: \"Ubuntu AIO (APT)\"\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"UNSET\"\n    mgmt_ip: \"UNSET\"\nurls:\n  dashboard: \"UNSET\"\n  api: \"UNSET\"\n  indexer: \"UNSET\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nsecrets_ref:\n  indexer_admin_creds: \"UNSET\"\n  wazuh_api_creds: \"UNSET\"\n  tls_material: \"UNSET\"\nchange_policy:\n  window: \"UNSET\"\n  customer_contacts: []\n</code></pre>"},{"location":"checklists/","title":"Checklists","text":"<p>Checklists are actionable ticket templates for change management. They are synchronized with runbooks and provide a structured way to track progress during maintenance operations.</p>"},{"location":"checklists/#available-checklists","title":"\ud83d\udccb Available Checklists","text":""},{"location":"checklists/#wazuh-upgrades","title":"Wazuh Upgrades","text":"<ul> <li>Wazuh Upgrade AIO - Checklist for All-in-One Wazuh upgrades</li> <li>Wazuh Upgrade AIO (Improved) - Enhanced version with additional validation steps</li> </ul>"},{"location":"checklists/#templates","title":"Templates","text":"<ul> <li>Checklist Template - Standard template for creating new checklists</li> </ul>"},{"location":"checklists/#how-to-use-checklists","title":"\ud83c\udfaf How to Use Checklists","text":""},{"location":"checklists/#before-you-start","title":"Before You Start","text":"<ol> <li>Copy the checklist into your change ticket or issue tracker</li> <li>Fill out metadata completely:    <pre><code>operator: &lt;your name&gt;\ncustomer: &lt;customer name&gt;\ninfrastructure: &lt;system identifier&gt;\nchange_ticket: &lt;ticket number&gt;\nmaintenance_window_start: &lt;ISO 8601 timestamp&gt;\nmaintenance_window_end: &lt;ISO 8601 timestamp&gt;\ntarget_version: &lt;version number&gt;\nsnapshot_id: &lt;snapshot identifier&gt;\nrunbook_ref: &lt;runbook filename&gt;\n</code></pre></li> <li>Review the runbook referenced in the checklist</li> <li>Verify prerequisites are met</li> </ol>"},{"location":"checklists/#during-execution","title":"During Execution","text":"<ol> <li>Follow the checklist order - items are sequenced for safety</li> <li>Check off each item as you complete it: <code>- [x] Completed item</code></li> <li>Reference the runbook for detailed commands (don't copy commands into checklist)</li> <li>Document deviations in the notes section</li> <li>Stop if you hit a no-go gate and escalate</li> </ol>"},{"location":"checklists/#after-completion","title":"After Completion","text":"<ol> <li>Complete all validation items</li> <li>Attach health snapshots (pre and post)</li> <li>Document findings in the checklist notes</li> <li>Update the change ticket</li> <li>Close the checklist only when all items are checked</li> </ol>"},{"location":"checklists/#checklist-structure","title":"\ud83d\udcca Checklist Structure","text":""},{"location":"checklists/#a-metadata-header","title":"A) Metadata Header","text":"<p>Required information for audit trail and tracking: - Operator name - Customer/infrastructure details - Change ticket reference - Maintenance window - Target versions - Snapshot identifiers</p>"},{"location":"checklists/#b-pre-flight-checks-no-go-gates","title":"B) Pre-Flight Checks (No-Go Gates)","text":"<p>Mandatory safety checks that must pass before proceeding: - [ ] Disk usage &lt; 90% - [ ] All services active (running) - [ ] Valid backup/snapshot exists - [ ] Change ticket approved - [ ] Within maintenance window</p>"},{"location":"checklists/#c-pre-change-snapshot","title":"C) Pre-Change Snapshot","text":"<p>Capture baseline system state: - [ ] Document current versions - [ ] Check service status - [ ] Review disk usage - [ ] Verify cluster health - [ ] Check for recent errors</p>"},{"location":"checklists/#d-execution-steps","title":"D) Execution Steps","text":"<p>Main procedure items (references runbook for details): - [ ] Step 1 (reference: Runbook Section X) - [ ] Step 2 (reference: Runbook Section Y) - [ ] Validation check - [ ] Continue...</p>"},{"location":"checklists/#e-post-change-snapshot","title":"E) Post-Change Snapshot","text":"<p>Verify system state after changes: - [ ] Confirm new versions - [ ] Verify all services running - [ ] Check cluster health - [ ] Review logs for errors</p>"},{"location":"checklists/#f-post-validation","title":"F) Post-Validation","text":"<p>Final checks before closure: - [ ] Functional tests passed - [ ] Performance acceptable - [ ] Customer notification sent - [ ] Documentation updated</p>"},{"location":"checklists/#g-notes-findings","title":"G) Notes &amp; Findings","text":"<p>Document any issues, deviations, or observations</p>"},{"location":"checklists/#synchronization-with-runbooks","title":"\ud83d\udd04 Synchronization with Runbooks","text":"<p>CRITICAL: Checklists and runbooks must stay synchronized.</p> <ul> <li>Checklists contain brief descriptions and reference runbook sections</li> <li>Runbooks contain detailed commands and troubleshooting</li> <li>Don't duplicate commands - reference the runbook instead</li> <li>When updating a runbook, check if checklist needs updates</li> <li>When updating a checklist, verify runbook sections match</li> </ul>"},{"location":"checklists/#example-of-proper-referencing","title":"Example of Proper Referencing","text":"<p>\u274c WRONG - Duplicating commands in checklist: <pre><code>- [ ] Upgrade indexer\n  ```bash\n  sudo apt-get update\n  sudo apt-get install wazuh-indexer=4.12.0-1\n  ```\n</code></pre></p> <p>\u2705 CORRECT - Referencing runbook: <pre><code>- [ ] Upgrade Wazuh Indexer (reference: Runbook Section 2.1)\n</code></pre></p>"},{"location":"checklists/#no-go-gates-in-checklists","title":"\ud83d\uded1 No-Go Gates in Checklists","text":"<p>Every checklist includes mandatory no-go gates. DO NOT PROCEED if any check fails:</p> <pre><code>## B) Pre-Flight Checks (No-Go Gates)\n- [ ] Disk usage &lt; 90% on all partitions (STOP if &gt; 90%)\n- [ ] All Wazuh services are `active (running)` (STOP if any failed)\n- [ ] Valid snapshot/backup created and verified (STOP if missing)\n- [ ] Change ticket CHG-XXXXX approved (STOP if not approved)\n- [ ] Within maintenance window (STOP if outside window)\n- [ ] All prerequisites from runbook verified\n</code></pre>"},{"location":"checklists/#creating-new-checklists","title":"\ud83d\udcdd Creating New Checklists","text":"<p>When creating a new checklist:</p> <ol> <li>Start with the template: Use CHECKLIST-TEMPLATE.md</li> <li>Reference existing runbook: Ensure a corresponding runbook exists</li> <li>Include all metadata fields: Don't skip the header section</li> <li>Add appropriate no-go gates: Based on the procedure's risks</li> <li>Test in practice: Validate in non-production first</li> <li>Submit via PR: Include rationale for new checklist</li> </ol>"},{"location":"checklists/#health-snapshot-tracking","title":"\ud83d\udcf8 Health Snapshot Tracking","text":"<p>Both pre and post snapshots must be: 1. Captured during the procedure 2. Documented in the checklist 3. Attached to the change ticket 4. Reviewed for any anomalies</p>"},{"location":"checklists/#what-to-include-in-snapshots","title":"What to Include in Snapshots","text":"<ul> <li>Component versions (before/after)</li> <li>Service status (all components)</li> <li>Resource utilization (disk, memory)</li> <li>Cluster health status</li> <li>Recent error logs (last 50 lines)</li> <li>API connectivity test results</li> </ul>"},{"location":"checklists/#related-resources","title":"\ud83d\udd17 Related Resources","text":"<ul> <li>Runbooks - Detailed procedures referenced by checklists</li> <li>Upgrade Guides - Version-specific upgrade information</li> <li>Templates - Change note templates for documentation</li> <li>Catalog - Customer infrastructure information</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/","title":"Checklist Template","text":"<p>Purpose: This template provides a starting point for creating new checklists for operational procedures.</p> <p>How to use: 1. Copy this file and rename it following the convention: <code>CHECKLIST_&lt;DESCRIPTION&gt;.md</code> 2. Fill in the metadata section at the top 3. Customize the checklist items below to match your procedure 4. Reference the corresponding runbook for detailed commands 5. Use this checklist in your change ticket for tracking progress</p>"},{"location":"checklists/CHECKLIST-TEMPLATE/#a-pre-flight-information","title":"A) Pre-Flight Information","text":"<p>Operator: <code>{{operator}}</code> Customer: <code>{{customer}}</code> Infrastructure: <code>{{infrastructure}}</code> Change Ticket: <code>{{change_ticket}}</code> Maintenance Window: <code>{{maintenance_window_start}}</code> \u2013 <code>{{maintenance_window_end}}</code> Runbook Reference: <code>{{runbook_ref}}</code></p>"},{"location":"checklists/CHECKLIST-TEMPLATE/#b-pre-checks-no-go-gates","title":"B) Pre-Checks (No-Go Gates)","text":"<ul> <li> Change approved and documented</li> <li> Customer notified of maintenance window</li> <li> Backup/Snapshot created and verified: <code>{{snapshot_id}}</code></li> <li> Prerequisites met (list specific requirements)</li> <li> Emergency contacts available</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/#c-execution-steps","title":"C) Execution Steps","text":""},{"location":"checklists/CHECKLIST-TEMPLATE/#c1-preparation","title":"C1) Preparation","text":"<ul> <li> Step 1: Description of what to do (reference: Runbook Section X)</li> <li> Step 2: Another preparation step</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/#c2-main-tasks","title":"C2) Main Tasks","text":"<ul> <li> Task 1: Core activity description</li> <li> Task 2: Another core activity</li> <li> Task 3: Verification checkpoint</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/#c3-post-actions","title":"C3) Post-Actions","text":"<ul> <li> Post-action 1: Cleanup or finalization</li> <li> Post-action 2: Documentation update</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/#d-post-checks-acceptance-criteria","title":"D) Post-Checks (Acceptance Criteria)","text":"<ul> <li> Service operational and accessible</li> <li> Functionality verified (describe specific tests)</li> <li> No critical errors in logs</li> <li> Customer notification sent</li> <li> Change ticket updated with results</li> </ul>"},{"location":"checklists/CHECKLIST-TEMPLATE/#e-rollback-if-needed","title":"E) Rollback (If Needed)","text":"<p>Rollback Triggers: - [ ] Service fails to start - [ ] Critical functionality broken - [ ] Data loss detected</p> <p>Rollback Method: - [ ] Restore from snapshot: <code>{{snapshot_id}}</code> - [ ] Alternative method (if applicable)</p> <p>Post-Rollback: - [ ] Incident record created - [ ] Root cause analysis scheduled</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/","title":"Wazuh Upgrade Checkliste \u2013 Ubuntu AIO (Central Components)","text":"<p>Zweck: 1:1 Checkliste f\u00fcr Change-Tickets bei Wazuh Upgrades. Verwendung: Diese Checkliste ist direkt in Change-Tickets zu kopieren und Schritt f\u00fcr Schritt abzuarbeiten. Detaillierte Befehle: Siehe referenziertes Runbook: <code>{{runbook_ref}}</code></p> <p>WICHTIG: F\u00fclle zuerst die Metadaten oben aus, bevor du mit der Checkliste beginnst!</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#anleitung","title":"Anleitung","text":"<ol> <li>Vor Beginn: Trage alle Stammdaten im Metadaten-Block (oben) ein</li> <li>W\u00e4hrend der Durchf\u00fchrung: Hake jeden Punkt ab (<code>[x]</code>) sobald erledigt</li> <li>Befehle: Verwende das Runbook f\u00fcr genaue Befehle - diese Checkliste ist zur Nachverfolgung, nicht f\u00fcr Copy/Paste von Commands</li> <li>Dokumentation: F\u00fcge Pre- und Post-Health Snapshots dem Change-Ticket bei</li> <li>Bei Problemen: Siehe Abschnitt E f\u00fcr Rollback-Entscheidungen</li> </ol> <p>Diese Checkliste ist 1:1 f\u00fcr Change/Ticket gedacht. Commands stehen im Runbook: <code>{{runbook_ref}}</code></p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#a-stammdaten-vorab-ausfullen","title":"A) Stammdaten (vorab ausf\u00fcllen)","text":"<p>Operator (genau 1 ausw\u00e4hlen): - [ ] David Dutler - [ ] Ivan Stricker</p> <p>Kunde: <code>{{customer}}</code> Infrastruktur: <code>{{infrastructure}}</code> Change/Ticket: <code>{{change_ticket}}</code> Wartungsfenster: <code>{{maintenance_window_start}}</code> \u2013 <code>{{maintenance_window_end}}</code> (Europe/Zurich) Ist-/Zielversion: <code>{{current_version}}</code> \u2192 <code>{{target_version}}</code> Snapshot/Backup-ID: <code>{{snapshot_id}}</code> Guide: <code>{{guide_ref}}</code></p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#b-pre-go-no-go-gates","title":"B) Pre-Go (No-Go Gates)","text":"<ul> <li> Change freigegeben (approved)</li> <li> Kunde informiert (Downtime/Impact kommuniziert)</li> <li> Guide gelesen (Breaking Changes / besondere Schritte)</li> <li> Voraussetzungen validiert (siehe Runbook Abschnitt \"Voraussetzungen\")</li> <li> System-Ressourcen gepr\u00fcft (Disk &lt; 85%, RAM verf\u00fcgbar, No-Go wenn Disk &gt; 90%)</li> <li> Netzwerk-Konnektivit\u00e4t zu Wazuh-Repositories best\u00e4tigt</li> <li> Candidate-Versionen sind identisch (Indexer/Manager/Dashboard inkl. Patchlevel)</li> <li> VM/Volume-Snapshot erstellt (empfohlen) ODER Konfigurations-Backup erstellt</li> <li> Snapshot/Backup-ID dokumentiert (<code>snapshot_id</code>)</li> <li> Health Snapshot (Runbook Abschnitt 1) durchgef\u00fchrt und im Ticket abgelegt</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c-ausfuhrung-guide-aligned","title":"C) Ausf\u00fchrung (Guide-aligned)","text":""},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c1-controlled-stop","title":"C1) Controlled Stop","text":"<ul> <li> <code>filebeat</code> gestoppt</li> <li> <code>wazuh-dashboard</code> gestoppt</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c2-indexer-pre-actions","title":"C2) Indexer Pre-Actions","text":"<ul> <li> Security-Konfig Backup ausgef\u00fchrt</li> <li> Shard Allocation = <code>primaries</code></li> <li> Flush ausgef\u00fchrt</li> <li> <code>wazuh-manager</code> gestoppt (insb. single-node indexer cluster)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c3-indexer-upgrade","title":"C3) Indexer Upgrade","text":"<ul> <li> <code>wazuh-indexer</code> gestoppt</li> <li> <code>jvm.options</code> gesichert (<code>.old</code>)</li> <li> Paket <code>wazuh-indexer</code> aktualisiert</li> <li> <code>wazuh-indexer</code> gestartet und Status OK</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c4-indexer-post-actions","title":"C4) Indexer Post-Actions","text":"<ul> <li> <code>indexer-security-init.sh</code> ausgef\u00fchrt (Security re-apply)</li> <li> <code>_cat/nodes</code> OK</li> <li> Shard Allocation = <code>all</code></li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c5-manager-upgrade","title":"C5) Manager Upgrade","text":"<ul> <li> Paket <code>wazuh-manager</code> aktualisiert</li> <li> <code>wazuh-manager</code> gestartet und Status OK</li> <li> <code>ossec.log</code> auf Errors gepr\u00fcft (quick)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c6-filebeat-updatesetup","title":"C6) Filebeat Update/Setup","text":"<ul> <li> Wazuh Filebeat Module aktualisiert</li> <li> <code>wazuh-template.json</code> zur Zielversion aktualisiert</li> <li> Filebeat Paket aktualisiert</li> <li> Pipelines geladen (<code>filebeat setup --pipelines</code>)</li> <li> Index-Management geladen (<code>filebeat setup --index-management ...</code>)</li> <li> <code>filebeat</code> l\u00e4uft (Status OK)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#c7-dashboard-upgrade","title":"C7) Dashboard Upgrade","text":"<ul> <li> Dashboard Config gesichert (<code>opensearch_dashboards.yml.old</code>)</li> <li> Paket <code>wazuh-dashboard</code> aktualisiert</li> <li> <code>wazuh-dashboard</code> l\u00e4uft (Status OK)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#d-post-go-abnahme","title":"D) Post-Go (Abnahme)","text":"<ul> <li> Versionen verifiziert (alle Komponenten auf identischer Version)</li> <li> Services Health Check (alle Services aktiv und ohne Fehler)</li> <li> Funktionale Validierung (Cluster Health, Indices, Events)</li> <li> Health Snapshot (Runbook Abschnitt 1) erneut ausgef\u00fchrt und im Ticket abgelegt</li> <li> Dashboard erreichbar (HTTPS)</li> <li> Login erfolgreich (mit korrekten Credentials)</li> <li> Datenfluss plausibel (neue Events kommen an / Testevent verifiziert)</li> <li> Keine kritischen Fehler in journalctl-Logs (Indexer/Manager/Dashboard/Filebeat)</li> <li> Alle Ports h\u00f6ren wie erwartet (1514, 1515, 55000, 9200, 5601)</li> <li> Abschlussmeldung an Kunde gesendet (Versionen + kurzer Health-Status)</li> <li> Change/Ticket sauber dokumentiert (Start/Ende, Findings, Abweichungen)</li> </ul> <p>Dokumentation Check: - [ ] Pre-Upgrade Health Snapshot im Ticket - [ ] Post-Upgrade Health Snapshot im Ticket - [ ] Backup/Snapshot-ID dokumentiert - [ ] Upgrade-Zeitstempel (Start und Ende) dokumentiert - [ ] Zielversion erreicht und dokumentiert</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#e-storung-rollback-entscheidung","title":"E) St\u00f6rung / Rollback Entscheidung","text":"<p>Trigger f\u00fcr Rollback (Beispiele): - [ ] Indexer nicht stabil (Crash/Red-Cluster) - [ ] Auth/TLS/Index Security nicht funktionsf\u00e4hig - [ ] Datenfluss bricht nachhaltig (keine Events, Filebeat Errors) - [ ] Dashboard nicht erreichbar / keine Anmeldung m\u00f6glich - [ ] Kritische Services starten nicht nach mehreren Versuchen - [ ] Upgrade-Zeitfenster wird \u00fcberschritten - [ ] Performance-Degradation ist inakzeptabel</p> <p>Rollback-Methode (eine ausw\u00e4hlen): - [ ] VM/Volume-Snapshot Restore (empfohlen, siehe Runbook Abschnitt 10.1) - [ ] Paket-Downgrade (nur wenn Snapshot nicht verf\u00fcgbar, siehe Runbook Abschnitt 10.2)</p> <p>Nach Rollback: - [ ] Post-Rollback Health Snapshot erstellt und dokumentiert - [ ] Funktionalit\u00e4t best\u00e4tigt (Dashboard Login, Datenfluss) - [ ] Stakeholder \u00fcber Rollback informiert - [ ] Grund f\u00fcr Rollback im Ticket dokumentiert</p> <p>Post-Mortem und Follow-up: - [ ] Incident-Report erstellt (Root Cause / Prevention / Lessons Learned) - [ ] Follow-up Tasks erfasst (Hardening, Monitoring, Automatisierung) - [ ] Neuer Upgrade-Versuch geplant (mit Lessons Learned) - [ ] Bei Bedarf: Test-Upgrade in Staging-Umgebung vor erneutem Produktions-Upgrade</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO/#f-troubleshooting-referenz","title":"F) Troubleshooting-Referenz","text":"<p>Falls Probleme w\u00e4hrend des Upgrades auftreten, konsultieren Sie:</p> <p>Runbook Abschnitt 11: Troubleshooting Guide</p> <p>H\u00e4ufige Probleme mit L\u00f6sungen: - Indexer startet nicht nach Upgrade - Manager startet nicht nach Upgrade - Dashboard nicht erreichbar - Filebeat l\u00e4uft, aber keine Events im Indexer - Cluster Health = RED - Login am Dashboard funktioniert nicht - Version Conflicts oder Compatibility Issues</p> <p>Notfall-Kommandos: Siehe Runbook Abschnitt 11 f\u00fcr kompletten Service-Neustart und Support-Log-Sammlung.</p> <p>Checklisten-Version: 1.1 (aktualisiert Januar 2026) \u00c4nderungen: Erweiterte Validierungsschritte, detaillierte Rollback-Checks, Troubleshooting-Referenz</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/","title":"\ud83d\ude80 Wazuh Upgrade Checkliste \u2013 Ubuntu AIO (Central Components)","text":"<p>Purpose: Copy this entire checklist into your change ticket and follow it step-by-step. Detailed Commands: See referenced runbook: <code>{{runbook_ref}}</code></p> <p>IMPORTANT: Fill in all metadata fields above before proceeding!</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#a-pre-flight-information-metadata-confirmation","title":"A) Pre-Flight Information (Metadata Confirmation)","text":"<p>Operator: <code>{{operator}}</code> Customer: <code>{{customer}}</code> Infrastructure: <code>{{infrastructure}}</code> Environment: <code>{{environment}}</code> Change Ticket: <code>{{change_ticket}}</code> Maintenance Window: <code>{{maintenance_window_start}}</code> \u2013 <code>{{maintenance_window_end}}</code> (Europe/Zurich) Upgrade: <code>{{current_version}}</code> \u2192 <code>{{target_version}}</code> Recovery Point: <code>{{snapshot_id}}</code> Runbook: <code>{{runbook_ref}}</code> Official Guide: <code>{{guide_ref}}</code></p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#b-pre-go-gates-no-go-conditions","title":"B) Pre-Go Gates (No-Go Conditions)","text":"<p>\u26d4 STOP if ANY of these are not \u2713 \u2013 DO NOT PROCEED</p> <ul> <li> Change approved and authorized</li> <li> Customer notified (downtime/impact communicated)</li> <li> Upgrade guide read (breaking changes checked)</li> <li> Prerequisites validated (see Runbook \"Prerequisites\" section)</li> <li> System resources confirmed (Disk &lt; 85%, RAM available, STOP if Disk &gt; 90%)</li> <li> Network connectivity to Wazuh repositories verified</li> <li> Candidate versions are identical (Indexer/Manager/Dashboard same patch level)</li> <li> VM/Volume snapshot created (recommended) OR configuration backup created</li> <li> Snapshot/Backup ID documented in <code>snapshot_id</code> above</li> <li> Health Snapshot (pre-change) captured and attached to this ticket</li> </ul> <p>If all above are \u2713, proceed to Section C.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c-execution-step-by-step","title":"C) Execution (Step-by-Step)","text":""},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c1-pre-change-health-snapshot-critical","title":"C1) Pre-Change Health Snapshot (CRITICAL)","text":"<p>Execute this command before any changes:</p> <pre><code>date -Is\necho \"=== DISK USAGE ===\"\ndf -h | grep -v tmpfs\necho \"=== MEMORY ===\"\nfree -h\necho \"=== SERVICES ===\"\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\necho \"=== INSTALLED VERSIONS ===\"\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\necho \"=== CLUSTER HEALTH ===\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n</code></pre> <ul> <li> Output saved to this ticket (attach as file or paste in comments)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c2-controlled-stop-services","title":"C2) Controlled Stop (Services)","text":"<ul> <li> Stop <code>filebeat</code></li> <li> Stop <code>wazuh-dashboard</code></li> <li> Stop <code>wazuh-manager</code></li> <li> Stop <code>wazuh-indexer</code></li> </ul> <p>See Runbook Section 2-4 for exact commands.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c3-indexer-pre-actions","title":"C3) Indexer Pre-Actions","text":"<ul> <li> Security configuration backup completed</li> <li> Shard allocation set to <code>primaries</code></li> <li> Cluster flush executed</li> <li> Verify: Disk space still &lt; 85%</li> </ul> <p>See Runbook Section 5-7 for exact commands.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c4-apt-package-upgrade","title":"C4) APT Package Upgrade","text":"<ul> <li> APT package list updated (<code>apt update</code>)</li> <li> Wazuh Indexer upgraded</li> <li> Wazuh Manager upgraded</li> <li> Wazuh Dashboard upgraded</li> <li> Filebeat upgraded</li> </ul> <p>See Runbook Section 8 for exact commands.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#c5-services-start-verification","title":"C5) Services Start &amp; Verification","text":"<ul> <li> Start <code>wazuh-indexer</code> (wait 30-60 seconds)</li> <li> Verify indexer is <code>active (running)</code></li> <li> Start <code>wazuh-manager</code> (wait 20-30 seconds)</li> <li> Verify manager is <code>active (running)</code></li> <li> Start <code>wazuh-dashboard</code></li> <li> Verify dashboard is <code>active (running)</code></li> <li> Start <code>filebeat</code></li> <li> Verify filebeat is <code>active (running)</code></li> </ul> <p>See Runbook Section 9 for exact commands.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#d-post-change-validation","title":"D) Post-Change Validation","text":""},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#d1-health-check-post-upgrade","title":"D1) Health Check (POST-UPGRADE)","text":"<p>Execute the same health snapshot command from Section C1:</p> <pre><code>date -Is\necho \"=== DISK USAGE ===\"\ndf -h | grep -v tmpfs\necho \"=== MEMORY ===\"\nfree -h\necho \"=== SERVICES ===\"\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\necho \"=== INSTALLED VERSIONS ===\"\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\necho \"=== CLUSTER HEALTH ===\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n</code></pre> <ul> <li> Output saved to this ticket (compare with PRE-snapshot)</li> <li> Versions confirmed: All components updated to <code>{{target_version}}</code></li> <li> All services running: status = <code>active (running)</code></li> <li> Cluster health: Yellow or Green (NOT Red)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#d2-functional-testing","title":"D2) Functional Testing","text":"<ul> <li> Dashboard accessible (open in browser)</li> <li> Login successful (admin user works)</li> <li> Data ingestion working (agents reporting data)</li> <li> API responsive (<code>/api/v1/manager/info</code>)</li> <li> No critical errors in logs (check journal output)</li> </ul> <p>See Runbook Section 10 for detailed tests.</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#d3-deviations-findings","title":"D3) Deviations &amp; Findings","text":"<ul> <li> All pre-checks passed: YES / NO</li> <li> All services upgraded successfully: YES / NO</li> <li> Any warnings or errors encountered? Describe:   <pre><code>(paste relevant journal output or describe issues)\n</code></pre></li> <li> Workarounds applied? If yes, describe:   <pre><code>(paste workarounds)\n</code></pre></li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#e-rollback-if-needed","title":"E) Rollback (If Needed)","text":""},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#rollback-triggers","title":"Rollback Triggers","text":"<p>Execute rollback immediately if: - [ ] Service fails to start after 2-3 minutes - [ ] Cluster health = RED (cannot recover) - [ ] Data loss detected - [ ] Critical functionality broken</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#rollback-method","title":"Rollback Method","text":"<p>Choose ONE:</p> <p>Option 1: VM/Volume Snapshot Restore (Recommended) - [ ] Power off server - [ ] Restore VM/Volume snapshot: <code>{{snapshot_id}}</code> - [ ] Power on server - [ ] Verify services running and data intact</p> <p>Option 2: Downgrade Packages <pre><code>apt install --allow-downgrades wazuh-indexer={{current_version}} wazuh-manager={{current_version}} wazuh-dashboard={{current_version}} filebeat={{current_version}}\nsystemctl restart wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n</code></pre> - [ ] Downgrade completed - [ ] Services verified running - [ ] Health snapshot taken</p> <p>Option 3: Configuration Restore <pre><code># Restore from backup\ntar -xzf /root/wazuh_backup_*/var_ossec_etc.tgz -C /\nsystemctl restart wazuh-*\n</code></pre> - [ ] Configuration restored - [ ] Services restarted - [ ] Health snapshot taken</p>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#post-rollback","title":"Post-Rollback","text":"<ul> <li> Incident ticket created: <code>INC-XXXX-XXXXX</code></li> <li> Root cause analysis scheduled</li> <li> Customer notified of rollback</li> <li> Recovery snapshot documented: <code>snap-XXXXXXXXXXXXXX</code></li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#f-sign-off-documentation","title":"F) Sign-Off &amp; Documentation","text":""},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#approval","title":"Approval","text":"<ul> <li> Executed by (Operator): <code>{{operator}}</code></li> <li> Approved by (Reviewer): _________________ (Name + Date)</li> <li> Customer Notified: YES / NO (Date: ____________)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#final-checklist","title":"Final Checklist","text":"<ul> <li> Change ticket closed (status: Completed/Rolled-back)</li> <li> Pre- and post-health snapshots attached</li> <li> All deviations documented</li> <li> Customer sign-off obtained</li> <li> Runbook feedback provided (if applicable)</li> </ul>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#change-note-optional","title":"Change Note (Optional)","text":"<p>Copy this template into your Change Management System for final documentation:</p> <pre><code># Change Completion Note\n\n**Change:** Wazuh Upgrade (Central Components)  \n**Ticket:** {{change_ticket}}  \n**Operator:** {{operator}}  \n**Date:** YYYY-MM-DD  \n\n## Summary\nUpgraded {{system}} from {{current_version}} to {{target_version}}.\n\n## Pre-Change State\n[Paste PRE-snapshot here]\n\n## Post-Change State\n[Paste POST-snapshot here]\n\n## Findings\n[List any deviations or warnings]\n\n## Status\n\u2705 Successful / \ud83d\udd04 Rolled-back / \u26a0\ufe0f Partial\n\n## Next Steps\n[If issues remain, describe action items]\n</code></pre>"},{"location":"checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED/#g-quick-help","title":"G) Quick Help","text":"Issue Action Disk &gt; 90% STOP \u2013 Free disk space first Service won't start Check journal (<code>journalctl -u &lt;service&gt; -n 50</code>) \u2013 see Runbook Troubleshooting Cluster health RED Restore snapshot or perform rollback Agents not reporting Verify network / API connectivity Dashboard slow Wait 5 min for indexing, check disk usage <p>Questions? See Runbook Section 11 (Troubleshooting) or contact your team.</p> <p>\u2705 When all boxes are checked \u2192 Upgrade is complete!</p>"},{"location":"config-templates/","title":"Konfigurationsvorlagen (Config Templates)","text":"<p>Betriebsfertige Konfigurationsvorlagen f\u00fcr alle Wazuh-Komponenten. Alle Variablen sind mit <code>{{ VARIABLE_NAME }}</code> markiert \u2013 eine vollst\u00e4ndige Referenz aller Variablen steht in VARIABLES.md.</p>"},{"location":"config-templates/#verwendung","title":"Verwendung","text":""},{"location":"config-templates/#schritt-1-variablen-definieren","title":"Schritt 1 \u2013 Variablen definieren","text":"<p>Lege eine Datei <code>vars.yml</code> an (wird niemals committed):</p> <pre><code># vars.yml \u2013 NICHT in Git einchecken!\nMANAGER_HOST: \"192.168.1.10\"\nCLUSTER_NAME: \"wazuh-cluster\"\nCLUSTER_NODE_NAME: \"wazuh-manager-01\"\nINDEXER_HOST: \"127.0.0.1\"\nINDEXER_PORT: \"9200\"\nCUSTOMER_ID: \"kunde-ag\"\n</code></pre>"},{"location":"config-templates/#schritt-2-template-befullen","title":"Schritt 2 \u2013 Template bef\u00fcllen","text":"<pre><code># Mit envsubst (einfachste Methode)\nexport $(cat vars.yml | grep -v '#' | xargs)\nenvsubst &lt; manager/ossec.conf.template &gt; /var/ossec/etc/ossec.conf\n\n# Oder mit sed f\u00fcr einzelne Variablen\nsed 's/{{ MANAGER_HOST }}/192.168.1.10/g' manager/ossec.conf.template\n</code></pre>"},{"location":"config-templates/#schritt-3-validieren-deployen","title":"Schritt 3 \u2013 Validieren &amp; deployen","text":"<pre><code># Wazuh-Konfiguration validieren\n/var/ossec/bin/wazuh-control check-config\n\n# Dienst neu starten\nsystemctl restart wazuh-manager\n</code></pre>"},{"location":"config-templates/#verfugbare-templates","title":"Verf\u00fcgbare Templates","text":"Datei Komponente Beschreibung manager/ossec.conf.template Manager (AIO) Vollst\u00e4ndige Manager-Konfiguration agent/ossec.conf.template Agent (Linux) Standard Linux-Agent-Konfiguration manager/agent_groups/linux-servers.conf Agentengruppe Shared Config f\u00fcr Linux-Server manager/agent_groups/windows-endpoints.conf Agentengruppe Shared Config f\u00fcr Windows-Endpoints indexer/opensearch.yml.template Wazuh Indexer OpenSearch/Indexer-Konfiguration filebeat/filebeat.yml.template Filebeat Filebeat f\u00fcr Wazuh-Dashboard"},{"location":"config-templates/#variablenreferenz","title":"Variablenreferenz","text":"<p>Vollst\u00e4ndige Beschreibung aller <code>{{ VARIABLE }}</code>-Platzhalter: VARIABLES.md</p>"},{"location":"config-templates/#hinweise","title":"Hinweise","text":"<p>Secrets</p> <p>Variablen wie <code>INDEXER_PASSWORD</code> oder <code>API_PASSWORD</code> niemals in Git einchecken. Immer \u00fcber Vault oder CI/CD-Secrets bef\u00fcllen: <pre><code>INDEXER_PASSWORD=$(vault kv get -field=password secret/wazuh/indexer)\n</code></pre></p> <p>Wazuh-Version</p> <p>Templates sind f\u00fcr Wazuh {{ WAZUH_VERSION }} getestet. Bei anderen Versionen auf strukturelle \u00c4nderungen in der Dokumentation pr\u00fcfen.</p>"},{"location":"config-templates/VARIABLES/","title":"Variablenreferenz","text":"<p>Alle <code>{{ VARIABLE_NAME }}</code>-Platzhalter in den Config-Templates mit Typ, Beispielwert und Beschreibung.</p>"},{"location":"config-templates/VARIABLES/#allgemein","title":"Allgemein","text":"Variable Typ Beispiel Beschreibung <code>WAZUH_VERSION</code> String <code>4.12.0</code> Installierte Wazuh-Version <code>CUSTOMER_ID</code> String <code>kunde-ag</code> Kunden-Identifier aus dem Katalog <code>CHANGE_TICKET</code> String <code>CHG-2026-0123</code> Referenz auf das Change-Ticket"},{"location":"config-templates/VARIABLES/#manager-cluster","title":"Manager / Cluster","text":"Variable Typ Beispiel Beschreibung <code>MANAGER_HOST</code> IP / FQDN <code>192.168.1.10</code> IP oder Hostname des Wazuh-Managers <code>MANAGER_PORT</code> Integer <code>1514</code> Kommunikationsport (UDP/TCP) <code>CLUSTER_NAME</code> String <code>wazuh-cluster</code> Name des Wazuh-Clusters <code>CLUSTER_NODE_NAME</code> String <code>wazuh-manager-01</code> Eindeutiger Nodename im Cluster <code>CLUSTER_NODE_TYPE</code> String <code>master</code> <code>master</code> oder <code>worker</code> <code>CLUSTER_KEY</code> String (vault) 32-Zeichen Cluster-Shared-Key \u2013 niemals im Klartext! <code>CLUSTER_BIND_ADDR</code> IP <code>0.0.0.0</code> Bind-Adresse f\u00fcr Cluster-Kommunikation <code>CLUSTER_NODES</code> CSV <code>192.168.1.10</code> Kommagetrennte Liste aller Cluster-Nodes <code>CLUSTER_DISABLED</code> Boolean <code>yes</code> <code>yes</code> f\u00fcr AIO (Single-Node), <code>no</code> f\u00fcr Multi-Node"},{"location":"config-templates/VARIABLES/#indexer","title":"Indexer","text":"Variable Typ Beispiel Beschreibung <code>INDEXER_HOST</code> IP / FQDN <code>127.0.0.1</code> Host des Wazuh-Indexers (AIO: localhost) <code>INDEXER_PORT</code> Integer <code>9200</code> API-Port des Indexers <code>INDEXER_USERNAME</code> String <code>admin</code> Indexer-Benutzername <code>INDEXER_PASSWORD</code> String (vault) Indexer-Passwort \u2013 niemals im Klartext! <code>INDEXER_SSL_VERIFY</code> Boolean <code>true</code> TLS-Zertifikat des Indexers pr\u00fcfen <code>INDEXER_NODE_NAME</code> String <code>wazuh-indexer-01</code> Nodename im Indexer-Cluster <code>INDEXER_NETWORK_HOST</code> IP <code>0.0.0.0</code> Bind-IP des Indexers <code>INDEXER_CLUSTER_NAME</code> String <code>wazuh-cluster</code> Cluster-Name im Indexer <code>INDEXER_INITIAL_MASTERS</code> String <code>wazuh-indexer-01</code> Initial master nodes"},{"location":"config-templates/VARIABLES/#api","title":"API","text":"Variable Typ Beispiel Beschreibung <code>API_HOST</code> IP <code>0.0.0.0</code> Bind-Adresse der Wazuh-API <code>API_PORT</code> Integer <code>55000</code> Port der Wazuh-API <code>API_USERNAME</code> String <code>wazuh-wui</code> API-Benutzername f\u00fcr Dashboard <code>API_PASSWORD</code> String (vault) API-Passwort \u2013 niemals im Klartext!"},{"location":"config-templates/VARIABLES/#e-mail-benachrichtigungen","title":"E-Mail / Benachrichtigungen","text":"Variable Typ Beispiel Beschreibung <code>EMAIL_ENABLED</code> Boolean <code>no</code> E-Mail-Benachrichtigungen aktivieren <code>EMAIL_TO</code> E-Mail <code>soc@firma.ch</code> Empf\u00e4ngeradresse <code>EMAIL_FROM</code> E-Mail <code>wazuh@firma.ch</code> Absenderadresse <code>EMAIL_SMTP_SERVER</code> FQDN <code>mail.firma.ch</code> SMTP-Relay-Server <code>EMAIL_ALERT_LEVEL</code> Integer <code>12</code> Mindest-Level f\u00fcr E-Mail-Alerts (0\u201315)"},{"location":"config-templates/VARIABLES/#syslog-output","title":"Syslog-Output","text":"Variable Typ Beispiel Beschreibung <code>SYSLOG_ENABLED</code> Boolean <code>no</code> Syslog-Output aktivieren <code>SYSLOG_SERVER</code> IP / FQDN <code>siem.firma.ch</code> Syslog-Zielserver <code>SYSLOG_PORT</code> Integer <code>514</code> Syslog-Port <code>SYSLOG_PROTOCOL</code> String <code>udp</code> <code>udp</code> oder <code>tcp</code> <code>SYSLOG_ALERT_LEVEL</code> Integer <code>9</code> Mindest-Level f\u00fcr Syslog-Weitergabe"},{"location":"config-templates/VARIABLES/#agent","title":"Agent","text":"Variable Typ Beispiel Beschreibung <code>AGENT_NAME</code> String <code>web-server-01</code> Name des Agents (Hostname empfohlen) <code>AGENT_GROUP</code> String <code>linux-servers</code> Zugewiesene Agentengruppe <code>AGENT_PROTOCOL</code> String <code>tcp</code> Transportprotokoll: <code>tcp</code> oder <code>udp</code>"},{"location":"config-templates/VARIABLES/#pfade-logs","title":"Pfade &amp; Logs","text":"Variable Typ Beispiel Beschreibung <code>LOG_ALL</code> Boolean <code>no</code> Alle Events loggen (Achtung: Volumen!) <code>LOG_FORMAT</code> String <code>plain</code> <code>plain</code> oder <code>json</code> <code>SYSCHECK_FREQUENCY</code> Integer <code>43200</code> FIM-Scan-Intervall in Sekunden (Standard: 12h)"},{"location":"config-templates/VARIABLES/#sicherheitshinweis","title":"Sicherheitshinweis","text":"<p>Niemals im Klartext committen</p> <p>Variablen mit <code>*(vault)*</code> sind Secrets. Diese nie direkt in eine Datei schreiben.</p> <pre><code># Richtig: Aus Vault lesen\nexport INDEXER_PASSWORD=$(vault kv get -field=password secret/wazuh/indexer)\nexport CLUSTER_KEY=$(vault kv get -field=key secret/wazuh/cluster)\n\n# Richtig: Aus CI/CD-Secrets\n# \u2192 GitHub: Settings \u2192 Secrets and variables \u2192 Actions\n\n# FALSCH:\n# INDEXER_PASSWORD=\"MeinPasswort123\"  \u2190 niemals!\n</code></pre>"},{"location":"config-templates/agent/ossec-agent/","title":"ossec.conf \u2013 Wazuh Agent (Linux)","text":"<p>Standard-Konfiguration f\u00fcr Wazuh Linux-Agenten.</p> <p>Variablenreferenz: VARIABLES.md Rohdatei (zum Download): <code>ossec.conf.template</code></p>"},{"location":"config-templates/agent/ossec-agent/#verwendung","title":"Verwendung","text":"<pre><code># Variablen exportieren\nexport MANAGER_HOST=\"192.168.1.10\"\nexport MANAGER_PORT=\"1514\"\nexport AGENT_PROTOCOL=\"tcp\"\nexport AGENT_GROUP=\"linux-servers\"\nexport SYSCHECK_FREQUENCY=\"43200\"\nexport LOG_FORMAT=\"plain\"\n\n# Template bef\u00fcllen\nenvsubst &lt; docs/config-templates/agent/ossec.conf.template \\\n         &gt; /var/ossec/etc/ossec.conf\n\n# Validieren &amp; neu starten\n/var/ossec/bin/wazuh-control check-config\nsystemctl restart wazuh-agent\n</code></pre>"},{"location":"config-templates/agent/ossec-agent/#registrierung","title":"Registrierung","text":"<pre><code># Agent beim Manager registrieren (einmalig)\n/var/ossec/bin/agent-auth -m {{ MANAGER_HOST }} -A {{ AGENT_NAME }}\n\n# Gruppe zuweisen (auf dem Manager)\n/var/ossec/bin/agent_groups -a -i &lt;AGENT_ID&gt; -g {{ AGENT_GROUP }}\n</code></pre>"},{"location":"config-templates/agent/ossec-agent/#template","title":"Template","text":"<pre><code>&lt;!--\n  ossec.conf \u2013 Wazuh Agent (Linux)\n  Template Version: 1.0\n  Wazuh Version:    {{ WAZUH_VERSION }}\n  Agent-Name:       {{ AGENT_NAME }}\n  Gruppe:           {{ AGENT_GROUP }}\n  Kunde:            {{ CUSTOMER_ID }}\n  Change-Ticket:    {{ CHANGE_TICKET }}\n\n  Variablen: siehe docs/config-templates/VARIABLES.md\n  Bef\u00fcllen:  envsubst &lt; ossec.conf.template &gt; /var/ossec/etc/ossec.conf\n  Validieren: /var/ossec/bin/wazuh-control check-config\n  Registrieren: /var/ossec/bin/agent-auth -m {{ MANAGER_HOST }}\n--&gt;\n&lt;ossec_config&gt;\n\n  &lt;!-- ============================================================\n       CLIENT (VERBINDUNG ZUM MANAGER)\n       ============================================================ --&gt;\n  &lt;client&gt;\n    &lt;server&gt;\n      &lt;address&gt;{{ MANAGER_HOST }}&lt;/address&gt;\n      &lt;port&gt;{{ MANAGER_PORT }}&lt;/port&gt;\n      &lt;protocol&gt;{{ AGENT_PROTOCOL }}&lt;/protocol&gt;\n    &lt;/server&gt;\n    &lt;config-profile&gt;{{ AGENT_GROUP }}&lt;/config-profile&gt;\n    &lt;notify_time&gt;10&lt;/notify_time&gt;\n    &lt;time-reconnect&gt;60&lt;/time-reconnect&gt;\n    &lt;auto_restart&gt;yes&lt;/auto_restart&gt;\n  &lt;/client&gt;\n\n  &lt;!-- ============================================================\n       CLIENT BUFFER\n       ============================================================ --&gt;\n  &lt;client_buffer&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;queue_size&gt;5000&lt;/queue_size&gt;\n    &lt;events_per_second&gt;500&lt;/events_per_second&gt;\n  &lt;/client_buffer&gt;\n\n  &lt;!-- ============================================================\n       FILE INTEGRITY MONITORING (FIM / SYSCHECK)\n       ============================================================ --&gt;\n  &lt;syscheck&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;frequency&gt;{{ SYSCHECK_FREQUENCY }}&lt;/frequency&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;alert_new_files&gt;yes&lt;/alert_new_files&gt;\n    &lt;auto_ignore frequency=\"10\" timeframe=\"3600\"&gt;no&lt;/auto_ignore&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/etc,/usr/bin,/usr/sbin&lt;/directories&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/bin,/sbin,/boot&lt;/directories&gt;\n    &lt;ignore&gt;/etc/mtab&lt;/ignore&gt;\n    &lt;ignore&gt;/etc/hosts.deny&lt;/ignore&gt;\n    &lt;ignore type=\"sregex\"&gt;.log$|.swp$|.tmp$&lt;/ignore&gt;\n  &lt;/syscheck&gt;\n\n  &lt;!-- ============================================================\n       ROOTCHECK\n       ============================================================ --&gt;\n  &lt;rootcheck&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;check_files&gt;yes&lt;/check_files&gt;\n    &lt;check_trojans&gt;yes&lt;/check_trojans&gt;\n    &lt;check_dev&gt;yes&lt;/check_dev&gt;\n    &lt;check_sys&gt;yes&lt;/check_sys&gt;\n    &lt;check_pids&gt;yes&lt;/check_pids&gt;\n    &lt;check_ports&gt;yes&lt;/check_ports&gt;\n    &lt;check_if&gt;yes&lt;/check_if&gt;\n    &lt;frequency&gt;43200&lt;/frequency&gt;\n  &lt;/rootcheck&gt;\n\n  &lt;!-- ============================================================\n       SCA (Security Configuration Assessment)\n       ============================================================ --&gt;\n  &lt;sca&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;interval&gt;12h&lt;/interval&gt;\n    &lt;skip_nfs&gt;yes&lt;/skip_nfs&gt;\n  &lt;/sca&gt;\n\n  &lt;!-- ============================================================\n       LOG-ANALYSE (LOCALFILE)\n       ============================================================ --&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/syslog&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/auth.log&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/kern.log&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/dpkg.log&lt;/location&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- Applikationsspezifisch (ggf. auskommentieren) --&gt;\n  &lt;!--\n  &lt;localfile&gt;\n    &lt;log_format&gt;apache&lt;/log_format&gt;\n    &lt;location&gt;/var/log/nginx/error.log&lt;/location&gt;\n  &lt;/localfile&gt;\n  --&gt;\n\n  &lt;localfile&gt;\n    &lt;log_format&gt;command&lt;/log_format&gt;\n    &lt;command&gt;df -P&lt;/command&gt;\n    &lt;frequency&gt;360&lt;/frequency&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;full_command&lt;/log_format&gt;\n    &lt;command&gt;last -n 20&lt;/command&gt;\n    &lt;frequency&gt;360&lt;/frequency&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- ============================================================\n       ACTIVE RESPONSE\n       ============================================================ --&gt;\n  &lt;active-response&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;ca_store&gt;var/ossec/etc/wpk_root.pem&lt;/ca_store&gt;\n    &lt;ca_verification&gt;yes&lt;/ca_verification&gt;\n  &lt;/active-response&gt;\n\n  &lt;!-- ============================================================\n       LOGGING\n       ============================================================ --&gt;\n  &lt;logging&gt;\n    &lt;log_format&gt;{{ LOG_FORMAT }}&lt;/log_format&gt;\n  &lt;/logging&gt;\n\n&lt;/ossec_config&gt;\n</code></pre>"},{"location":"config-templates/filebeat/filebeat/","title":"filebeat.yml \u2013 Filebeat f\u00fcr Wazuh","text":"<p>Filebeat-Konfiguration zum Weiterleiten von Wazuh-Alerts an den Wazuh Indexer.</p> <p>Variablenreferenz: VARIABLES.md Rohdatei (zum Download): <code>filebeat.yml.template</code></p>"},{"location":"config-templates/filebeat/filebeat/#verwendung","title":"Verwendung","text":"<pre><code># Passwort sicher aus Vault lesen (niemals im Klartext!)\nexport INDEXER_PASSWORD=$(vault kv get -field=password secret/wazuh/indexer)\n\n# Weitere Variablen exportieren\nexport INDEXER_HOST=\"127.0.0.1\"\nexport INDEXER_PORT=\"9200\"\nexport INDEXER_USERNAME=\"admin\"\n\n# Template bef\u00fcllen\nenvsubst &lt; docs/config-templates/filebeat/filebeat.yml.template \\\n         &gt; /etc/filebeat/filebeat.yml\n\n# Konfiguration validieren\nfilebeat test config -e\n\n# Verbindung zum Indexer testen\nfilebeat test output\n\n# Dienst neu starten\nsystemctl restart filebeat\n</code></pre>"},{"location":"config-templates/filebeat/filebeat/#template","title":"Template","text":"<pre><code># filebeat.yml \u2013 Filebeat f\u00fcr Wazuh Dashboard\n# Template Version: 1.0\n# Wazuh Version:    {{ WAZUH_VERSION }}\n# Kunde:            {{ CUSTOMER_ID }}\n# Change-Ticket:    {{ CHANGE_TICKET }}\n\n# ============================================================\n# OUTPUT \u2013 Wazuh Indexer (OpenSearch)\n# ============================================================\noutput.elasticsearch:\n  hosts:\n    - \"https://{{ INDEXER_HOST }}:{{ INDEXER_PORT }}\"\n  protocol: https\n  username: \"{{ INDEXER_USERNAME }}\"\n  # Passwort aus Vault/Umgebungsvariable \u2013 niemals im Klartext!\n  password: \"${INDEXER_PASSWORD}\"\n  ssl.certificate_authorities:\n    - /etc/filebeat/certs/root-ca.pem\n  ssl.certificate: /etc/filebeat/certs/filebeat.pem\n  ssl.key: /etc/filebeat/certs/filebeat-key.pem\n\n# ============================================================\n# SETUP \u2013 Index-Template &amp; Dashboards\n# ============================================================\nsetup.template.json.enabled: true\nsetup.template.json.path: /etc/filebeat/wazuh-template.json\nsetup.template.json.name: wazuh\nsetup.template.overwrite: true\nsetup.ilm.enabled: false\n\n# ============================================================\n# FILEBEAT INPUTS\n# ============================================================\nfilebeat.inputs:\n  - type: log\n    paths:\n      - /var/ossec/logs/alerts/alerts.json\n    fields:\n      file_type: wazuh_alerts\n    json.message_key: full_log\n    json.keys_under_root: true\n    json.add_error_key: true\n    json.overwrite_keys: true\n\n# ============================================================\n# FILEBEAT MODULES\n# ============================================================\nfilebeat.config.modules:\n  path: /etc/filebeat/modules.d/*.yml\n  reload.enabled: false\n\n# ============================================================\n# LOGGING\n# ============================================================\nlogging.level: info\nlogging.to_files: true\nlogging.files:\n  path: /var/log/filebeat\n  name: filebeat\n  keepfiles: 7\n  permissions: 0644\n\n# ============================================================\n# PROZESSOR \u2013 Host-Metadaten hinzuf\u00fcgen\n# ============================================================\nprocessors:\n  - add_host_metadata:\n      when.not.contains.tags: forwarded\n</code></pre>"},{"location":"config-templates/indexer/opensearch/","title":"opensearch.yml \u2013 Wazuh Indexer","text":"<p>OpenSearch-Konfiguration f\u00fcr den Wazuh Indexer.</p> <p>Variablenreferenz: VARIABLES.md Rohdatei (zum Download): <code>opensearch.yml.template</code></p>"},{"location":"config-templates/indexer/opensearch/#verwendung","title":"Verwendung","text":"<pre><code># Variablen exportieren\nexport INDEXER_CLUSTER_NAME=\"wazuh-cluster\"\nexport INDEXER_NODE_NAME=\"wazuh-indexer-01\"\nexport INDEXER_NETWORK_HOST=\"0.0.0.0\"\nexport INDEXER_PORT=\"9200\"\nexport INDEXER_INITIAL_MASTERS=\"wazuh-indexer-01\"\n\n# Template bef\u00fcllen\nenvsubst &lt; docs/config-templates/indexer/opensearch.yml.template \\\n         &gt; /etc/wazuh-indexer/opensearch.yml\n\n# Dienst neu starten\nsystemctl restart wazuh-indexer\n\n# Status pr\u00fcfen\nsystemctl status wazuh-indexer\ncurl -k -u admin:${INDEXER_PASSWORD} https://localhost:9200/_cluster/health\n</code></pre>"},{"location":"config-templates/indexer/opensearch/#template","title":"Template","text":"<pre><code># opensearch.yml \u2013 Wazuh Indexer (OpenSearch)\n# Template Version: 1.0\n# Wazuh Version:    {{ WAZUH_VERSION }}\n# Kunde:            {{ CUSTOMER_ID }}\n# Change-Ticket:    {{ CHANGE_TICKET }}\n\n# ============================================================\n# CLUSTER\n# ============================================================\ncluster.name: {{ INDEXER_CLUSTER_NAME }}\ncluster.initial_cluster_manager_nodes:\n  - \"{{ INDEXER_INITIAL_MASTERS }}\"\n\n# ============================================================\n# NODE\n# ============================================================\nnode.name: {{ INDEXER_NODE_NAME }}\n\n# ============================================================\n# NETWORK\n# ============================================================\nnetwork.host: {{ INDEXER_NETWORK_HOST }}\nhttp.port: {{ INDEXER_PORT }}\n\n# ============================================================\n# PFADE\n# ============================================================\npath.data: /var/lib/wazuh-indexer\npath.logs: /var/log/wazuh-indexer\n\n# ============================================================\n# TLS / SECURITY\n# ============================================================\nplugins.security.ssl.transport.pemcert_filepath: /etc/wazuh-indexer/certs/{{ INDEXER_NODE_NAME }}.pem\nplugins.security.ssl.transport.pemkey_filepath: /etc/wazuh-indexer/certs/{{ INDEXER_NODE_NAME }}-key.pem\nplugins.security.ssl.transport.pemtrustedcas_filepath: /etc/wazuh-indexer/certs/root-ca.pem\nplugins.security.ssl.transport.enforce_hostname_verification: false\n\nplugins.security.ssl.http.enabled: true\nplugins.security.ssl.http.pemcert_filepath: /etc/wazuh-indexer/certs/{{ INDEXER_NODE_NAME }}.pem\nplugins.security.ssl.http.pemkey_filepath: /etc/wazuh-indexer/certs/{{ INDEXER_NODE_NAME }}-key.pem\nplugins.security.ssl.http.pemtrustedcas_filepath: /etc/wazuh-indexer/certs/root-ca.pem\n\nplugins.security.allow_default_init_securityindex: true\nplugins.security.authcz.admin_dn:\n  - \"CN=admin,OU=Wazuh,O=Wazuh,L=California,C=US\"\nplugins.security.nodes_dn:\n  - \"CN={{ INDEXER_NODE_NAME }},OU=Wazuh,O=Wazuh,L=California,C=US\"\n\nplugins.security.restapi.roles_enabled:\n  - \"all_access\"\n  - \"security_rest_api_access\"\n\nplugins.security.system_indices.enabled: true\nplugins.security.system_indices.indices:\n  - \".opendistro-alerting-config\"\n  - \".opendistro-alerting-alert*\"\n  - \".opendistro-anomaly-results*\"\n  - \".opendistro-anomaly-detector*\"\n  - \".opendistro-anomaly-checkpoints\"\n  - \".opendistro-anomaly-detection-state\"\n  - \".opendistro-reports-*\"\n  - \".opendistro-notifications-*\"\n  - \".opendistro-notebooks\"\n  - \".opensearch-observability\"\n  - \".opendistro-asynchronous-search-response*\"\n  - \".replication-metadata-store\"\n\n# ============================================================\n# DISCOVERY\n# ============================================================\ndiscovery.seed_hosts:\n  - \"{{ INDEXER_NETWORK_HOST }}\"\n</code></pre>"},{"location":"config-templates/manager/linux-servers/","title":"Agent Group \u2013 Linux Server","text":"<p>Shared-Konfiguration f\u00fcr die Agentengruppe <code>linux-servers</code>. Wird automatisch an alle Mitglieder der Gruppe verteilt.</p> <p>Rohdatei (zum Download): <code>agent_groups/linux-servers.conf</code></p>"},{"location":"config-templates/manager/linux-servers/#deployment","title":"Deployment","text":"<pre><code># Gruppe anlegen (falls nicht vorhanden)\n/var/ossec/bin/agent_groups -a -g linux-servers\n\n# Konfiguration deployen\ncp docs/config-templates/manager/agent_groups/linux-servers.conf \\\n   /var/ossec/etc/shared/linux-servers/agent.conf\n\n# Agent zur Gruppe hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i &lt;AGENT_ID&gt; -g linux-servers\n\n# Konfiguration neu laden (kein Neustart n\u00f6tig)\n/var/ossec/bin/wazuh-control reload\n</code></pre>"},{"location":"config-templates/manager/linux-servers/#template","title":"Template","text":"<pre><code>&lt;!--\n  agent_groups/linux-servers.conf \u2013 Shared Config f\u00fcr Linux-Server-Gruppe\n  Template Version: 1.0\n  Gruppe:           linux-servers\n\n  Diese Datei wird auf alle Agenten der Gruppe \"linux-servers\" verteilt.\n  Deployment: /var/ossec/etc/shared/linux-servers/agent.conf\n--&gt;\n&lt;agent_config&gt;\n\n  &lt;!-- FIM \u2013 Zus\u00e4tzliche Pfade f\u00fcr Linux-Server --&gt;\n  &lt;syscheck&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/etc/nginx,/etc/apache2&lt;/directories&gt;\n    &lt;directories check_all=\"yes\"&gt;/etc/mysql,/etc/postgresql&lt;/directories&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/etc/ssh&lt;/directories&gt;\n    &lt;directories check_all=\"yes\"&gt;/etc/cron.d,/var/spool/cron&lt;/directories&gt;\n    &lt;ignore&gt;/var/log&lt;/ignore&gt;\n    &lt;ignore&gt;/var/ossec/logs&lt;/ignore&gt;\n  &lt;/syscheck&gt;\n\n  &lt;!-- Systemd-Journal --&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;journald&lt;/log_format&gt;\n    &lt;location&gt;journald&lt;/location&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- SCA \u2013 Linux-Server-Policy --&gt;\n  &lt;sca&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;interval&gt;12h&lt;/interval&gt;\n    &lt;skip_nfs&gt;yes&lt;/skip_nfs&gt;\n    &lt;policies&gt;\n      &lt;policy&gt;etc/shared/sca/cis_ubuntu22-04_server.yml&lt;/policy&gt;\n    &lt;/policies&gt;\n  &lt;/sca&gt;\n\n&lt;/agent_config&gt;\n</code></pre>"},{"location":"config-templates/manager/linux-servers/#hinweise","title":"Hinweise","text":"<ul> <li>Nginx/Apache/MySQL-Logs sind auskommentiert \u2013 nur aktivieren wenn die Dienste tats\u00e4chlich laufen</li> <li>Die CIS-Policy <code>cis_ubuntu22-04_server.yml</code> muss auf dem Manager vorhanden sein</li> </ul>"},{"location":"config-templates/manager/ossec-manager/","title":"ossec.conf \u2013 Wazuh Manager (AIO)","text":"<p>Vollst\u00e4ndige Manager-Konfiguration f\u00fcr eine All-In-One Ubuntu Installation.</p> <p>Variablenreferenz: VARIABLES.md Rohdatei (zum Download): <code>ossec.conf.template</code></p>"},{"location":"config-templates/manager/ossec-manager/#verwendung","title":"Verwendung","text":"<pre><code># Variablen exportieren\nexport $(cat vars.yml | grep -v '#' | xargs)\n\n# Template bef\u00fcllen\nenvsubst &lt; docs/config-templates/manager/ossec.conf.template \\\n         &gt; /var/ossec/etc/ossec.conf\n\n# Konfiguration validieren\n/var/ossec/bin/wazuh-control check-config\n\n# Manager neu starten\nsystemctl restart wazuh-manager\n</code></pre>"},{"location":"config-templates/manager/ossec-manager/#template","title":"Template","text":"<pre><code>&lt;!--\n  ossec.conf \u2013 Wazuh Manager (All-In-One, Ubuntu)\n  Template Version: 1.0\n  Wazuh Version:    {{ WAZUH_VERSION }}\n  Kunde:            {{ CUSTOMER_ID }}\n  Change-Ticket:    {{ CHANGE_TICKET }}\n\n  Variablen: siehe docs/config-templates/VARIABLES.md\n  Bef\u00fcllen:  envsubst &lt; ossec.conf.template &gt; /var/ossec/etc/ossec.conf\n  Validieren: /var/ossec/bin/wazuh-control check-config\n--&gt;\n&lt;ossec_config&gt;\n\n  &lt;!-- ============================================================\n       GLOBALE EINSTELLUNGEN\n       ============================================================ --&gt;\n  &lt;global&gt;\n    &lt;jsonout_output&gt;yes&lt;/jsonout_output&gt;\n    &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\n    &lt;logall&gt;{{ LOG_ALL }}&lt;/logall&gt;\n    &lt;logall_json&gt;no&lt;/logall_json&gt;\n    &lt;email_notification&gt;{{ EMAIL_ENABLED }}&lt;/email_notification&gt;\n    &lt;smtp_server&gt;{{ EMAIL_SMTP_SERVER }}&lt;/smtp_server&gt;\n    &lt;email_from&gt;{{ EMAIL_FROM }}&lt;/email_from&gt;\n    &lt;email_to&gt;{{ EMAIL_TO }}&lt;/email_to&gt;\n    &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\n    &lt;email_alert_level&gt;{{ EMAIL_ALERT_LEVEL }}&lt;/email_alert_level&gt;\n    &lt;email_idsname&gt;Wazuh \u2013 {{ CLUSTER_NODE_NAME }}&lt;/email_idsname&gt;\n  &lt;/global&gt;\n\n  &lt;!-- ============================================================\n       ALERTS\n       ============================================================ --&gt;\n  &lt;alerts&gt;\n    &lt;log_alert_level&gt;3&lt;/log_alert_level&gt;\n    &lt;email_alert_level&gt;{{ EMAIL_ALERT_LEVEL }}&lt;/email_alert_level&gt;\n  &lt;/alerts&gt;\n\n  &lt;!-- ============================================================\n       LOGGING\n       ============================================================ --&gt;\n  &lt;logging&gt;\n    &lt;log_format&gt;{{ LOG_FORMAT }}&lt;/log_format&gt;\n  &lt;/logging&gt;\n\n  &lt;!-- ============================================================\n       REMOTE (AGENT-KOMMUNIKATION)\n       ============================================================ --&gt;\n  &lt;remote&gt;\n    &lt;connection&gt;secure&lt;/connection&gt;\n    &lt;port&gt;{{ MANAGER_PORT }}&lt;/port&gt;\n    &lt;protocol&gt;{{ AGENT_PROTOCOL }}&lt;/protocol&gt;\n    &lt;queue_size&gt;131072&lt;/queue_size&gt;\n  &lt;/remote&gt;\n\n  &lt;!-- ============================================================\n       CLUSTER\n       F\u00fcr AIO (Single-Node): CLUSTER_DISABLED=yes\n       ============================================================ --&gt;\n  &lt;cluster&gt;\n    &lt;name&gt;{{ CLUSTER_NAME }}&lt;/name&gt;\n    &lt;node_name&gt;{{ CLUSTER_NODE_NAME }}&lt;/node_name&gt;\n    &lt;node_type&gt;{{ CLUSTER_NODE_TYPE }}&lt;/node_type&gt;\n    &lt;key&gt;{{ CLUSTER_KEY }}&lt;/key&gt;\n    &lt;port&gt;1516&lt;/port&gt;\n    &lt;bind_addr&gt;{{ CLUSTER_BIND_ADDR }}&lt;/bind_addr&gt;\n    &lt;nodes&gt;\n      &lt;node&gt;{{ CLUSTER_NODES }}&lt;/node&gt;\n    &lt;/nodes&gt;\n    &lt;hidden&gt;no&lt;/hidden&gt;\n    &lt;disabled&gt;{{ CLUSTER_DISABLED }}&lt;/disabled&gt;\n  &lt;/cluster&gt;\n\n  &lt;!-- ============================================================\n       WAZUH-INDEXER (OpenSearch) OUTPUT\n       ============================================================ --&gt;\n  &lt;indexer&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;hosts&gt;\n      &lt;host&gt;https://{{ INDEXER_HOST }}:{{ INDEXER_PORT }}&lt;/host&gt;\n    &lt;/hosts&gt;\n    &lt;ssl&gt;\n      &lt;certificate_authorities&gt;\n        &lt;ca&gt;/etc/filebeat/certs/root-ca.pem&lt;/ca&gt;\n      &lt;/certificate_authorities&gt;\n      &lt;certificate&gt;/etc/filebeat/certs/filebeat.pem&lt;/certificate&gt;\n      &lt;key&gt;/etc/filebeat/certs/filebeat-key.pem&lt;/key&gt;\n    &lt;/ssl&gt;\n  &lt;/indexer&gt;\n\n  &lt;!-- ============================================================\n       SYSLOG OUTPUT (optional)\n       ============================================================ --&gt;\n  &lt;syslog_output&gt;\n    &lt;level&gt;{{ SYSLOG_ALERT_LEVEL }}&lt;/level&gt;\n    &lt;server&gt;{{ SYSLOG_SERVER }}&lt;/server&gt;\n    &lt;port&gt;{{ SYSLOG_PORT }}&lt;/port&gt;\n    &lt;protocol&gt;{{ SYSLOG_PROTOCOL }}&lt;/protocol&gt;\n  &lt;/syslog_output&gt;\n\n  &lt;!-- ============================================================\n       FILE INTEGRITY MONITORING (FIM / SYSCHECK)\n       ============================================================ --&gt;\n  &lt;syscheck&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;frequency&gt;{{ SYSCHECK_FREQUENCY }}&lt;/frequency&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;alert_new_files&gt;yes&lt;/alert_new_files&gt;\n    &lt;auto_ignore frequency=\"10\" timeframe=\"3600\"&gt;no&lt;/auto_ignore&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/etc,/usr/bin,/usr/sbin&lt;/directories&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;/bin,/sbin,/boot&lt;/directories&gt;\n    &lt;directories check_all=\"yes\"&gt;/var/ossec/etc&lt;/directories&gt;\n    &lt;ignore&gt;/etc/mtab&lt;/ignore&gt;\n    &lt;ignore&gt;/etc/hosts.deny&lt;/ignore&gt;\n    &lt;ignore type=\"sregex\"&gt;.log$|.swp$&lt;/ignore&gt;\n    &lt;nodiff&gt;/etc/ssl/private.key&lt;/nodiff&gt;\n  &lt;/syscheck&gt;\n\n  &lt;!-- ============================================================\n       ROOTCHECK\n       ============================================================ --&gt;\n  &lt;rootcheck&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;check_files&gt;yes&lt;/check_files&gt;\n    &lt;check_trojans&gt;yes&lt;/check_trojans&gt;\n    &lt;check_dev&gt;yes&lt;/check_dev&gt;\n    &lt;check_sys&gt;yes&lt;/check_sys&gt;\n    &lt;check_pids&gt;yes&lt;/check_pids&gt;\n    &lt;check_ports&gt;yes&lt;/check_ports&gt;\n    &lt;check_if&gt;yes&lt;/check_if&gt;\n    &lt;frequency&gt;43200&lt;/frequency&gt;\n    &lt;rootkit_files&gt;etc/shared/rootkit_files.txt&lt;/rootkit_files&gt;\n    &lt;rootkit_trojans&gt;etc/shared/rootkit_trojans.txt&lt;/rootkit_trojans&gt;\n  &lt;/rootcheck&gt;\n\n  &lt;!-- ============================================================\n       VULNERABILITY DETECTION\n       ============================================================ --&gt;\n  &lt;vulnerability-detection&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;index-status&gt;yes&lt;/index-status&gt;\n    &lt;feed-update-interval&gt;60m&lt;/feed-update-interval&gt;\n  &lt;/vulnerability-detection&gt;\n\n  &lt;!-- ============================================================\n       SCA (Security Configuration Assessment)\n       ============================================================ --&gt;\n  &lt;sca&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;interval&gt;12h&lt;/interval&gt;\n    &lt;skip_nfs&gt;yes&lt;/skip_nfs&gt;\n  &lt;/sca&gt;\n\n  &lt;!-- ============================================================\n       LOG-ANALYSE (LOCALFILE)\n       ============================================================ --&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/syslog&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/auth.log&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n    &lt;location&gt;/var/log/dpkg.log&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;command&lt;/log_format&gt;\n    &lt;command&gt;df -P&lt;/command&gt;\n    &lt;frequency&gt;360&lt;/frequency&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;full_command&lt;/log_format&gt;\n    &lt;command&gt;last -n 20&lt;/command&gt;\n    &lt;frequency&gt;360&lt;/frequency&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- ============================================================\n       REGELWERK &amp; DECODER\n       ============================================================ --&gt;\n  &lt;ruleset&gt;\n    &lt;decoder_dir&gt;ruleset/decoders&lt;/decoder_dir&gt;\n    &lt;rule_dir&gt;ruleset/rules&lt;/rule_dir&gt;\n    &lt;rule_exclude&gt;0215-policy_rules.xml&lt;/rule_exclude&gt;\n    &lt;list&gt;etc/lists/audit-keys&lt;/list&gt;\n    &lt;list&gt;etc/lists/amazon/aws-eventnames&lt;/list&gt;\n    &lt;list&gt;etc/lists/security-eventchannel&lt;/list&gt;\n    &lt;decoder_dir&gt;etc/decoders&lt;/decoder_dir&gt;\n    &lt;rule_dir&gt;etc/rules&lt;/rule_dir&gt;\n  &lt;/ruleset&gt;\n\n  &lt;!-- ============================================================\n       ACTIVE RESPONSE\n       ============================================================ --&gt;\n  &lt;active-response&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;ca_store&gt;etc/wpk_root.pem&lt;/ca_store&gt;\n    &lt;ca_verification&gt;yes&lt;/ca_verification&gt;\n  &lt;/active-response&gt;\n\n  &lt;!-- ============================================================\n       WAZUH API\n       ============================================================ --&gt;\n  &lt;api&gt;\n    &lt;bind_addr&gt;{{ API_HOST }}&lt;/bind_addr&gt;\n    &lt;port&gt;{{ API_PORT }}&lt;/port&gt;\n    &lt;https&gt;yes&lt;/https&gt;\n    &lt;ssl_protocol&gt;TLSv1.2&lt;/ssl_protocol&gt;\n    &lt;ssl_ciphers&gt;HIGH:!ADH:!EXP:!MD5:!RC4:!3DES:!CAMELLIA:@STRENGTH&lt;/ssl_ciphers&gt;\n    &lt;logs&gt;\n      &lt;level&gt;info&lt;/level&gt;\n    &lt;/logs&gt;\n    &lt;cors&gt;\n      &lt;enabled&gt;no&lt;/enabled&gt;\n    &lt;/cors&gt;\n    &lt;cache&gt;\n      &lt;enabled&gt;yes&lt;/enabled&gt;\n      &lt;time&gt;0.750&lt;/time&gt;\n    &lt;/cache&gt;\n    &lt;access&gt;\n      &lt;max_login_attempts&gt;50&lt;/max_login_attempts&gt;\n      &lt;block_time&gt;300&lt;/block_time&gt;\n      &lt;max_request_per_minute&gt;300&lt;/max_request_per_minute&gt;\n    &lt;/access&gt;\n  &lt;/api&gt;\n\n&lt;/ossec_config&gt;\n</code></pre>"},{"location":"config-templates/manager/windows-endpoints/","title":"Agent Group \u2013 Windows Endpoints","text":"<p>Shared-Konfiguration f\u00fcr die Agentengruppe <code>windows-endpoints</code>. Wird automatisch an alle Mitglieder der Gruppe verteilt.</p> <p>Rohdatei (zum Download): <code>agent_groups/windows-endpoints.conf</code></p>"},{"location":"config-templates/manager/windows-endpoints/#deployment","title":"Deployment","text":"<pre><code># Gruppe anlegen (falls nicht vorhanden)\n/var/ossec/bin/agent_groups -a -g windows-endpoints\n\n# Konfiguration deployen\ncp docs/config-templates/manager/agent_groups/windows-endpoints.conf \\\n   /var/ossec/etc/shared/windows-endpoints/agent.conf\n\n# Agent zur Gruppe hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i &lt;AGENT_ID&gt; -g windows-endpoints\n</code></pre>"},{"location":"config-templates/manager/windows-endpoints/#voraussetzungen-windows-gpo","title":"Voraussetzungen (Windows GPO)","text":"<p>F\u00fcr vollst\u00e4ndiges PowerShell-Logging m\u00fcssen folgende GPO-Einstellungen aktiv sein:</p> GPO-Pfad Einstellung Wert <code>Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows PowerShell</code> Turn on Module Logging Enabled <code>Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows PowerShell</code> Turn on Script Block Logging Enabled <code>Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows PowerShell</code> Turn on PowerShell Transcription Enabled"},{"location":"config-templates/manager/windows-endpoints/#template","title":"Template","text":"<pre><code>&lt;!--\n  agent_groups/windows-endpoints.conf \u2013 Shared Config f\u00fcr Windows-Endpoints\n  Template Version: 1.0\n  Gruppe:           windows-endpoints\n\n  Diese Datei wird auf alle Agenten der Gruppe \"windows-endpoints\" verteilt.\n  Deployment: /var/ossec/etc/shared/windows-endpoints/agent.conf\n--&gt;\n&lt;agent_config&gt;\n\n  &lt;!-- FIM \u2013 Windows-Systempfade --&gt;\n  &lt;syscheck&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;%WINDIR%\\System32\\drivers\\etc&lt;/directories&gt;\n    &lt;directories check_all=\"yes\" realtime=\"yes\"&gt;%WINDIR%\\System32\\WindowsPowerShell&lt;/directories&gt;\n    &lt;directories check_all=\"yes\"&gt;%PROGRAMFILES%&lt;/directories&gt;\n    &lt;directories check_all=\"yes\"&gt;%PROGRAMFILES(X86)%&lt;/directories&gt;\n\n    &lt;!-- Registry-\u00dcberwachung --&gt;\n    &lt;windows_registry&gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run&lt;/windows_registry&gt;\n    &lt;windows_registry&gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce&lt;/windows_registry&gt;\n    &lt;windows_registry&gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services&lt;/windows_registry&gt;\n    &lt;windows_registry arch=\"both\"&gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion&lt;/windows_registry&gt;\n\n    &lt;ignore&gt;%WINDIR%\\System32\\LogFiles&lt;/ignore&gt;\n    &lt;ignore&gt;%WINDIR%\\Temp&lt;/ignore&gt;\n    &lt;ignore&gt;%APPDATA%\\Local\\Temp&lt;/ignore&gt;\n  &lt;/syscheck&gt;\n\n  &lt;!-- Windows Event Logs --&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;Security&lt;/location&gt;\n    &lt;query&gt;Event/System[EventID != 5156 and EventID != 5157 and EventID != 5158]&lt;/query&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;System&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;Application&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;Microsoft-Windows-PowerShell/Operational&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;Microsoft-Windows-Windows Defender/Operational&lt;/location&gt;\n  &lt;/localfile&gt;\n  &lt;localfile&gt;\n    &lt;log_format&gt;eventchannel&lt;/log_format&gt;\n    &lt;location&gt;Microsoft-Windows-TaskScheduler/Operational&lt;/location&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- SCA \u2013 Windows CIS Policy --&gt;\n  &lt;sca&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;interval&gt;12h&lt;/interval&gt;\n    &lt;policies&gt;\n      &lt;policy&gt;etc/shared/sca/cis_win11_enterprise.yml&lt;/policy&gt;\n    &lt;/policies&gt;\n  &lt;/sca&gt;\n\n&lt;/agent_config&gt;\n</code></pre>"},{"location":"config-templates/manager/windows-endpoints/#hinweise","title":"Hinweise","text":"<ul> <li>Event IDs 5156/5157/5158 (Network Connection Filtering) werden gefiltert \u2013 sehr hohes Volumen</li> <li>Windows Defender Events nur relevant wenn kein EDR vorhanden</li> </ul>"},{"location":"guides/","title":"Anleitungen","text":"<p>Schritt-f\u00fcr-Schritt Anleitungen f\u00fcr h\u00e4ufige Aufgaben.</p>"},{"location":"guides/#verfugbare-anleitungen","title":"Verf\u00fcgbare Anleitungen","text":"Anleitung Beschreibung Checklisten-Anleitung Wie man Checklisten korrekt ausf\u00fcllt, abgibt und archiviert Katalog-Verwaltung Kunden und Infrastrukturen im Katalog registrieren und aktualisieren"},{"location":"guides/#workflow-ubersicht","title":"Workflow-\u00dcbersicht","text":"<pre><code>Planung          \u2192 Vorbereitung       \u2192 Durchf\u00fchrung    \u2192 Abschluss\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nTicket er\u00f6ffnen    Runbook lesen        Schritt folgen    Docs abgeben\nKunde im Katalog   Checkliste w\u00e4hlen    Befehle kopieren  Ticket schlie\u00dfen\nFenster abstimmen  Metadaten ausf\u00fcllen  Punkte abhaken    Snapshots anh\u00e4ngen\n                   Pre-Go pr\u00fcfen        Snapshots machen\n</code></pre> <p>Weitere Informationen:</p> <ul> <li>Erste Schritte</li> <li>Schnellreferenz</li> <li>Runbooks</li> <li>Checklists</li> </ul>"},{"location":"guides/catalog-howto/","title":"\ud83c\udfd7\ufe0f Katalog-Verwaltung \u2013 Neue Infrastruktur hinzuf\u00fcgen","text":"<p>Schritt-f\u00fcr-Schritt-Anleitung zum Hinzuf\u00fcgen einer neuen Wazuh-Installation im Katalog.</p>"},{"location":"guides/catalog-howto/#szenario","title":"\ud83d\udccb Szenario","text":"<p>Du hast einen neuen Kunden mit einer neuen Wazuh-Installation bekommen. Du brauchst diese in den Katalog eintragen, damit Operatoren die Daten schnell finden.</p>"},{"location":"guides/catalog-howto/#schritt-1-infrastruktur-daten-sammeln","title":"\ud83c\udfaf SCHRITT 1: Infrastruktur-Daten sammeln","text":"<p>Bevor du etwas eintragst, brauchst du diese Informationen vom Kunden/Systemadmin:</p>"},{"location":"guides/catalog-howto/#kundeninformationen","title":"Kundeninformationen","text":"<pre><code>Kundenname:              ________________\nKundenk\u00fcrzel (f\u00fcr URL):  ________________\nHauptkontakt Email:      ________________\nSicherheitsrichtlinien:  ________________\n</code></pre>"},{"location":"guides/catalog-howto/#wazuh-installation","title":"Wazuh-Installation","text":"<pre><code>Installationstyp:        Ubuntu AIO (APT) / Docker / Sonstiges\nUmgebung:                prod / test / dev\nHaupthost (FQDN):        ________________\nManagement-IP:           ________________\nZeitzone:                ________________\n</code></pre>"},{"location":"guides/catalog-howto/#zugriffs-urls","title":"Zugriffs-URLs","text":"<pre><code>Dashboard:               https://________________\nAPI:                     https://________________:55000\nIndexer:                 https://________________:9200\n</code></pre>"},{"location":"guides/catalog-howto/#netzwerk-ports","title":"Netzwerk &amp; Ports","text":"<pre><code>Agent-Port (TCP):        1514 / Sonstiges\nManager-API (TCP):       55000 / Sonstiges\nDashboard (HTTPS):       5601 / Sonstiges\nIndexer (HTTPS):         9200 / Sonstiges\nOffene Ports:            ________________\n</code></pre>"},{"location":"guides/catalog-howto/#secretscredentials","title":"Secrets/Credentials","text":"<pre><code>\u26a0\ufe0f **NIEMALS direkt eintragen!**\nStattdessen: Wo sind die Secrets gespeichert?\n  - Vault path?           vault://customer/wazuh/...\n  - 1Password vault?\n  - Keepass-Datenbank?\n  - Passwordstate?\n</code></pre>"},{"location":"guides/catalog-howto/#wartungs-richtlinien","title":"Wartungs-Richtlinien","text":"<pre><code>Wartungsfenster:         Mo-Fr 22:00-06:00 / Nur nachts? / Beliebig?\nNotfall-Kontakt (24/7):  ________________\nChange-Approval n\u00f6tig:   ja / nein\n</code></pre>"},{"location":"guides/catalog-howto/#schritt-2-eintrag-erstellen-copy-paste","title":"\u270f\ufe0f SCHRITT 2: Eintrag erstellen (COPY-PASTE)","text":""},{"location":"guides/catalog-howto/#2a-katalog-datei-offnen","title":"2a) Katalog-Datei \u00f6ffnen","text":"<p>Datei: <code>Catalog/CUSTOMERS.md</code></p>"},{"location":"guides/catalog-howto/#2b-ans-ende-der-datei-gehen","title":"2b) Ans Ende der Datei gehen","text":"<p>Scrolle bis zum Ende und finde den letzten Kundeneintrag.</p>"},{"location":"guides/catalog-howto/#2c-template-kopieren","title":"2c) Template kopieren","text":"<p>Suche in der Datei nach <code>---</code> (YAML-Trennzeichen) und kopiere einen kompletten Block:</p> <pre><code>---\ncustomer: \"DeepCloud AG\"\ninfrastructure: \"DeepInfra\"\nenvironment: \"prod\"\nwazuh_type: \"Ubuntu AIO (APT)\"\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"wazuh01.example.tld\"\n    mgmt_ip: \"10.10.10.10\"\nurls:\n  dashboard: \"https://wazuh01.example.tld\"\n  api: \"https://wazuh01.example.tld:55000\"\n  indexer: \"https://wazuh01.example.tld:9200\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nsecrets_ref:\n  admin_user: \"vault://deepcloud/wazuh/admin_user\"\n  admin_password: \"vault://deepcloud/wazuh/admin_password\"\nchange_policy: \"Within business hours (08:00 - 17:00 CET)\"\ncontact_email: \"siem-team@deepcloud.example.tld\"\n---\n</code></pre>"},{"location":"guides/catalog-howto/#2d-template-an-katalog-anhangen","title":"2d) Template an Katalog anh\u00e4ngen","text":"<p>Am Ende der Datei, nach dem letzten Eintrag, f\u00fcge eine neue Leerzeile ein und klebst dein Template:</p> <pre><code>...\ncontact_email: \"siem-team@existingcustomer.example.tld\"\n---\n\n---\ncustomer: \"NEUE AG\"    \u2190 DEIN NEUER EINTRAG\ninfrastructure: \"NeueInfra\"\n...\n---\n</code></pre>"},{"location":"guides/catalog-howto/#schritt-3-felder-ausfullen-mit-beispiel","title":"\ud83d\udd8a\ufe0f SCHRITT 3: Felder ausf\u00fcllen (mit BEISPIEL)","text":"<p>Jedes YAML-Feld m\u00fcssen mit echten Werten gef\u00fcllt werden:</p>"},{"location":"guides/catalog-howto/#beispiel-vorher-template","title":"Beispiel: VORHER (Template)","text":"<pre><code>---\ncustomer: \"DeepCloud AG\"              \u2190 TEMPLATE (noch leer)\ninfrastructure: \"DeepInfra\"\nenvironment: \"prod\"\nwazuh_type: \"Ubuntu AIO (APT)\"\n...\n---\n</code></pre>"},{"location":"guides/catalog-howto/#beispiel-nachher-ausgefullt","title":"Beispiel: NACHHER (ausgef\u00fcllt)","text":"<pre><code>---\ncustomer: \"Acme Corporation\"          \u2190 Echter Kundenname\ninfrastructure: \"Acme-PROD-01\"        \u2190 Infrastruktur-ID\nenvironment: \"prod\"                   \u2190 prod/test/dev\nwazuh_type: \"Ubuntu AIO (APT)\"        \u2190 Installationstyp\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"siem.acme.example.tld\"     \u2190 Hostname (FQDN)\n    mgmt_ip: \"192.168.10.50\"          \u2190 Management-IP\nurls:\n  dashboard: \"https://siem.acme.example.tld\"\n  api: \"https://siem.acme.example.tld:55000\"\n  indexer: \"https://siem.acme.example.tld:9200\"\nports_expected:\n  - \"1514/tcp\"                        \u2190 Agent-Eingehend\n  - \"1515/tcp\"                        \u2190 Agent-Cluster\n  - \"55000/tcp\"                       \u2190 Manager-API\n  - \"5601/tcp\"                        \u2190 Dashboard\n  - \"9200/tcp\"                        \u2190 Indexer/Elasticsearch\nsecrets_ref:\n  admin_user: \"vault://acme/wazuh/admin_user\"      \u2190 KEIN echtes PW!\n  admin_password: \"vault://acme/wazuh/admin_password\"\nchange_policy: \"Within business hours (08:00 - 18:00 CET), max 2h window\"\ncontact_email: \"siem-oncall@acme.example.tld\"\n---\n</code></pre>"},{"location":"guides/catalog-howto/#feld-definitionen","title":"\ud83d\udcdd Feld-Definitionen","text":"Feld Format Beispiel Erkl\u00e4rung <code>customer</code> Text \"Acme Corp\" Kundenname <code>infrastructure</code> Text (no spaces) \"Acme-PROD-01\" Eindeutige ID f\u00fcr diese Installation <code>environment</code> prod/test/dev \"prod\" Umgebungstyp <code>wazuh_type</code> Text \"Ubuntu AIO (APT)\" Installationstyp <code>fqdn</code> FQDN \"siem.acme.tld\" Vollqualifizierter Hostname <code>mgmt_ip</code> IP-Adresse \"192.168.10.50\" Management-IP (f\u00fcr SSH) <code>dashboard</code> HTTPS URL \"https://siem.acme.tld\" Dashboard-Zugriff <code>api</code> HTTPS URL + Port \"https://siem.acme.tld:55000\" Manager-API <code>indexer</code> HTTPS URL + Port \"https://siem.acme.tld:9200\" Elasticsearch/Opensearch <code>ports_expected</code> Liste (TCP/UDP) \"1514/tcp\" Erwartete offene Ports <code>admin_user</code> Vault-Pfad \"vault://acme/wazuh/admin\" NIEMALS echte Passw\u00f6rter! <code>admin_password</code> Vault-Pfad \"vault://acme/wazuh/pass\" NIEMALS echte Passw\u00f6rter! <code>change_policy</code> Text (Gesch\u00e4ftszeiten) \"Mo-Fr 22:00-06:00\" Wann sind \u00c4nderungen erlaubt? <code>contact_email</code> Email \"siem@acme.tld\" Notfall-Kontakt"},{"location":"guides/catalog-howto/#wichtig-secrets","title":"\ud83d\udea8 WICHTIG: SECRETS","text":""},{"location":"guides/catalog-howto/#falsch-niemals","title":"\u274c FALSCH (NIEMALS!)","text":"<pre><code>secrets_ref:\n  admin_password: \"MySecretPassword123!\"\n</code></pre>"},{"location":"guides/catalog-howto/#richtig","title":"\u2705 RICHTIG","text":"<pre><code>secrets_ref:\n  admin_user: \"vault://acme/wazuh/admin_user\"\n  admin_password: \"vault://acme/wazuh/admin_password\"\n</code></pre> <p>Warum? - Die Katalog-Datei ist im Git Repository - Git speichert die komplette Historie (auch gel\u00f6schte Secrets!) - Secrets m\u00fcssen in deinem Secret-Store sein (Vault, 1Password, etc.)</p> <p>Wie benutze ich die Secrets? <pre><code># Passwort abrufen (z.B. mit Vault):\nvault kv get acme/wazuh/admin_password\n# Output: password: MySecretPassword123!\n</code></pre></p>"},{"location":"guides/catalog-howto/#schritt-4-anderung-via-pull-request-einreichen","title":"\ud83d\udce4 SCHRITT 4: \u00c4nderung via Pull Request einreichen","text":"<p>Jetzt musst du die \u00c4nderung ins Repository bekommen. Das geht via Git + Pull Request:</p>"},{"location":"guides/catalog-howto/#4a-feature-branch-erstellen","title":"4a) Feature-Branch erstellen","text":"<pre><code># Terminal-Befehl zum Kopieren:\ngit checkout -b add/customer-acme-corp\n</code></pre>"},{"location":"guides/catalog-howto/#4b-datei-speichern-anderung-committen","title":"4b) Datei speichern &amp; \u00c4nderung committen","text":"<pre><code># Terminal-Befehle zum Kopieren:\ngit add Catalog/CUSTOMERS.md\ngit commit -m \"catalog: Add Acme Corporation infrastructure (Acme-PROD-01)\"\n</code></pre>"},{"location":"guides/catalog-howto/#4c-auf-github-pushen","title":"4c) Auf GitHub pushen","text":"<pre><code># Terminal-Befehl zum Kopieren:\ngit push origin add/customer-acme-corp\n</code></pre>"},{"location":"guides/catalog-howto/#4d-pull-request-erstellen","title":"4d) Pull Request erstellen","text":"<ol> <li>Gehe zu https://github.com/istagmbh/Ta-SIEMPlus</li> <li>Klicke auf \"Pull requests\"</li> <li>Klicke auf \"New Pull Request\"</li> <li>W\u00e4hle:</li> <li>Base: <code>main</code></li> <li>Compare: <code>add/customer-acme-corp</code></li> <li>Title: <code>catalog: Add Acme Corporation</code></li> <li>Description: <pre><code>Adds new customer infrastructure to catalog:\n- Customer: Acme Corporation\n- Infrastructure: Acme-PROD-01\n- Environment: prod\n- Type: Ubuntu AIO (APT)\n- Dashboard: https://siem.acme.example.tld\n\nNo breaking changes. Ready for review.\n</code></pre></li> <li>Klicke \"Create Pull Request\"</li> </ol>"},{"location":"guides/catalog-howto/#4e-warte-auf-review","title":"4e) Warte auf Review","text":"<ul> <li>Mindestens 1 Reviewer muss zustimmen \u2705</li> <li>Reviewer \u00fcberpr\u00fcft: Syntax, Secrets-Referenzen, Vollst\u00e4ndigkeit</li> <li>Nach Approval: Merge (dein Eintrag ist live!)</li> </ul>"},{"location":"guides/catalog-howto/#schritt-5-nach-dem-merge","title":"\u2705 SCHRITT 5: Nach dem Merge","text":""},{"location":"guides/catalog-howto/#5a-feature-branch-loschen-cleanup","title":"5a) Feature-Branch l\u00f6schen (cleanup)","text":"<pre><code># Terminal-Befehl zum Kopieren:\ngit checkout main\ngit pull origin main\ngit branch -d add/customer-acme-corp\n</code></pre>"},{"location":"guides/catalog-howto/#5b-neue-eintrage-verwenden","title":"5b) Neue Eintr\u00e4ge verwenden","text":"<p>Jetzt k\u00f6nnen Operatoren deine Daten verwenden:</p> <pre><code># Zum Beispiel in einer Checkliste:\ncustomer: \"Acme Corporation\"\ninfrastructure: \"Acme-PROD-01\"\n# \u2192 Alle Daten aus Catalog/CUSTOMERS.md werden automatisch verwendet!\n</code></pre>"},{"location":"guides/catalog-howto/#validierung-vor-dem-commit-prufen","title":"\ud83d\udd0d VALIDIERUNG: Vor dem Commit pr\u00fcfen","text":"<p>Bevor du git commit machst, \u00fcberpr\u00fcfe:</p>"},{"location":"guides/catalog-howto/#checkliste","title":"Checkliste:","text":"<ul> <li> Alle Felder ausgef\u00fcllt? (nichts \"UNSET\" lassen)</li> <li> YAML-Syntax korrekt? (keine Tabulatoren, nur Spaces!)</li> <li> Secrets nur als Vault-Pfade? (kein echtes Passwort!)</li> <li> URLs erreichbar? (zumindest Dashboard + API testen)</li> <li> Keine Duplikate? (grep -n \"customer: \\\"Acme\\\"\" Catalog/CUSTOMERS.md)</li> <li> Commit-Message aussagekr\u00e4ftig? (kurz + pr\u00e4zise)</li> </ul>"},{"location":"guides/catalog-howto/#yaml-syntax-testen","title":"YAML-Syntax testen","text":"<p>\u00d6ffne die Datei in einem YAML-Validator: - Online: https://jsoncrack.com/editor - Lokal: <code>python -c \"import yaml; yaml.safe_load(open('Catalog/CUSTOMERS.md'))\"</code></p> <p>Falls Fehler: Fix vor dem Commit!</p>"},{"location":"guides/catalog-howto/#vollstandiges-beispiel","title":"\ud83d\udcda Vollst\u00e4ndiges Beispiel","text":""},{"location":"guides/catalog-howto/#vorher-template","title":"Vorher (Template)","text":"<p>Datei: <code>Catalog/CUSTOMERS.md</code>, Zeile 100+</p> <pre><code>---\ncustomer: \"UNSET\"\ninfrastructure: \"UNSET\"\nenvironment: \"UNSET\"\n...\n---\n</code></pre>"},{"location":"guides/catalog-howto/#nachher-ausgefullt","title":"Nachher (Ausgef\u00fcllt)","text":"<pre><code>---\ncustomer: \"TechVision AG\"\ninfrastructure: \"TechVision-Security-01\"\nenvironment: \"prod\"\nwazuh_type: \"Ubuntu AIO (APT)\"\nhosts:\n  - role: \"wazuh-aio\"\n    fqdn: \"wazuh-prod.techvision.internal\"\n    mgmt_ip: \"10.50.100.5\"\nurls:\n  dashboard: \"https://wazuh-prod.techvision.internal\"\n  api: \"https://wazuh-prod.techvision.internal:55000\"\n  indexer: \"https://wazuh-prod.techvision.internal:9200\"\nports_expected:\n  - \"1514/tcp\"\n  - \"1515/tcp\"\n  - \"55000/tcp\"\n  - \"5601/tcp\"\n  - \"9200/tcp\"\nsecrets_ref:\n  admin_user: \"vault://techvision/wazuh/admin_user\"\n  admin_password: \"vault://techvision/wazuh/admin_password\"\nchange_policy: \"Weekdays 22:00-06:00 CET, no change Fri evening to Sun\"\ncontact_email: \"security-oncall@techvision.internal\"\n---\n</code></pre> <p>Git Commit: <pre><code>git add Catalog/CUSTOMERS.md\ngit commit -m \"catalog: Add TechVision AG infrastructure (prod environment)\"\ngit push origin add/customer-techvision-ag\n</code></pre></p>"},{"location":"guides/catalog-howto/#haufige-fehler","title":"\ud83c\udd98 H\u00e4ufige Fehler","text":"Fehler Symptom Fix YAML-Syntax falsch <code>yaml.scanner.ScannerError</code> \u00dcberpr\u00fcfe Einr\u00fcckung (2 Spaces, keine Tabs) Feld vergessen <code>infrastructure: UNSET</code> bleibt leer Alle Felder ausf\u00fcllen! Secret als Plaintext <code>admin_password: \"MyPassword123\"</code> Nur <code>vault://...</code> Referenzen! Doppelter Eintrag Zwei Kunden mit gleichem Namen \u00dcberpr\u00fcfe mit <code>grep</code> URL falsch <code>http://</code> statt <code>https://</code> HTTPS verwenden! Port in URLs <code>https://siem.tld:5601</code> (falsch) Port nur in indexer/api, nicht dashboard"},{"location":"guides/catalog-howto/#pro-tipps","title":"\ud83d\udca1 Pro-Tipps","text":""},{"location":"guides/catalog-howto/#tip-1-schnell-einen-kunden-finden","title":"Tip 1: Schnell einen Kunden finden","text":"<pre><code>grep -A 5 \"customer: \\\"Acme\" Catalog/CUSTOMERS.md\n</code></pre>"},{"location":"guides/catalog-howto/#tip-2-alle-kunden-auflisten","title":"Tip 2: Alle Kunden auflisten","text":"<pre><code>grep \"^customer:\" Catalog/CUSTOMERS.md | sort\n</code></pre>"},{"location":"guides/catalog-howto/#tip-3-yaml-validieren-schnell","title":"Tip 3: YAML validieren (schnell)","text":"<pre><code>python3 -c \"import yaml; yaml.safe_load(open('Catalog/CUSTOMERS.md'))\"\n# Kein Output = \u2705 OK!\n</code></pre>"},{"location":"guides/catalog-howto/#tip-4-secrets-pfade-uberprufen-sicher","title":"Tip 4: Secrets-Pfade \u00fcberpr\u00fcfen (sicher!)","text":"<pre><code>grep \"secrets_ref:\" -A 3 Catalog/CUSTOMERS.md | grep -v \"vault://\"\n# Keine Ausgabe = \u2705 Alle sicher!\n</code></pre>"},{"location":"guides/catalog-howto/#support","title":"\ud83d\udcde Support","text":"Frage Antwort Wo finde ich Beispiel-Eintr\u00e4ge? In <code>Catalog/CUSTOMERS.md</code> selbst (suche nach <code>---</code>) Wie teste ich YAML? Online: https://jsoncrack.com/editor Wer kann \u00c4nderungen genehmigen? 1 Reviewer (siehe CONTRIBUTING.md) Kann ich URLs als HTTP (nicht HTTPS)? Nein \u2013 immer HTTPS aus Sicherheit Darf ich Ports hinzuf\u00fcgen? Ja, wenn notwendig. Dokumentiere im Kommentar. <p>\u2705 Du bist bereit! Viel Erfolg beim Hinzuf\u00fcgen neuer Infrastrukturen! \ud83d\ude80</p>"},{"location":"guides/checklist-howto/","title":"\ud83d\udccb Checklisten-Ausf\u00fcll-Anleitung (SCHRITT-F\u00dcR-SCHRITT)","text":"<p>Diese Anleitung zeigt dir, wie du eine Checkliste richtig ausf\u00fcllst \u2013 mit echten Beispielen.</p>"},{"location":"guides/checklist-howto/#ziel","title":"\ud83c\udfaf Ziel","text":"<p>Du kopierst eine Checkliste in dein Change-Ticket und f\u00fcllst sie dann w\u00e4hrend der Durchf\u00fchrung aus.</p>"},{"location":"guides/checklist-howto/#schritt-1-metadaten-sammeln","title":"\ud83d\udcdd SCHRITT 1: Metadaten sammeln","text":"<p>Bevor du startest, brauchst du diese Informationen:</p>"},{"location":"guides/checklist-howto/#aus-deinem-change-ticket","title":"Aus deinem Change-Ticket:","text":"<pre><code>\u2714 Change-Ticket-ID:        CHG-2026-00456\n\u2714 Genehmigt am:            2026-01-27 10:00\n\u2714 Wartungsfenster:         2026-01-30 22:00 \u2013 2026-01-31 00:30\n</code></pre>"},{"location":"guides/checklist-howto/#aus-catalogcustomersmd","title":"Aus Catalog/CUSTOMERS.md:","text":"<pre><code>\u2714 Kundenname:              DeepCloud AG\n\u2714 Infrastruktur:           DeepPay\n\u2714 Umgebung:                prod\n\u2714 Dashboard-URL:           https://wazuh-deeppay.example.tld\n\u2714 API-URL:                 https://wazuh-deeppay.example.tld:55000\n</code></pre>"},{"location":"guides/checklist-howto/#von-dir-selbst","title":"Von dir selbst:","text":"<pre><code>\u2714 Dein Name (Operator):    David Dutler / Ivan Stricker\n\u2714 Ist-Version:             4.9.0   (\u2192 `dpkg -l | grep wazuh`)\n\u2714 Ziel-Version:            4.12.0  (\u2192 Wazuh Release Notes)\n</code></pre>"},{"location":"guides/checklist-howto/#von-der-infrastruktur","title":"Von der Infrastruktur:","text":"<pre><code>\u2714 Snapshot-ID:             snap-0987654321fedcba0\n  (oder Backup-Pfad: /backups/wazuh_backup_2026-01-30.tar.gz)\n</code></pre>"},{"location":"guides/checklist-howto/#schritt-2-checkliste-kopieren-ausfullen","title":"\ud83d\udd8a\ufe0f SCHRITT 2: Checkliste kopieren &amp; ausf\u00fcllen","text":""},{"location":"guides/checklist-howto/#2a-checkliste-offnen","title":"2a) Checkliste \u00f6ffnen","text":"<p>Datei: <code>checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md</code> (oder die neue verbesserte Version: <code>checklists/CHECKLIST_WAZUH_UPGRADE_AIO_IMPROVED.md</code>)</p>"},{"location":"guides/checklist-howto/#2b-komplette-datei-kopieren","title":"2b) Komplette Datei kopieren","text":"<ol> <li>\u00d6ffne die Checklisten-Datei</li> <li>Strg+A (oder \u2318+A auf Mac) = Alles markieren</li> <li>Strg+C (oder \u2318+C) = Kopieren</li> </ol>"},{"location":"guides/checklist-howto/#2c-in-change-ticket-einfugen","title":"2c) In Change-Ticket einf\u00fcgen","text":"<ol> <li>\u00d6ffne dein Change-Management-System (Jira, Azure DevOps, etc.)</li> <li>\u00d6ffne dein Change-Ticket: CHG-2026-00456</li> <li>Klicke im Description/Beschreibung Feld</li> <li>Strg+V (oder \u2318+V) = Einf\u00fcgen</li> </ol>"},{"location":"guides/checklist-howto/#schritt-3-metadaten-ausfullen-yaml-block-oben","title":"\ud83d\udccc SCHRITT 3: Metadaten ausf\u00fcllen (YAML Block oben)","text":"<p>Am Anfang der Checkliste steht ein YAML-Block. F\u00fclle ihn jetzt (vor Beginn!) aus:</p>"},{"location":"guides/checklist-howto/#beispiel-vorher-leer","title":"Beispiel: VORHER (leer)","text":"<pre><code>---\nchecklist_id: \"CHG-WAZUH-UPG-AIO\"\noperator: \"UNSET\"\ncustomer: \"UNSET\"\ninfrastructure: \"UNSET\"\nchange_ticket: \"UNSET\"\nmaintenance_window_start: \"UNSET\"\nmaintenance_window_end: \"UNSET\"\ntarget_version: \"UNSET\"\ncurrent_version: \"UNSET\"\nsnapshot_id: \"UNSET\"\n---\n</code></pre>"},{"location":"guides/checklist-howto/#beispiel-nachher-ausgefullt","title":"Beispiel: NACHHER (ausgef\u00fcllt)","text":"<pre><code>---\nchecklist_id: \"CHG-WAZUH-UPG-AIO\"\noperator: \"David Dutler\"\ncustomer: \"DeepCloud AG\"\ninfrastructure: \"DeepPay\"\nchange_ticket: \"CHG-2026-00456\"\nmaintenance_window_start: \"2026-01-30 22:00\"\nmaintenance_window_end: \"2026-01-31 00:30\"\ntarget_version: \"4.12.0\"\ncurrent_version: \"4.9.0\"\nsnapshot_id: \"snap-0987654321fedcba0\"\n---\n</code></pre> <p>\ud83d\udca1 Tipp: Diese Werte kopierst du \u00fcberall, wo <code>{{variable_name}}</code> steht!</p>"},{"location":"guides/checklist-howto/#schritt-4-pre-go-gates-prufen-abschnitt-b","title":"\u2705 SCHRITT 4: Pre-Go Gates pr\u00fcfen (Abschnitt B)","text":""},{"location":"guides/checklist-howto/#was-sind-pre-go-gates","title":"Was sind Pre-Go Gates?","text":"<p>Das sind kritische Bedingungen, die ALLE erf\u00fcllt sein m\u00fcssen:</p> <pre><code>\u26d4 Wenn AUCH NUR EINE Box NICHT \u2713 ist \u2192 UPGRADE VERSCHIEBEN!\n</code></pre>"},{"location":"guides/checklist-howto/#beispiel-pre-go-gates","title":"Beispiel: Pre-Go Gates","text":"<pre><code>## B) Pre-Go (No-Go Gates)\n\n- [x] Change freigegeben (approved)\n       \u2191 Ja, ist genehmigt seit 2026-01-27 10:00\n\n- [ ] Kunde informiert (Downtime/Impact kommuniziert)\n       \u2191 Noch nicht getan \u2192 Kundennotiz schreiben vor Start!\n\n- [ ] Guide gelesen (Breaking Changes / besondere Schritte)\n       \u2191 Todo: Wazuh 4.12.0 Release Notes durchlesen\n\n- [x] System-Ressourcen gepr\u00fcft (Disk &lt; 85%, RAM verf\u00fcgbar)\n       \u2191 Disk 72%, RAM 24 GB frei \u2192 OK\n\n- [ ] Snapshot/Backup erstellt\n       \u2191 Todo: VM-Snapshot erstellen\n</code></pre>"},{"location":"guides/checklist-howto/#checklisten-vor-dem-start","title":"Checklisten vor dem Start","text":"Gate Aktion Haken \u2705 Change approved Im Ticket nachschauen [x] \u23f3 Kunde informiert Email/Call mit Downtime [ ] \ud83d\udcd6 Guide gelesen https://documentation.wazuh.com/...#upgrade [ ] \ud83d\udcbe Backup/Snapshot VM-Snapshot oder <code>tar</code> Backup [ ] \ud83d\udcbe Snapshot-ID dokumentiert snapshot_id Feld oben ausf\u00fcllen [x] \ud83d\udcf8 Health Snapshot (pre) Befehl ausf\u00fchren + speichern [ ] <p>\u26d4 STOPP: Keine H\u00e4kchen? Upgrade NICHT starten!</p>"},{"location":"guides/checklist-howto/#schritt-5-checkliste-wahrend-der-durchfuhrung-abhaken","title":"\ud83d\udd04 SCHRITT 5: Checkliste w\u00e4hrend der Durchf\u00fchrung abhaken","text":"<p>Arbeite jetzt die Checkliste von oben nach unten ab.</p>"},{"location":"guides/checklist-howto/#ablauf-fur-jeden-punkt","title":"Ablauf f\u00fcr jeden Punkt:","text":"<p>Z.B. Punkt C1.1: <code>[ ] Stop filebeat</code></p> <ol> <li>Lies die Checkliste-Box: \"Stop filebeat\"</li> <li>\u00d6ffne das Runbook parallel: <code>runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md</code></li> <li>Suche die entsprechende Sektion im Runbook (z.B. \"Step 2: Stop Services\")</li> <li>Kopiere den Befehl (grau hinterlegt):    <pre><code>systemctl stop filebeat\n</code></pre></li> <li>F\u00fchre ihn auf dem Server aus: <pre><code>$ systemctl stop filebeat\n$ systemctl status filebeat\n# Output: inactive (dead) \u2190 OK!\n</code></pre></li> <li>Hake die Box in der Checkliste ab: <pre><code>- [x] Stop filebeat        \u2190 \u00c4ndere [ ] zu [x]\n</code></pre></li> </ol>"},{"location":"guides/checklist-howto/#schritt-6-health-snapshots-dokumentieren","title":"\ud83d\udcf8 SCHRITT 6: Health Snapshots dokumentieren","text":""},{"location":"guides/checklist-howto/#pre-snapshot-vorher-vor-upgrade-starten","title":"Pre-Snapshot (VORHER \u2013 vor Upgrade starten)","text":"<p>Im Runbook, Abschnitt \"Health Snapshot (Pre-Change)\", gibt es einen kompletten Befehl:</p> <pre><code># Kopiere diesen Befehl &amp; f\u00fchre ihn aus:\ndate -Is\necho \"=== DISK ===\"\ndf -h | grep -v tmpfs\necho \"=== SERVICES ===\"\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\necho \"=== VERSIONS ===\"\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\n</code></pre> <p>Speichere die komplette Ausgabe: <pre><code>2026-01-30T22:01:00+01:00\n=== DISK ===\nFilesystem     Size  Used Avail Use% Mounted on\n/dev/sda1      100G  62G  35G  65% /\n=== SERVICES ===\n...\n(alle Ausgaben speichern)\n</code></pre></p> <p>Poste diese Ausgabe im Change-Ticket (z.B. in einem Kommentar oder als Attachment).</p>"},{"location":"guides/checklist-howto/#post-snapshot-nachher-nach-upgrade-fertig","title":"Post-Snapshot (NACHHER \u2013 nach Upgrade fertig)","text":"<p>Nach allen Steps: 1. F\u00fchre denselben Befehl nochmal aus 2. Speichere die neue Ausgabe 3. Vergleiche PRE vs POST:    - Versionen aktualisiert? \u2705    - Alle Services laufen? \u2705    - Disk OK? \u2705</p> <p>In der Checkliste dokumentieren: <pre><code>### D) Post-Checks (Acceptance Criteria)\n\n- [x] Pre-Snapshot durchgef\u00fchrt und im Ticket dokumentiert\n      \u2192 https://link-to-ticket/comment/12345\n\n- [x] Post-Snapshot durchgef\u00fchrt und im Ticket dokumentiert\n      \u2192 https://link-to-ticket/comment/12346\n\n- [x] Versionen korrekt: 4.12.0 auf allen Komponenten\n      wazuh-indexer: 4.12.0\n      wazuh-manager: 4.12.0\n      wazuh-dashboard: 4.12.0\n      filebeat: 4.12.0\n\n- [x] Alle Services running\n      wazuh-indexer: active (running)\n      wazuh-manager: active (running)\n      wazuh-dashboard: active (running)\n      filebeat: active (running)\n\n- [x] Dashboard erreichbar (Login OK)\n</code></pre></p>"},{"location":"guides/checklist-howto/#schritt-7-bei-problemen-troubleshooting","title":"\ud83d\udea8 SCHRITT 7: Bei Problemen \u2013 Troubleshooting","text":""},{"location":"guides/checklist-howto/#problem-service-startet-nicht","title":"Problem: Service startet nicht","text":"<p>Was tun:</p> <ol> <li>\u00d6ffne das Runbook, Abschnitt \"Troubleshooting\" (meist Abschnitt 11)</li> <li>F\u00fchre die dort gelisteten Diagnose-Befehle aus:    <pre><code>journalctl -u wazuh-manager -n 50 --no-pager -p err\n</code></pre></li> <li>Poste die Fehlerausgabe im Change-Ticket</li> <li>W\u00e4hle eine L\u00f6sung aus dem Runbook</li> </ol>"},{"location":"guides/checklist-howto/#problem-upgrade-schiefgelaufen-rollback-notig","title":"Problem: Upgrade schiefgelaufen \u2013 Rollback n\u00f6tig","text":"<p>Was tun:</p> <ol> <li>Gehe zu Abschnitt E: Rollback (If Needed) in der Checkliste</li> <li>W\u00e4hle die Rollback-Methode:</li> <li>Option 1: VM-Snapshot zur\u00fcckfahren (schnellste Methode)</li> <li>Option 2: Downgrade von Packages</li> <li>Option 3: Configuration-Restore</li> <li>Dokumentiere im Ticket:    <pre><code>## Rollback durchgef\u00fchrt\n\n**Grund:** wazuh-manager startet nicht nach Upgrade (Java OOM Error)\n**Methode:** VM-Snapshot restore (snap-...)\n**Zeitpunkt:** 2026-01-30 23:45\n**Ergebnis:** \u2705 Erfolgreich, System wiederhergestellt\n</code></pre></li> <li>Erstelle ein Incident-Ticket f\u00fcr Root-Cause-Analysis</li> </ol>"},{"location":"guides/checklist-howto/#schritt-8-checkliste-abschlieen","title":"\ud83d\udcbe SCHRITT 8: Checkliste abschlie\u00dfen","text":"<p>Am Ende der Checkliste:</p> <pre><code>## Sign-Off &amp; Documentation\n\n### Approval\n- [x] Executed by (Operator): David Dutler\n- [x] Approved by (Reviewer): Ivan Stricker, 2026-01-31 01:00\n- [x] Customer Notified: YES (Email sent 2026-01-31 01:15)\n\n### Final Checklist\n- [x] Change ticket CLOSED (status: Completed)\n- [x] Pre- and post-health snapshots ATTACHED\n- [x] All deviations DOCUMENTED\n- [x] Customer sign-off OBTAINED\n- [x] Runbook feedback PROVIDED\n</code></pre>"},{"location":"guides/checklist-howto/#finale-schritte","title":"Finale Schritte:","text":"<ol> <li>Kopiere die Abschluss-Notiz in eine neue Datei: <code>templates/CHANGE_NOTE_TEMPLATE.md</code></li> <li>Unterschreibe digital (Reviewer-Name + Datum)</li> <li>Schlie\u00dfe das Change-Ticket im Change-Management-System</li> <li>Informiere den Kunden \u2192 Email mit \"Upgrade erfolgreich abgeschlossen\"</li> </ol>"},{"location":"guides/checklist-howto/#zusammenfassung-quick-checklist","title":"\ud83c\udfaf Zusammenfassung (Quick Checklist)","text":"<pre><code>CHECKLISTEN-WORKFLOW:\n\n1\ufe0f\u20e3  Metadaten sammeln (Customer, Versions, Ticket, Snapshot)\n2\ufe0f\u20e3  Checklisten-Datei kopieren \u2192 in Change-Ticket einf\u00fcgen\n3\ufe0f\u20e3  YAML-Block ausf\u00fcllen (operator, customer, etc.)\n4\ufe0f\u20e3  Pre-Go Gates pr\u00fcfen (alle \u2705 sein!)\n5\ufe0f\u20e3  Health Snapshot (pre) ausf\u00fchren \u2192 im Ticket speichern\n6\ufe0f\u20e3  Schritte von oben nach unten abarbeiten\n    - Checklisten-Box lesen\n    - Ins Runbook gucken\n    - Befehl kopieren &amp; ausf\u00fchren\n    - Box abhaken [x]\n7\ufe0f\u20e3  Health Snapshot (post) ausf\u00fchren \u2192 mit pre vergleichen\n8\ufe0f\u20e3  Abschlussnote schreiben\n9\ufe0f\u20e3  Reviewer unterschreibt\n\ud83d\udd1f Ticket schlie\u00dfen + Kunde informieren\n</code></pre>"},{"location":"guides/checklist-howto/#haufige-fehler-vermeiden","title":"\ud83d\udca1 H\u00e4ufige Fehler (vermeiden!)","text":"Fehler Problem L\u00f6sung \u274c Metadaten leer lassen Nicht nachverfolgbar ALLE Felder ausf\u00fcllen! \u274c Pre-Go Gates ignorieren Datenverlust m\u00f6glich IMMER alle Checks pr\u00fcfen \u274c Snapshot nicht erstellen Kein Rollback m\u00f6glich Zuerst Backup/Snapshot \u274c Health Snapshots nicht speichern Audit-Trail fehlt Im Ticket dokumentieren \u274c Runbook nicht konsultieren Falsche Reihenfolge Befehle aus Runbook kopieren \u274c Au\u00dferhalb Fenster durchf\u00fchren Unerlaubte \u00c4nderung Nur im Wartungsfenster"},{"location":"guides/checklist-howto/#weitere-hilfe","title":"\ud83d\udcde Weitere Hilfe","text":"Frage Antwort Welche Checkliste f\u00fcr was? Siehe <code>README.md</code> \u2013 Tabelle \"Welche Datei f\u00fcr welchen Zweck?\" Wo finde ich die Befehle? <code>runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md</code> Ich verstehe nicht, was ein Befehl macht? Lese die Dokumentation im Runbook oder die Wazuh Docs Darf ich die Reihenfolge \u00e4ndern? NEIN! Die Runbooks sind f\u00fcr sichere Reihenfolge getestet Was wenn ich die Checkliste vergesse? Das ist OK \u2013 kopiere sie sp\u00e4ter, aber Audit-Trail wird l\u00fcckenhaft <p>\u2705 Du bist bereit! Los geht's mit deinem ersten Upgrade! \ud83d\ude80</p>"},{"location":"overview/","title":"Overview","text":""},{"location":"overview/#what-is-ta-siemplus","title":"What is Ta-SIEMPlus?","text":"<p>Ta-SIEMPlus is an operational documentation system for standardized Wazuh SIEM maintenance workflows. It provides runbooks, checklists, and operational catalogs designed for reliability and auditability.</p>"},{"location":"overview/#goals","title":"\ud83c\udfaf Goals","text":"<ul> <li>Reproducibility: Every procedure is documented step-by-step</li> <li>Auditability: Complete documentation trail for compliance</li> <li>Safety: Built-in gates prevent dangerous operations</li> <li>Efficiency: Structured workflows reduce errors</li> </ul>"},{"location":"overview/#architecture-principles","title":"\ud83c\udfd7\ufe0f Architecture Principles","text":""},{"location":"overview/#1-workflow-synchronization","title":"1. Workflow Synchronization","text":"<p>Checklists and runbooks are tightly coupled: - Checklists reference runbooks for detailed commands - Checklists contain only checkbox items and brief descriptions - Runbooks contain complete commands, validation logic, and troubleshooting - If you modify a runbook section, update its corresponding checklist and vice versa</p>"},{"location":"overview/#2-no-go-gates-mandatory-safety-boundaries","title":"2. No-Go Gates (Mandatory Safety Boundaries)","text":"<p>Every procedure has non-negotiable pre-flight checks: - Disk usage &gt; 90% = STOP - All services must be <code>active (running)</code> before upgrade - Snapshot/backup must exist and be verified - Change ticket must be approved - Must be within maintenance window</p>"},{"location":"overview/#3-health-snapshots-audit-trail","title":"3. Health Snapshots (Audit Trail)","text":"<p>Every procedure must capture system state before and after: - Pre-change snapshot: baseline of versions, disk, services, cluster health - Post-change snapshot: verify nothing regressed - Both snapshots must be attached to the change ticket</p>"},{"location":"overview/#4-metadata-driven-execution","title":"4. Metadata-Driven Execution","text":"<p>All checklists require structured metadata headers: <pre><code>operator: John Doe\ncustomer: Example Corp\ninfrastructure: wazuh-prod-01\nchange_ticket: CHG0012345\nmaintenance_window_start: 2026-03-01T02:00:00+01:00\nmaintenance_window_end: 2026-03-01T06:00:00+01:00\ntarget_version: 4.12.0\nsnapshot_id: snap-2026-03-01-01-30\nrunbook_ref: RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU.md\n</code></pre></p>"},{"location":"overview/#standard-workflow","title":"\ud83d\udcca Standard Workflow","text":"<pre><code>1\ufe0f\u20e3 PLANNING\n   \u251c\u2500 Create change ticket\n   \u251c\u2500 Get customer data from catalog\n   \u2514\u2500 Schedule maintenance window\n\n2\ufe0f\u20e3 PREPARATION  \n   \u251c\u2500 Fill out checklist metadata\n   \u251c\u2500 Review runbook procedure\n   \u2514\u2500 Check pre-go gates\n\n3\ufe0f\u20e3 EXECUTION\n   \u251c\u2500 Follow runbook steps\n   \u251c\u2500 Check off each item\n   \u2514\u2500 Document health snapshots\n\n4\ufe0f\u20e3 VALIDATION &amp; DOCUMENTATION\n   \u251c\u2500 Run post-go checks\n   \u251c\u2500 Document findings\n   \u2514\u2500 Notify customer\n\n5\ufe0f\u20e3 CLOSURE\n   \u251c\u2500 Close change ticket\n   \u251c\u2500 Attach snapshots\n   \u2514\u2500 Provide feedback\n</code></pre>"},{"location":"overview/#operating-on-wazuh-aio-systems","title":"\ud83d\udd27 Operating on Wazuh AIO Systems","text":""},{"location":"overview/#component-upgrade-order","title":"Component Upgrade Order","text":"<p>Components must upgrade in lockstep: 1. wazuh-indexer 2. wazuh-manager 3. wazuh-dashboard 4. filebeat</p>"},{"location":"overview/#version-compatibility","title":"Version Compatibility","text":"<ul> <li>Manager version \u2265 Agent version (always)</li> <li>All central components should be same version</li> </ul>"},{"location":"overview/#critical-ports","title":"Critical Ports","text":"<ul> <li>1514: Agent communication (UDP)</li> <li>1515: Agent enrollment (TCP)</li> <li>55000: Wazuh API</li> <li>9200: Wazuh Indexer</li> <li>5601: Wazuh Dashboard</li> </ul>"},{"location":"overview/#getting-started","title":"\ud83d\ude80 Getting Started","text":"<p>New to Ta-SIEMPlus? Follow these steps:</p> <ol> <li>Understand the structure: Browse Runbooks and Checklists</li> <li>Review a sample upgrade: See Upgrade Guides</li> <li>Practice with the workflow: Follow a runbook in a test environment</li> <li>Contribute improvements: See the contributing guidelines</li> </ol>"},{"location":"overview/#next-steps","title":"\ud83d\udcda Next Steps","text":"<ul> <li>View Available Runbooks</li> <li>Browse Checklists</li> <li>Check Upgrade Guides</li> <li>Quick Reference Commands</li> </ul>"},{"location":"reference/","title":"Reference","text":"<p>Quick reference guides, command lookups, and technical documentation for Wazuh SIEM operations.</p>"},{"location":"reference/#quick-references","title":"\ud83d\udcda Quick References","text":""},{"location":"reference/#common-commands","title":"Common Commands","text":""},{"location":"reference/#service-management","title":"Service Management","text":"<pre><code># Check status of all Wazuh services\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Restart services (in correct order)\nsystemctl restart wazuh-indexer\nsystemctl restart wazuh-manager\nsystemctl restart wazuh-dashboard\nsystemctl restart filebeat\n\n# Stop all services\nsystemctl stop wazuh-dashboard filebeat wazuh-manager wazuh-indexer\n\n# Start all services (in correct order)\nsystemctl start wazuh-indexer\nsystemctl start wazuh-manager\nsystemctl start wazuh-dashboard\nsystemctl start filebeat\n</code></pre>"},{"location":"reference/#version-checks","title":"Version Checks","text":"<pre><code># Check all component versions\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\n\n# Manager version\n/var/ossec/bin/wazuh-control info | grep VERSION\n\n# Indexer version\ncurl -sk -u admin:admin https://127.0.0.1:9200/ | grep number\n\n# API version\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/ | jq .data\n</code></pre>"},{"location":"reference/#health-checks","title":"Health Checks","text":"<pre><code># Cluster health\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n\n# Manager status\n/var/ossec/bin/wazuh-control status\n\n# Agent list\n/var/ossec/bin/agent_control -l\n\n# API connectivity\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/\n</code></pre>"},{"location":"reference/#log-analysis","title":"Log Analysis","text":"<pre><code># Check manager logs\ntail -f /var/ossec/logs/ossec.log\n\n# Check indexer logs\njournalctl -u wazuh-indexer -f\n\n# Check dashboard logs\njournalctl -u wazuh-dashboard -f\n\n# Check for errors (last 50 lines)\njournalctl -u wazuh-manager -n 50 --no-pager -p err\njournalctl -u wazuh-indexer -n 50 --no-pager -p err\n</code></pre>"},{"location":"reference/#disk-usage","title":"Disk Usage","text":"<pre><code># Overall disk usage\ndf -h\n\n# Wazuh data directories\ndu -sh /var/ossec/*\ndu -sh /var/lib/wazuh-indexer/*\n\n# Find large files\nfind /var/ossec -type f -size +100M -exec ls -lh {} \\;\n</code></pre>"},{"location":"reference/#agent-management","title":"Agent Management","text":"<pre><code># List all agents\n/var/ossec/bin/agent_control -l\n\n# List active agents\n/var/ossec/bin/agent_control -lc\n\n# List disconnected agents\n/var/ossec/bin/agent_control -l | grep -i \"never connected\\|disconnected\"\n\n# Get agent information\n/var/ossec/bin/agent_control -i &lt;agent_id&gt;\n\n# Restart agent remotely\n/var/ossec/bin/agent_control -R -a\n\n# Remove agent\n/var/ossec/bin/manage_agents -r &lt;agent_id&gt;\n</code></pre>"},{"location":"reference/#configuration-files","title":"Configuration Files","text":"<pre><code># Manager configuration\n/var/ossec/etc/ossec.conf\n\n# Indexer configuration\n/etc/wazuh-indexer/opensearch.yml\n\n# Dashboard configuration\n/etc/wazuh-dashboard/opensearch_dashboards.yml\n\n# Filebeat configuration\n/etc/filebeat/filebeat.yml\n\n# Agent groups\n/var/ossec/etc/shared/\n</code></pre>"},{"location":"reference/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":""},{"location":"reference/#common-issues","title":"Common Issues","text":""},{"location":"reference/#service-wont-start","title":"Service Won't Start","text":"<pre><code># Check service status\nsystemctl status wazuh-manager\n\n# Check journal logs\njournalctl -u wazuh-manager -n 100 --no-pager\n\n# Check configuration syntax\n/var/ossec/bin/wazuh-control check\n\n# Verify ports are available\nnetstat -tlnp | grep -E '1514|1515|55000|9200|5601'\n</code></pre>"},{"location":"reference/#agents-not-connecting","title":"Agents Not Connecting","text":"<pre><code># Check manager connectivity\ntelnet &lt;manager-ip&gt; 1514\n\n# Check agent status\n/var/ossec/bin/agent_control -l\n\n# Review agent logs\ntail -f /var/ossec/logs/ossec.log\n\n# Check firewall rules\niptables -L -n | grep -E '1514|1515'\n</code></pre>"},{"location":"reference/#high-disk-usage","title":"High Disk Usage","text":"<pre><code># Check indexer disk usage\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/allocation?v\n\n# Clean old indices\ncurl -sk -u admin:admin -X DELETE https://127.0.0.1:9200/wazuh-alerts-4.x-2025.01.*\n\n# Check log rotation\nls -lh /var/ossec/logs/archives/\n</code></pre>"},{"location":"reference/#dashboard-not-accessible","title":"Dashboard Not Accessible","text":"<pre><code># Check dashboard service\nsystemctl status wazuh-dashboard\n\n# Check port binding\nnetstat -tlnp | grep 5601\n\n# Review dashboard logs\njournalctl -u wazuh-dashboard -n 100 --no-pager\n\n# Test indexer connectivity from dashboard\ncurl -sk -u admin:admin https://127.0.0.1:9200/\n</code></pre>"},{"location":"reference/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"reference/#key-metrics-to-monitor","title":"Key Metrics to Monitor","text":"<pre><code># CPU and Memory usage\ntop -b -n 1 | grep -E \"wazuh|java|node\"\n\n# Service uptime\nsystemctl status wazuh-manager | grep Active\n\n# Agent count\n/var/ossec/bin/agent_control -l | wc -l\n\n# Event rate\ntail -n 1000 /var/ossec/logs/ossec.log | grep -c \"INFO:\"\n\n# Index size\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/indices?v\n</code></pre>"},{"location":"reference/#performance-tuning","title":"Performance Tuning","text":"<pre><code># Check Java heap size (Indexer)\ncat /etc/wazuh-indexer/jvm.options | grep \"^-Xm\"\n\n# Indexer thread pool\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/thread_pool?v\n\n# Manager process limits\ngrep ossec /etc/security/limits.conf\n</code></pre>"},{"location":"reference/#security","title":"\ud83d\udd10 Security","text":""},{"location":"reference/#user-management","title":"User Management","text":"<pre><code># List API users\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/security/users\n\n# Create API user\ncurl -k -u &lt;admin&gt;:&lt;password&gt; -X POST \\\n  https://localhost:55000/security/users \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"newuser\",\"password\":\"newpass\"}'\n</code></pre>"},{"location":"reference/#certificate-management","title":"Certificate Management","text":"<pre><code># Check indexer certificates\nopenssl x509 -in /etc/wazuh-indexer/certs/node.pem -text -noout\n\n# Check dashboard certificates\nopenssl x509 -in /etc/wazuh-dashboard/certs/dashboard.pem -text -noout\n\n# Certificate expiry\nopenssl x509 -in /etc/wazuh-indexer/certs/node.pem -noout -dates\n</code></pre>"},{"location":"reference/#configuration-examples","title":"\ud83d\udcd6 Configuration Examples","text":""},{"location":"reference/#custom-rules","title":"Custom Rules","text":"<p>Location: <code>/var/ossec/etc/rules/local_rules.xml</code></p> <pre><code>&lt;group name=\"custom,\"&gt;\n  &lt;rule id=\"100010\" level=\"5\"&gt;\n    &lt;if_sid&gt;5716&lt;/if_sid&gt;\n    &lt;srcip&gt;10.0.0.0/8&lt;/srcip&gt;\n    &lt;description&gt;SSH login from internal network&lt;/description&gt;\n  &lt;/rule&gt;\n&lt;/group&gt;\n</code></pre>"},{"location":"reference/#custom-decoders","title":"Custom Decoders","text":"<p>Location: <code>/var/ossec/etc/decoders/local_decoder.xml</code></p> <pre><code>&lt;decoder name=\"custom-app\"&gt;\n  &lt;program_name&gt;myapp&lt;/program_name&gt;\n&lt;/decoder&gt;\n\n&lt;decoder name=\"custom-app\"&gt;\n  &lt;parent&gt;custom-app&lt;/parent&gt;\n  &lt;regex&gt;^(\\S+) - (\\S+)&lt;/regex&gt;\n  &lt;order&gt;user, action&lt;/order&gt;\n&lt;/decoder&gt;\n</code></pre>"},{"location":"reference/#api-reference","title":"\ud83c\udf10 API Reference","text":""},{"location":"reference/#common-api-calls","title":"Common API Calls","text":"<pre><code># Get cluster status\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/cluster/status\n\n# List agents\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/agents\n\n# Get agent details\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/agents/001\n\n# Restart agent\ncurl -k -u &lt;user&gt;:&lt;password&gt; -X PUT https://localhost:55000/agents/001/restart\n\n# Get manager info\ncurl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/manager/info\n</code></pre>"},{"location":"reference/#important-paths","title":"\ud83d\udcc1 Important Paths","text":"<pre><code>/var/ossec/                     # Main Wazuh directory\n\u251c\u2500\u2500 bin/                        # Executables\n\u251c\u2500\u2500 etc/                        # Configuration files\n\u2502   \u251c\u2500\u2500 ossec.conf             # Main config\n\u2502   \u251c\u2500\u2500 shared/                # Agent group configs\n\u2502   \u2514\u2500\u2500 rules/                 # Detection rules\n\u251c\u2500\u2500 logs/                       # Log files\n\u2502   \u251c\u2500\u2500 ossec.log              # Main log\n\u2502   \u251c\u2500\u2500 alerts/                # Alert logs\n\u2502   \u2514\u2500\u2500 archives/              # Event archives\n\u251c\u2500\u2500 queue/                      # Processing queues\n\u2514\u2500\u2500 var/                        # Runtime data\n\n/var/lib/wazuh-indexer/         # Indexer data\n/etc/wazuh-indexer/             # Indexer config\n/etc/wazuh-dashboard/           # Dashboard config\n/etc/filebeat/                  # Filebeat config\n</code></pre>"},{"location":"reference/#external-resources","title":"\ud83d\udd17 External Resources","text":"<ul> <li>Official Wazuh Documentation</li> <li>Wazuh API Reference</li> <li>Wazuh GitHub</li> <li>Community Forum</li> </ul>"},{"location":"reference/#additional-guides","title":"\ud83d\udcdd Additional Guides","text":"<p>For detailed procedures, see: - Runbooks - Checklists - Upgrade Guides</p>"},{"location":"reference/deployment/","title":"Deployment Guide - MkDocs Documentation","text":"<p>This guide explains how to deploy and manage the Ta-SIEMPlus documentation site.</p>"},{"location":"reference/deployment/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"reference/deployment/#local-development","title":"Local Development","text":"<ol> <li> <p>Install dependencies: <pre><code>pip install mkdocs mkdocs-material mike pymdown-extensions\n</code></pre></p> </li> <li> <p>Serve locally: <pre><code>mkdocs serve\n</code></pre>    Site will be available at http://localhost:8000</p> </li> <li> <p>Build static site: <pre><code>mkdocs build\n</code></pre>    Output will be in <code>site/</code> directory</p> </li> </ol>"},{"location":"reference/deployment/#docker-deployment","title":"Docker Deployment","text":""},{"location":"reference/deployment/#using-docker-compose-recommended","title":"Using Docker Compose (Recommended)","text":"<ol> <li> <p>Build and start: <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>Access the site:</p> </li> <li>URL: http://localhost:8080</li> <li> <p>Health check: http://localhost:8080/health</p> </li> <li> <p>View logs: <pre><code>docker-compose logs -f docs\n</code></pre></p> </li> <li> <p>Stop: <pre><code>docker-compose down\n</code></pre></p> </li> </ol>"},{"location":"reference/deployment/#using-docker-directly","title":"Using Docker directly","text":"<ol> <li> <p>Build image: <pre><code>docker build -f Dockerfile.mkdocs -t ta-siemplus-docs:latest .\n</code></pre></p> </li> <li> <p>Run container: <pre><code>docker run -d -p 8080:80 --name ta-siemplus-docs ta-siemplus-docs:latest\n</code></pre></p> </li> <li> <p>Stop and remove: <pre><code>docker stop ta-siemplus-docs\ndocker rm ta-siemplus-docs\n</code></pre></p> </li> </ol>"},{"location":"reference/deployment/#versioning-with-mike","title":"\ud83d\udcda Versioning with Mike","text":"<p>Mike is used to manage documentation versions for different Wazuh releases.</p>"},{"location":"reference/deployment/#deploy-a-version","title":"Deploy a Version","text":"<pre><code># Deploy version 4.12 and set as latest\nmike deploy 4.12 latest --update-aliases\n\n# Deploy version 4.11\nmike deploy 4.11\n\n# Deploy and push to gh-pages branch (for GitHub Pages)\nmike deploy 4.12 latest --push --update-aliases\n</code></pre>"},{"location":"reference/deployment/#set-default-version","title":"Set Default Version","text":"<pre><code>mike set-default latest\n</code></pre>"},{"location":"reference/deployment/#list-versions","title":"List Versions","text":"<pre><code>mike list\n</code></pre>"},{"location":"reference/deployment/#delete-a-version","title":"Delete a Version","text":"<pre><code>mike delete 4.11\n</code></pre>"},{"location":"reference/deployment/#serve-versioned-docs-locally","title":"Serve Versioned Docs Locally","text":"<pre><code>mike serve\n</code></pre>"},{"location":"reference/deployment/#configuration","title":"\ud83d\udd27 Configuration","text":""},{"location":"reference/deployment/#site-settings","title":"Site Settings","text":"<p>Edit <code>mkdocs.yml</code> to configure: - Site name and description - Theme settings (colors, fonts, features) - Navigation structure - Plugins and extensions</p>"},{"location":"reference/deployment/#navigation","title":"Navigation","text":"<p>The navigation is defined in <code>mkdocs.yml</code> under the <code>nav</code> key:</p> <pre><code>nav:\n  - Home: index.md\n  - Overview:\n    - overview/index.md\n  - Runbooks:\n    - runbooks/index.md\n    - ...\n</code></pre> <p>To add a new page: 1. Create the markdown file 2. Add it to the navigation in <code>mkdocs.yml</code> 3. Rebuild the site</p>"},{"location":"reference/deployment/#theme-customization","title":"Theme Customization","text":""},{"location":"reference/deployment/#colors","title":"Colors","text":"<p>Edit <code>mkdocs.yml</code>: <pre><code>theme:\n  palette:\n    primary: indigo  # Change to: red, pink, purple, etc.\n    accent: indigo   # Change to match primary\n</code></pre></p>"},{"location":"reference/deployment/#features","title":"Features","text":"<p>Enable/disable features in <code>mkdocs.yml</code>: <pre><code>theme:\n  features:\n    - navigation.tabs        # Top-level tabs\n    - navigation.sections    # Section headers\n    - search.suggest        # Search suggestions\n    - content.code.copy     # Copy code button\n</code></pre></p>"},{"location":"reference/deployment/#custom-css-and-javascript","title":"Custom CSS and JavaScript","text":"<p>Add custom styles in <code>docs/stylesheets/extra.css</code> Add custom scripts in <code>docs/javascripts/extra.js</code></p> <p>These are automatically included via <code>mkdocs.yml</code>.</p>"},{"location":"reference/deployment/#production-deployment","title":"\ud83c\udf10 Production Deployment","text":""},{"location":"reference/deployment/#github-pages","title":"GitHub Pages","text":"<ol> <li>Enable GitHub Pages in repository settings</li> <li>Deploy with mike: <pre><code>mike deploy --push --update-aliases 4.12 latest\n</code></pre></li> </ol>"},{"location":"reference/deployment/#custom-server","title":"Custom Server","text":"<ol> <li> <p>Build the site: <pre><code>mkdocs build\n</code></pre></p> </li> <li> <p>Copy <code>site/</code> directory to your web server:    <pre><code>rsync -av site/ user@server:/var/www/docs/\n</code></pre></p> </li> <li> <p>Configure Nginx (already included in <code>nginx.conf</code>)</p> </li> </ol>"},{"location":"reference/deployment/#container-registry","title":"Container Registry","text":"<ol> <li> <p>Tag image: <pre><code>docker tag ta-siemplus-docs:latest registry.example.com/ta-siemplus-docs:latest\n</code></pre></p> </li> <li> <p>Push to registry: <pre><code>docker push registry.example.com/ta-siemplus-docs:latest\n</code></pre></p> </li> <li> <p>Deploy on server: <pre><code>docker pull registry.example.com/ta-siemplus-docs:latest\ndocker run -d -p 80:80 registry.example.com/ta-siemplus-docs:latest\n</code></pre></p> </li> </ol>"},{"location":"reference/deployment/#update-workflow","title":"\ud83d\udd04 Update Workflow","text":""},{"location":"reference/deployment/#when-content-changes","title":"When Content Changes","text":"<ol> <li>Edit markdown files in appropriate directory</li> <li>Test locally: <pre><code>mkdocs serve\n</code></pre></li> <li>Commit and push to repository</li> <li>Rebuild Docker image (if using Docker):    <pre><code>docker-compose up -d --build\n</code></pre></li> </ol>"},{"location":"reference/deployment/#when-adding-new-runbookchecklist","title":"When Adding New Runbook/Checklist","text":"<ol> <li>Create the markdown file in appropriate directory</li> <li>Update navigation in <code>mkdocs.yml</code></li> <li>Add to index page of the section</li> <li>Test locally to verify links</li> <li>Commit and push</li> </ol>"},{"location":"reference/deployment/#for-new-wazuh-version","title":"For New Wazuh Version","text":"<ol> <li> <p>Create version directory: <pre><code>mkdir -p docs/upgrade-guides/4.13\n</code></pre></p> </li> <li> <p>Create version content: <pre><code>cp docs/upgrade-guides/4.12/index.md docs/upgrade-guides/4.13/index.md\n</code></pre></p> </li> <li> <p>Update content for new version</p> </li> <li> <p>Add to navigation in <code>mkdocs.yml</code></p> </li> <li> <p>Deploy version: <pre><code>mike deploy 4.13 latest --update-aliases\n</code></pre></p> </li> </ol>"},{"location":"reference/deployment/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"reference/deployment/#health-checks","title":"Health Checks","text":"<p>The Nginx configuration includes a health endpoint: <pre><code>curl http://localhost:8080/health\n# Should return: healthy\n</code></pre></p>"},{"location":"reference/deployment/#docker-health","title":"Docker Health","text":"<pre><code>docker ps --format \"table {{.Names}}\\t{{.Status}}\"\n</code></pre>"},{"location":"reference/deployment/#logs","title":"Logs","text":"<pre><code># Docker Compose\ndocker-compose logs -f docs\n\n# Docker\ndocker logs -f ta-siemplus-docs\n\n# Nginx access log\ndocker exec ta-siemplus-docs tail -f /var/log/nginx/access.log\n\n# Nginx error log\ndocker exec ta-siemplus-docs tail -f /var/log/nginx/error.log\n</code></pre>"},{"location":"reference/deployment/#security-considerations","title":"\ud83d\udd10 Security Considerations","text":""},{"location":"reference/deployment/#content-security","title":"Content Security","text":"<ul> <li>Never commit secrets to documentation</li> <li>Use vault references: <code>vault://path/to/secret</code></li> <li>Review all PRs before merging</li> </ul>"},{"location":"reference/deployment/#container-security","title":"Container Security","text":"<ul> <li>Use official base images</li> <li>Keep dependencies updated</li> <li>Run containers as non-root (Nginx already does this)</li> <li>Use read-only filesystem where possible</li> </ul>"},{"location":"reference/deployment/#network-security","title":"Network Security","text":"<ul> <li>Use HTTPS in production (add SSL termination)</li> <li>Configure firewall rules</li> <li>Consider authentication if needed (use reverse proxy)</li> </ul>"},{"location":"reference/deployment/#troubleshooting","title":"\ud83d\udee0\ufe0f Troubleshooting","text":""},{"location":"reference/deployment/#build-errors","title":"Build Errors","text":"<pre><code># Clear cache and rebuild\nrm -rf site/ .cache/\nmkdocs build --strict\n</code></pre>"},{"location":"reference/deployment/#docker-issues","title":"Docker Issues","text":"<pre><code># Rebuild without cache\ndocker-compose build --no-cache\n\n# Check container logs\ndocker-compose logs docs\n\n# Restart container\ndocker-compose restart docs\n</code></pre>"},{"location":"reference/deployment/#navigation-not-updating","title":"Navigation Not Updating","text":"<ol> <li>Check <code>mkdocs.yml</code> syntax</li> <li>Verify file paths are correct</li> <li>Clear browser cache</li> <li>Rebuild site</li> </ol>"},{"location":"reference/deployment/#mike-version-issues","title":"Mike Version Issues","text":"<pre><code># List deployed versions\nmike list\n\n# Rebuild specific version\nmike deploy 4.12 --update-aliases\n\n# Force delete and redeploy\nmike delete 4.12\nmike deploy 4.12 latest\n</code></pre>"},{"location":"reference/deployment/#best-practices","title":"\ud83d\udcdd Best Practices","text":""},{"location":"reference/deployment/#content","title":"Content","text":"<ul> <li>Use meaningful commit messages</li> <li>Test all links before committing</li> <li>Follow markdown style guide</li> <li>Keep content up to date</li> </ul>"},{"location":"reference/deployment/#versioning","title":"Versioning","text":"<ul> <li>Deploy new version for major Wazuh releases</li> <li>Keep at least 2 previous versions</li> <li>Archive very old versions</li> </ul>"},{"location":"reference/deployment/#performance","title":"Performance","text":"<ul> <li>Optimize images before adding</li> <li>Use lazy loading for large pages</li> <li>Monitor site size and build time</li> </ul>"},{"location":"reference/deployment/#maintenance","title":"Maintenance","text":"<ul> <li>Review and update quarterly</li> <li>Check for broken links monthly</li> <li>Update dependencies regularly</li> <li>Monitor for security updates</li> </ul>"},{"location":"reference/deployment/#additional-resources","title":"\ud83d\udcda Additional Resources","text":"<ul> <li>MkDocs Documentation</li> <li>Material for MkDocs</li> <li>Mike Documentation</li> <li>Nginx Documentation</li> </ul>"},{"location":"reference/mike-versioning/","title":"Mike Versioning Guide","text":"<p>This guide explains how to use mike for versioning the Ta-SIEMPlus documentation, particularly for managing multiple versions of Wazuh upgrade guides.</p>"},{"location":"reference/mike-versioning/#what-is-mike","title":"What is Mike?","text":"<p>Mike is a Python utility that manages multiple versions of MkDocs-powered documentation. It allows you to: - Deploy different versions of documentation - Switch between versions - Set a default version - Maintain version aliases (e.g., \"latest\", \"stable\")</p>"},{"location":"reference/mike-versioning/#installation","title":"Installation","text":"<p>Mike is already included in the project dependencies:</p> <pre><code>pip install mike\n</code></pre> <p>Or use the Docker image which has mike pre-installed.</p>"},{"location":"reference/mike-versioning/#basic-usage","title":"Basic Usage","text":""},{"location":"reference/mike-versioning/#deploy-a-new-version","title":"Deploy a New Version","text":"<p>When you create documentation for a new Wazuh version (e.g., 4.13), deploy it using mike:</p> <pre><code># Deploy version 4.13 and tag it as \"latest\"\nmike deploy 4.13 latest --update-aliases\n\n# Deploy version 4.13 without changing aliases\nmike deploy 4.13\n\n# Deploy and push to remote (for GitHub Pages)\nmike deploy 4.13 latest --push --update-aliases\n</code></pre>"},{"location":"reference/mike-versioning/#list-all-versions","title":"List All Versions","text":"<p>View all deployed versions:</p> <pre><code>mike list\n</code></pre> <p>Example output: <pre><code>4.10\n4.11\n4.12 [latest]\n</code></pre></p>"},{"location":"reference/mike-versioning/#set-default-version","title":"Set Default Version","text":"<p>Set which version users see by default:</p> <pre><code>mike set-default latest\n</code></pre>"},{"location":"reference/mike-versioning/#delete-a-version","title":"Delete a Version","text":"<p>Remove an old or deprecated version:</p> <pre><code>mike delete 4.10\n</code></pre>"},{"location":"reference/mike-versioning/#serve-versioned-docs-locally","title":"Serve Versioned Docs Locally","text":"<p>Test your versioned documentation locally:</p> <pre><code>mike serve\n</code></pre> <p>This starts a local server at http://localhost:8000 with version switching enabled.</p>"},{"location":"reference/mike-versioning/#workflow-for-new-wazuh-releases","title":"Workflow for New Wazuh Releases","text":"<p>When a new Wazuh version is released:</p>"},{"location":"reference/mike-versioning/#1-create-version-documentation","title":"1. Create Version Documentation","text":"<pre><code># Create directory for new version\nmkdir -p docs/upgrade-guides/4.13\n\n# Copy template from previous version\ncp docs/upgrade-guides/4.12/index.md docs/upgrade-guides/4.13/index.md\n</code></pre>"},{"location":"reference/mike-versioning/#2-update-content","title":"2. Update Content","text":"<p>Edit <code>docs/upgrade-guides/4.13/index.md</code>: - Update version numbers - Add new features and changes - Update known issues - Modify upgrade procedures if needed</p>"},{"location":"reference/mike-versioning/#3-update-navigation","title":"3. Update Navigation","text":"<p>Edit <code>mkdocs.yml</code> to include the new version:</p> <pre><code>nav:\n  - Upgrade Guides:\n    - upgrade-guides/index.md\n    - Wazuh 4.13:\n      - upgrade-guides/4.13/index.md\n    - Wazuh 4.12:\n      - upgrade-guides/4.12/index.md\n</code></pre>"},{"location":"reference/mike-versioning/#4-test-locally","title":"4. Test Locally","text":"<pre><code># Build and test\nmkdocs serve\n\n# Test with mike\nmike deploy 4.13 latest --update-aliases\nmike serve\n</code></pre>"},{"location":"reference/mike-versioning/#5-deploy-new-version","title":"5. Deploy New Version","text":"<pre><code># Commit your changes\ngit add .\ngit commit -m \"docs: Add Wazuh 4.13 upgrade guide\"\ngit push\n\n# Deploy with mike (if using GitHub Pages)\nmike deploy 4.13 latest --push --update-aliases\n</code></pre>"},{"location":"reference/mike-versioning/#version-aliases","title":"Version Aliases","text":"<p>Aliases are friendly names that point to specific versions:</p> <ul> <li>latest: Points to the most recent version</li> <li>stable: Points to the current stable release</li> <li>dev: Points to development/preview documentation</li> </ul>"},{"location":"reference/mike-versioning/#managing-aliases","title":"Managing Aliases","text":"<pre><code># Set multiple aliases for a version\nmike deploy 4.12 latest stable\n\n# Update aliases\nmike alias 4.12 latest --update\n\n# Remove an alias\nmike delete latest  # Deletes only the alias, not the version\n</code></pre>"},{"location":"reference/mike-versioning/#github-pages-integration","title":"GitHub Pages Integration","text":"<p>To publish versioned docs to GitHub Pages:</p>"},{"location":"reference/mike-versioning/#1-enable-github-pages","title":"1. Enable GitHub Pages","text":"<p>In your repository settings: - Go to Settings \u2192 Pages - Set source to \"gh-pages\" branch - Save</p>"},{"location":"reference/mike-versioning/#2-deploy-using-mike","title":"2. Deploy Using Mike","text":"<pre><code># Deploy and push to gh-pages branch\nmike deploy 4.12 latest --push --update-aliases\n\n# Set default version\nmike set-default --push latest\n</code></pre>"},{"location":"reference/mike-versioning/#3-access-your-docs","title":"3. Access Your Docs","text":"<p>Your documentation will be available at: <pre><code>https://[username].github.io/[repository-name]/\n</code></pre></p>"},{"location":"reference/mike-versioning/#best-practices","title":"Best Practices","text":""},{"location":"reference/mike-versioning/#version-naming","title":"Version Naming","text":"<p>Use consistent version naming: - \u2705 <code>4.12</code>, <code>4.13</code>, <code>4.14</code> - Wazuh version numbers - \u2705 <code>latest</code>, <code>stable</code>, <code>dev</code> - Aliases - \u274c <code>v4.12</code>, <code>version-4.12</code> - Inconsistent formats</p>"},{"location":"reference/mike-versioning/#when-to-create-a-new-version","title":"When to Create a New Version","text":"<p>Create new versioned documentation for: - Major Wazuh releases (e.g., 4.0, 5.0) - Minor releases with significant changes (e.g., 4.12, 4.13) - LTS (Long-Term Support) releases</p> <p>Don't create versions for: - Patch releases (e.g., 4.12.1, 4.12.2) - update existing version - Documentation fixes - update existing version - Minor corrections - update existing version</p>"},{"location":"reference/mike-versioning/#maintaining-old-versions","title":"Maintaining Old Versions","text":"<ul> <li>Keep at least 2 previous major versions</li> <li>Archive very old versions (move to archive section)</li> <li>Update old versions only for critical security issues</li> </ul>"},{"location":"reference/mike-versioning/#version-lifecycle","title":"Version Lifecycle","text":"<ol> <li>New - Recently released, actively updated</li> <li>Stable - Current recommended version</li> <li>Previous - Older but still supported</li> <li>Deprecated - No longer recommended</li> <li>Archived - Historical reference only</li> </ol>"},{"location":"reference/mike-versioning/#troubleshooting","title":"Troubleshooting","text":""},{"location":"reference/mike-versioning/#version-not-showing","title":"Version Not Showing","text":"<p>If a deployed version doesn't appear:</p> <pre><code># Check deployed versions\nmike list\n\n# Rebuild version\nmike deploy 4.12 --update-aliases\n\n# Clear browser cache\n</code></pre>"},{"location":"reference/mike-versioning/#wrong-default-version","title":"Wrong Default Version","text":"<pre><code># Set correct default\nmike set-default latest\n\n# Verify\nmike list\n</code></pre>"},{"location":"reference/mike-versioning/#broken-links-after-deploying","title":"Broken Links After Deploying","text":"<p>Ensure all internal links use relative paths: <pre><code># \u2705 Good\n[Upgrade Guide](../upgrade-guides/4.12/)\n\n# \u274c Bad (won't work with versioning)\n[Upgrade Guide](/upgrade-guides/4.12/)\n</code></pre></p>"},{"location":"reference/mike-versioning/#cant-delete-version","title":"Can't Delete Version","text":"<p>If deletion fails:</p> <pre><code># Force delete\nmike delete 4.10 --force\n\n# Or manually delete from gh-pages branch\ngit checkout gh-pages\ngit rm -r 4.10/\ngit commit -m \"Remove version 4.10\"\ngit push\n</code></pre>"},{"location":"reference/mike-versioning/#advanced-usage","title":"Advanced Usage","text":""},{"location":"reference/mike-versioning/#custom-version-selector","title":"Custom Version Selector","text":"<p>Customize the version selector in <code>mkdocs.yml</code>:</p> <pre><code>extra:\n  version:\n    provider: mike\n    default: latest\n</code></pre>"},{"location":"reference/mike-versioning/#multiple-documentation-sites","title":"Multiple Documentation Sites","text":"<p>You can use mike to manage different documentation sites:</p> <pre><code># Deploy to different remote\nmike deploy 4.12 --remote origin-docs --push\n\n# Use different gh-pages branch\nmike deploy 4.12 --branch documentation --push\n</code></pre>"},{"location":"reference/mike-versioning/#version-specific-configuration","title":"Version-Specific Configuration","text":"<p>Create version-specific overrides:</p> <pre><code># In your deploy script\nif [ \"$VERSION\" = \"4.12\" ]; then\n  mike deploy 4.12 --config-file mkdocs-4.12.yml\nfi\n</code></pre>"},{"location":"reference/mike-versioning/#integration-with-cicd","title":"Integration with CI/CD","text":"<p>Example GitHub Actions workflow:</p> <pre><code>name: Deploy Docs\non:\n  push:\n    branches: [main]\n    paths: ['docs/**', 'mkdocs.yml']\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-python@v4\n        with:\n          python-version: 3.x\n\n      - run: pip install mkdocs-material mike\n\n      - run: |\n          git config user.name github-actions\n          git config user.email github-actions@github.com\n          mike deploy --push --update-aliases ${{ github.ref_name }} latest\n</code></pre>"},{"location":"reference/mike-versioning/#additional-resources","title":"Additional Resources","text":"<ul> <li>Mike Documentation</li> <li>MkDocs Documentation</li> <li>Material for MkDocs</li> </ul>"},{"location":"reference/mike-versioning/#quick-reference-card","title":"Quick Reference Card","text":"<pre><code># Most common commands\nmike deploy &lt;version&gt; [alias]     # Deploy a version\nmike deploy &lt;version&gt; --push      # Deploy and push to remote\nmike list                         # List all versions\nmike set-default &lt;version&gt;        # Set default version\nmike serve                        # Serve versioned docs locally\nmike delete &lt;version&gt;             # Delete a version\nmike alias &lt;version&gt; &lt;new-alias&gt;  # Add an alias to version\n</code></pre>"},{"location":"runbooks/","title":"Runbooks","text":"<p>Runbooks are detailed step-by-step operational procedures for Wazuh SIEM maintenance tasks. Each runbook includes:</p> <ul> <li>Complete command sequences</li> <li>Validation checks at each step</li> <li>Troubleshooting procedures</li> <li>Rollback strategies</li> <li>No-go safety gates</li> </ul>"},{"location":"runbooks/#available-runbooks","title":"\ud83d\udcd6 Available Runbooks","text":""},{"location":"runbooks/#wazuh-upgrades","title":"Wazuh Upgrades","text":"<ul> <li>Wazuh Upgrade AIO Ubuntu - Complete upgrade procedure for Wazuh All-in-One installations on Ubuntu using APT</li> </ul>"},{"location":"runbooks/#agent-management","title":"Agent Management","text":"<ul> <li>Wazuh Agent Group Management - Managing agent groups, configurations, and deployments</li> </ul>"},{"location":"runbooks/#templates","title":"Templates","text":"<ul> <li>Runbook Template - Standard template for creating new runbooks</li> </ul>"},{"location":"runbooks/#how-to-use-runbooks","title":"\ud83c\udfaf How to Use Runbooks","text":""},{"location":"runbooks/#before-you-start","title":"Before You Start","text":"<ol> <li>Read the entire runbook first</li> <li>Ensure all prerequisites are met</li> <li>Have the corresponding checklist ready</li> <li>Verify you're within the maintenance window</li> </ol>"},{"location":"runbooks/#during-execution","title":"During Execution","text":"<ol> <li>Follow steps in exact order</li> <li>Validate each step before proceeding</li> <li>Document any deviations</li> <li>Stop if any no-go gate is triggered</li> <li>Capture health snapshots (pre and post)</li> </ol>"},{"location":"runbooks/#after-completion","title":"After Completion","text":"<ol> <li>Run all post-validation checks</li> <li>Document any issues encountered</li> <li>Update the change ticket</li> <li>Notify stakeholders</li> <li>Provide feedback for runbook improvements</li> </ol>"},{"location":"runbooks/#no-go-gates-safety-rules","title":"\ud83d\uded1 No-Go Gates (Safety Rules)","text":"<p>DO NOT PROCEED if any of these conditions are present:</p> <ul> <li>\u274c Disk usage &gt; 90%</li> <li>\u274c Any service not in <code>active (running)</code> state</li> <li>\u274c No valid backup/snapshot available</li> <li>\u274c Change ticket not approved</li> <li>\u274c Outside maintenance window</li> <li>\u274c Missing required credentials or access</li> <li>\u274c Critical errors in health check</li> </ul>"},{"location":"runbooks/#health-snapshot-requirements","title":"\ud83d\udcf8 Health Snapshot Requirements","text":"<p>Every runbook execution requires capturing system state:</p>"},{"location":"runbooks/#pre-change-snapshot","title":"Pre-Change Snapshot","text":"<pre><code># Component versions\ndpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\n\n# Service status\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Disk usage\ndf -h\n\n# Cluster health\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n\n# Recent errors\njournalctl -u wazuh-manager -n 50 --no-pager -p err\n</code></pre>"},{"location":"runbooks/#post-change-snapshot","title":"Post-Change Snapshot","text":"<p>Run the same commands after the change and compare results.</p>"},{"location":"runbooks/#common-validation-commands","title":"\ud83d\udd27 Common Validation Commands","text":""},{"location":"runbooks/#service-status","title":"Service Status","text":"<pre><code>systemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n</code></pre>"},{"location":"runbooks/#version-check","title":"Version Check","text":"<pre><code>dpkg -l | grep -E 'wazuh-(indexer|manager|dashboard)|filebeat'\n</code></pre>"},{"location":"runbooks/#cluster-health","title":"Cluster Health","text":"<pre><code>curl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n</code></pre>"},{"location":"runbooks/#api-check","title":"API Check","text":"<pre><code>curl -k -u &lt;user&gt;:&lt;password&gt; https://localhost:55000/\n</code></pre>"},{"location":"runbooks/#agent-status","title":"Agent Status","text":"<pre><code>/var/ossec/bin/agent_control -l\n</code></pre>"},{"location":"runbooks/#contributing-new-runbooks","title":"\ud83d\udcdd Contributing New Runbooks","text":"<p>When creating a new runbook:</p> <ol> <li>Use the Runbook Template</li> <li>Include all required sections:</li> <li>Purpose and scope</li> <li>Prerequisites</li> <li>No-go gates</li> <li>Step-by-step procedure</li> <li>Validation checks</li> <li>Rollback procedure</li> <li>Troubleshooting</li> <li>Create a corresponding checklist</li> <li>Test in non-production environment</li> <li>Submit via Pull Request with rationale</li> </ol>"},{"location":"runbooks/#related-resources","title":"\ud83d\udd17 Related Resources","text":"<ul> <li>Checklists - Ticket templates synchronized with runbooks</li> <li>Upgrade Guides - Version-specific upgrade procedures</li> <li>Reference - Quick command references</li> <li>Official Wazuh Documentation</li> </ul>"},{"location":"runbooks/RUNBOOK-TEMPLATE/","title":"{{title}}","text":"","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#purpose-scope","title":"Purpose / Scope","text":"<p>Describe what this runbook covers: - What systems/components are affected - What type of operation this runbook supports (upgrade, maintenance, recovery, etc.) - When to use this runbook</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#prerequisites","title":"Prerequisites","text":"<p>Before starting, ensure you have: - [ ] Required access credentials (stored in vault: <code>vault://...</code>) - [ ] Maintenance window scheduled: <code>YYYY-MM-DD HH:MM - HH:MM (Timezone)</code> - [ ] Valid snapshot/backup ID: <code>{{snapshot_id}}</code> - [ ] Customer notification sent - [ ] Change ticket created: <code>{{change_ticket}}</code></p> <p>Required Knowledge: - Understanding of Wazuh architecture - Familiarity with Linux system administration - Access to emergency contacts</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#pre-checks-no-go-gates","title":"Pre-Checks (No-Go Gates)","text":"<p>These conditions must be met before proceeding. If any check fails, DO NOT PROCEED:</p> <ol> <li>Version Compatibility: Manager-Version \u2265 Agent-Version</li> <li>Backup Exists: Snapshot/backup verified and accessible</li> <li>System Health: All services in healthy state</li> <li>Disk Space: Sufficient disk space available (&lt; 85% usage, No-Go &gt; 90%)</li> <li>Time Window: Current time is within approved maintenance window</li> </ol>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#runbook-steps","title":"Runbook Steps","text":"","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#step-0-health-snapshot-pre-change","title":"Step 0: Health Snapshot (Pre-Change)","text":"<p>Purpose: Create an auditable baseline of system state before making changes.</p> <p>Commands: <pre><code>set -euo pipefail\n\necho \"=== DATE/UPTIME ===\"\ndate -Is\nuptime\n\necho \"=== DISK/MEM ===\"\ndf -h\nfree -h\n\necho \"=== SERVICES ===\"\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat || true\n\necho \"=== VERSIONS ===\"\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)' || true\n</code></pre></p> <p>Expected Output: All services should be active (running). Note any warnings.</p> <p>Documentation: Save this output to your change ticket as \"Pre-Change Health Snapshot\"</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#step-1-backup-snapshot-mandatory","title":"Step 1: Backup / Snapshot (Mandatory)","text":"<p>Purpose: Create recovery point before making any changes.</p> <p>Standard Method: VM/Volume snapshot (recommended)</p> <p>Alternative Method: Configuration backup</p> <p>Commands: <pre><code>set -euo pipefail\nBACKUP_DIR=\"/root/wazuh_backup_$(date +%F_%H%M%S)\"\nmkdir -p \"$BACKUP_DIR\"\ntar -czf \"$BACKUP_DIR/var_ossec_etc.tgz\" /var/ossec/etc\n\necho \"Backup written to: $BACKUP_DIR\"\nls -lah \"$BACKUP_DIR\"\n</code></pre></p> <p>Verification: Confirm backup file exists and has reasonable size (&gt; 0 bytes)</p> <p>Documentation: Record snapshot ID in your checklist and change ticket</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#step-2-main-operations","title":"Step 2: Main Operations","text":"<p>Purpose: Describe what the main operations accomplish.</p> <p>Commands: <pre><code># Add specific commands for your procedure here\n# Use set -euo pipefail for error handling\n# Include verification steps after each critical operation\n</code></pre></p> <p>Troubleshooting: - If X happens: Do Y - If service fails to start: Check logs with <code>journalctl -u service-name -n 100</code></p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#step-3-post-change-actions","title":"Step 3: Post-Change Actions","text":"<p>Purpose: Verify changes and restore normal operations.</p> <p>Commands: <pre><code># Commands to finalize the change\n# Restart services if needed\n# Verify connectivity and functionality\n</code></pre></p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#step-4-health-snapshot-post-change","title":"Step 4: Health Snapshot (Post-Change)","text":"<p>Purpose: Verify system health after changes.</p> <p>Commands: (Same as Step 0)</p> <p>Verification: - [ ] All services active (running) - [ ] No critical errors in logs - [ ] Versions match target (for upgrades)</p> <p>Documentation: Save this output to your change ticket as \"Post-Change Health Snapshot\"</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#rollback-procedure","title":"Rollback Procedure","text":"<p>When to Rollback: - Service fails to start or crashes repeatedly - Critical functionality is broken - Data integrity issues detected - Unable to complete procedure within maintenance window</p> <p>Standard Rollback Method: Snapshot/Volume Restore</p> <p>Steps: 1. Stop all affected services 2. Restore from snapshot ID: <code>{{snapshot_id}}</code> 3. Verify services start successfully 4. Run Health Snapshot (Step 0) and document 5. Create incident record with root cause</p> <p>Alternative Rollback Method: (If snapshot not available - document risk!)</p> <p>Post-Rollback Actions: - [ ] Notify customer of rollback and current status - [ ] Create incident/problem record - [ ] Schedule root cause analysis - [ ] Document lessons learned</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#post-checks-acceptance-criteria","title":"Post-Checks / Acceptance Criteria","text":"<p>Minimum criteria for successful completion:</p> <ul> <li> Dashboard/UI reachable and functional</li> <li> User login successful</li> <li> Data flow verified (new events observed / test event confirmed)</li> <li> No critical errors in system logs</li> <li> Customer acceptance obtained</li> <li> Change ticket fully documented (Pre/Post snapshots, findings, deviations)</li> </ul>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#references","title":"References","text":"<ul> <li>Related Checklist: <code>{{related_checklist}}</code></li> <li>Change Note Template: <code>templates/CHANGE_NOTE_TEMPLATE.md</code></li> <li>Customer Catalog: <code>Catalog/CUSTOMERS.md</code></li> <li>Official Wazuh Documentation: https://documentation.wazuh.com/current/</li> </ul>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK-TEMPLATE/#maintenance-notes","title":"Maintenance Notes","text":"<p>Last Updated: {{last_reviewed}} Update Frequency: Review quarterly or after significant Wazuh version changes Change History: See git commit history for this file  </p> <p>Known Issues: - (Document any known limitations or issues with this procedure)</p> <p>Future Improvements: - (Track planned enhancements to this runbook)</p>","tags":["wazuh","upgrade","aio"]},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/","title":"RUNBOOK: Wazuh Agentengruppen-Verwaltung","text":"<p>Version: 1.0.0 Letzte Aktualisierung: 2026-02-17 Anwendbar auf: Wazuh Manager (alle Versionen ab 4.x) Betriebssystem: Linux (Ubuntu, CentOS, RHEL, etc.)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#inhaltsverzeichnis","title":"\ud83d\udccb Inhaltsverzeichnis","text":"<ol> <li>\u00dcberblick</li> <li>Wichtige Dateien</li> <li>Kommandozeilenverwaltung</li> <li>Gruppenkonfiguration</li> <li>Best Practices</li> <li>Troubleshooting</li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#0-nicht-verhandelbare-regeln","title":"0) Nicht verhandelbare Regeln","text":"<p>\u26a0\ufe0f STOP-Kriterien \u2013 Diese Bedingungen sind absolute STOP-Signale:</p> Regel Beschreibung Check-Befehl Wazuh Manager muss laufen Der Manager-Service muss aktiv sein <code>systemctl status wazuh-manager</code> Backup vor \u00c4nderungen Vor gr\u00f6\u00dferen Gruppen\u00e4nderungen Backup erstellen <code>tar -czf /tmp/wazuh-groups-backup-$(date +%F).tar.gz /var/ossec/etc/shared/</code> Keine gleichzeitigen \u00c4nderungen Nur ein Administrator darf Gruppen \u00e4ndern Koordination im Team G\u00fcltige Gruppennamen Nur alphanumerische Zeichen, Unterstriche und Bindestriche erlaubt <code>[a-zA-Z0-9_-]+</code>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#uberblick","title":"\u00dcberblick","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#was-sind-wazuh-agentengruppen","title":"Was sind Wazuh Agentengruppen?","text":"<p>Wazuh Agentengruppen erm\u00f6glichen die zentrale Verwaltung von Agent-Konfigurationen. Agenten k\u00f6nnen einer oder mehreren Gruppen zugeordnet werden und erhalten automatisch die kombinierten Konfigurationen aller Gruppen.</p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#hauptmerkmale","title":"Hauptmerkmale:","text":"<ul> <li>Zentrale Konfigurationsverwaltung: Konfigurationen werden vom Manager verwaltet und automatisch an Agenten verteilt</li> <li>Multi-Gruppen-Unterst\u00fctzung: Ein Agent kann mehreren Gruppen gleichzeitig angeh\u00f6ren</li> <li>Automatische Synchronisation: \u00c4nderungen werden automatisch an alle betroffenen Agenten \u00fcbertragen</li> <li>Persistenz: Gruppenzugeh\u00f6rigkeiten bleiben bei Agent-Neuregistrierung erhalten</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#wichtige-dateien","title":"Wichtige Dateien","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#1-mergedmg","title":"1. merged.mg","text":"<p>Pfad: <code>/var/ossec/etc/shared/&lt;agent-id&gt;/merged.mg</code></p> <p>Beschreibung: Die Datei <code>merged.mg</code> wird vom Wazuh-Manager generiert und enth\u00e4lt die konsolidierte Konfiguration aller Gruppen, denen ein Agent angeh\u00f6rt. Diese Datei spielt eine zentrale Rolle bei der Agent-Konfiguration.</p> <p>Funktionsweise: - Wird automatisch vom Manager erstellt und aktualisiert - Enth\u00e4lt die zusammengef\u00fchrte Konfiguration aus allen Gruppen des Agents - Wird bei jeder Konfigurations\u00e4nderung oder Gruppenzuordnung neu generiert - Automatisch an den Agent \u00fcbertragen - \u00dcber das Dashboard einsehbar, aber nicht editierbar</p> <p>Wichtige Eigenschaften: - Stellt sicher, dass Agenten stets die aktuelle Konfiguration erhalten - Unterst\u00fctzt automatische Wiederzuordnung nach erneuter Registrierung - Konfliktaufl\u00f6sung bei \u00fcberlappenden Konfigurationen folgt einer definierten Priorit\u00e4t</p> <p>Beispiel-Struktur: <pre><code>&lt;!-- merged.mg --&gt;\n&lt;agent_config&gt;\n  &lt;!-- Konfiguration aus Gruppe \"linux-servers\" --&gt;\n  &lt;localfile&gt;\n    &lt;location&gt;/var/log/syslog&lt;/location&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- Konfiguration aus Gruppe \"web-servers\" --&gt;\n  &lt;localfile&gt;\n    &lt;location&gt;/var/log/apache2/access.log&lt;/location&gt;\n    &lt;log_format&gt;apache&lt;/log_format&gt;\n  &lt;/localfile&gt;\n&lt;/agent_config&gt;\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#2-arconf","title":"2. ar.conf","text":"<p>Pfad: <code>/var/ossec/etc/shared/&lt;group-name&gt;/ar.conf</code></p> <p>Beschreibung: Die Datei <code>ar.conf</code> (Active Response Configuration) definiert Befehle, die auf den Agenten innerhalb einer Gruppe ausgef\u00fchrt werden k\u00f6nnen.</p> <p>Verwendungszweck: - Liste von Befehlen f\u00fcr Active Response - Skripte oder Programme f\u00fcr Wartungsaufgaben - Befehle zur Problembehebung - Service-Neustart-Anweisungen</p> <p>Beispiel-Inhalt: <pre><code># ar.conf - Active Response Commands\n\n# Neustart des Wazuh-Agents (Linux)\nrestart-wazuh0 - restart-wazuh - 0\n\n# Neustart des Wazuh-Agents (Windows)\nrestart-wazuh-windows - restart-wazuh.exe - 0\n\n# Neustart des OSSEC-Dienstes\nrestart-ossec0 - restart-ossec - 0\n\n# Firewall-Blockierung\nfirewall-block - firewall-block.sh - default-firewall-drop\n\n# Host-Deny\nhost-deny - host-deny.sh - default-ossec-deny\n</code></pre></p> <p>Befehls-Format: <pre><code>&lt;name&gt; - &lt;executable&gt; - &lt;timeout/event-location&gt;\n</code></pre></p> <p>Wichtige Hinweise: - Befehle m\u00fcssen auf dem Agent-System verf\u00fcgbar sein - Ausf\u00fchrungsberechtigungen m\u00fcssen korrekt gesetzt sein - \u00dcber das Dashboard einsehbar, aber nicht editierbar - \u00c4nderungen erfordern Manager-Neustart</p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#3-agentconf","title":"3. agent.conf","text":"<p>Pfad: <code>/var/ossec/etc/shared/&lt;group-name&gt;/agent.conf</code></p> <p>Beschreibung: Enth\u00e4lt die spezifische Konfiguration f\u00fcr alle Agenten in dieser Gruppe.</p> <p>Beispiel: <pre><code>&lt;agent_config&gt;\n  &lt;client_buffer&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;queue_size&gt;5000&lt;/queue_size&gt;\n  &lt;/client_buffer&gt;\n\n  &lt;localfile&gt;\n    &lt;location&gt;/var/log/syslog&lt;/location&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n  &lt;/localfile&gt;\n&lt;/agent_config&gt;\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#kommandozeilenverwaltung","title":"Kommandozeilenverwaltung","text":"<p>Das Tool <code>agent_groups</code> erm\u00f6glicht die vollst\u00e4ndige Verwaltung von Agentengruppen \u00fcber die Kommandozeile.</p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppen-erstellen","title":"Gruppen erstellen","text":"<p>Neue Agentengruppe erstellen: <pre><code>/var/ossec/bin/agent_groups -a -g &lt;group-name&gt;\n</code></pre></p> <p>Beispiele: <pre><code># Linux-Server-Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g linux-servers\n\n# Web-Server-Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g web-servers\n\n# Datenbank-Server-Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g db-servers\n\n# Entwicklungs-Umgebung\n/var/ossec/bin/agent_groups -a -g dev-environment\n</code></pre></p> <p>Hinweise: - Gruppennamen sollten beschreibend sein - Verwenden Sie Bindestriche oder Unterstriche (keine Leerzeichen) - Keine Sonderzeichen au\u00dfer <code>-</code> und <code>_</code></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppen-auflisten","title":"Gruppen auflisten","text":"<p>Alle Gruppen anzeigen: <pre><code>/var/ossec/bin/agent_groups -l\n</code></pre></p> <p>Gruppen mit Details anzeigen: <pre><code>/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n</code></pre></p> <p>Beispiel-Ausgabe: <pre><code>Groups:\n  - linux-servers (5 agents)\n  - web-servers (3 agents)\n  - db-servers (2 agents)\n  - default (0 agents)\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#agenten-zu-gruppen-hinzufugen","title":"Agenten zu Gruppen hinzuf\u00fcgen","text":"<p>Agent zu einer Gruppe hinzuf\u00fcgen: <pre><code>/var/ossec/bin/agent_groups -a -i &lt;agent-id&gt; -g &lt;group-name&gt;\n</code></pre></p> <p>Agent zu mehreren Gruppen hinzuf\u00fcgen: <pre><code>/var/ossec/bin/agent_groups -a -i &lt;agent-id&gt; -g &lt;group1&gt;,&lt;group2&gt;,&lt;group3&gt;\n</code></pre></p> <p>Beispiele: <pre><code># Agent 001 zur Gruppe linux-servers hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i 001 -g linux-servers\n\n# Agent 002 zu linux-servers und web-servers hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i 002 -g linux-servers,web-servers\n\n# Agent 003 zu mehreren Gruppen\n/var/ossec/bin/agent_groups -a -i 003 -g linux-servers,db-servers,prod-environment\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#agenten-aus-gruppen-entfernen","title":"Agenten aus Gruppen entfernen","text":"<p>Agent aus einer Gruppe entfernen: <pre><code>/var/ossec/bin/agent_groups -r -i &lt;agent-id&gt; -g &lt;group-name&gt;\n</code></pre></p> <p>Agent komplett aus allen Gruppen entfernen: <pre><code>/var/ossec/bin/agent_groups -r -i &lt;agent-id&gt;\n</code></pre></p> <p>Beispiele: <pre><code># Agent 001 aus web-servers entfernen\n/var/ossec/bin/agent_groups -r -i 001 -g web-servers\n\n# Agent 003 aus allen Gruppen entfernen\n/var/ossec/bin/agent_groups -r -i 003\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppen-mitglieder-anzeigen","title":"Gruppen-Mitglieder anzeigen","text":"<p>Alle Agenten einer Gruppe auflisten: <pre><code>/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n</code></pre></p> <p>Detaillierte Agenten-Info mit Gruppen: <pre><code>/var/ossec/bin/manage_agents -l\n</code></pre></p> <p>Beispiel-Ausgabe: <pre><code>Available agents:\n   ID: 001, Name: web-server-01, IP: 10.0.1.10, Groups: linux-servers,web-servers\n   ID: 002, Name: db-server-01, IP: 10.0.1.20, Groups: linux-servers,db-servers\n   ID: 003, Name: app-server-01, IP: 10.0.1.30, Groups: linux-servers\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppe-loschen","title":"Gruppe l\u00f6schen","text":"<p>Achtung: Agenten m\u00fcssen zuerst aus der Gruppe entfernt werden!</p> <pre><code># Schritt 1: Alle Agenten aus der Gruppe entfernen\n/var/ossec/bin/agent_groups -r -g &lt;group-name&gt;\n\n# Schritt 2: Gruppe l\u00f6schen (Verzeichnis entfernen)\nrm -rf /var/ossec/etc/shared/&lt;group-name&gt;\n\n# Schritt 3: Manager-Cache aktualisieren\nsystemctl restart wazuh-manager\n</code></pre> <p>Beispiel: <pre><code># Gruppe \"old-servers\" komplett entfernen\n/var/ossec/bin/agent_groups -r -g old-servers\nrm -rf /var/ossec/etc/shared/old-servers\nsystemctl restart wazuh-manager\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppenkonfiguration","title":"Gruppenkonfiguration","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppenkonfiguration-erstellen","title":"Gruppenkonfiguration erstellen","text":"<p>1. Gruppenverzeichnis anlegen (automatisch beim Erstellen der Gruppe): <pre><code>/var/ossec/bin/agent_groups -a -g &lt;group-name&gt;\n</code></pre></p> <p>2. Konfigurationsdatei erstellen: <pre><code>vi /var/ossec/etc/shared/&lt;group-name&gt;/agent.conf\n</code></pre></p> <p>3. Beispiel-Konfiguration: <pre><code>&lt;agent_config&gt;\n  &lt;!-- Logging-Konfiguration --&gt;\n  &lt;localfile&gt;\n    &lt;location&gt;/var/log/syslog&lt;/location&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n  &lt;/localfile&gt;\n\n  &lt;localfile&gt;\n    &lt;location&gt;/var/log/auth.log&lt;/location&gt;\n    &lt;log_format&gt;syslog&lt;/log_format&gt;\n  &lt;/localfile&gt;\n\n  &lt;!-- Rootcheck-Konfiguration --&gt;\n  &lt;rootcheck&gt;\n    &lt;frequency&gt;43200&lt;/frequency&gt;\n  &lt;/rootcheck&gt;\n\n  &lt;!-- SCA-Konfiguration --&gt;\n  &lt;sca&gt;\n    &lt;enabled&gt;yes&lt;/enabled&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;interval&gt;12h&lt;/interval&gt;\n  &lt;/sca&gt;\n&lt;/agent_config&gt;\n</code></pre></p> <p>4. Active Response Commands konfigurieren (optional): <pre><code>vi /var/ossec/etc/shared/&lt;group-name&gt;/ar.conf\n</code></pre></p> <pre><code># Beispiel ar.conf\nrestart-wazuh0 - restart-wazuh - 0\nfirewall-block - firewall-block.sh - default-firewall-drop\n</code></pre> <p>5. Konfiguration validieren: <pre><code>/var/ossec/bin/wazuh-logtest-config\n</code></pre></p> <p>6. Manager neu laden: <pre><code>systemctl restart wazuh-manager\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#best-practices","title":"Best Practices","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#1-namenskonventionen","title":"1. Namenskonventionen","text":"<p>Empfohlene Namensstruktur: <pre><code>&lt;umgebung&gt;-&lt;funktion&gt;-&lt;location&gt;\n\nBeispiele:\n- prod-web-servers\n- dev-database-servers\n- test-app-servers\n- prod-linux-eu-west\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#2-gruppen-hierarchie","title":"2. Gruppen-Hierarchie","text":"<p>Basis-Gruppen: <pre><code>linux-base      \u2192 Grundkonfiguration f\u00fcr alle Linux-Systeme\nwindows-base    \u2192 Grundkonfiguration f\u00fcr alle Windows-Systeme\n</code></pre></p> <p>Funktions-Gruppen: <pre><code>web-servers     \u2192 Spezifische Konfiguration f\u00fcr Webserver\ndb-servers      \u2192 Spezifische Konfiguration f\u00fcr Datenbankserver\napp-servers     \u2192 Spezifische Konfiguration f\u00fcr Applikationsserver\n</code></pre></p> <p>Umgebungs-Gruppen: <pre><code>prod            \u2192 Produktionsumgebung\ntest            \u2192 Testumgebung\ndev             \u2192 Entwicklungsumgebung\n</code></pre></p> <p>Agent-Zuordnung (Multi-Gruppen): <pre><code># Beispiel: Production Web Server\n/var/ossec/bin/agent_groups -a -i 001 -g linux-base,web-servers,prod\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#3-konfigurationsmanagement","title":"3. Konfigurationsmanagement","text":"<p>Versionskontrolle: - Alle Gruppenkonfigurationen in Git verwalten - \u00c4nderungen \u00fcber Pull Requests reviewen - Rollback-M\u00f6glichkeit sicherstellen</p> <p>Backup-Strategie: <pre><code># Vor \u00c4nderungen Backup erstellen\ntar -czf /backup/wazuh-groups-$(date +%F-%H%M).tar.gz /var/ossec/etc/shared/\n\n# Regelm\u00e4\u00dfige Backups (Cron)\n0 2 * * * tar -czf /backup/wazuh-groups-$(date +\\%F).tar.gz /var/ossec/etc/shared/\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#4-testing","title":"4. Testing","text":"<p>Test-Gruppe verwenden: <pre><code># Test-Gruppe erstellen\n/var/ossec/bin/agent_groups -a -g test-config\n\n# Test-Agent zuweisen\n/var/ossec/bin/agent_groups -a -i 999 -g test-config\n\n# Konfiguration testen\n# ... \u00c4nderungen beobachten ...\n\n# Bei Erfolg auf alle Agenten ausrollen\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#5-dokumentation","title":"5. Dokumentation","text":"<p>F\u00fcr jede Gruppe dokumentieren: - Zweck der Gruppe - Enthaltene Konfigurationen - Zugewiesene Agenten - \u00c4nderungshistorie - Verantwortliche Person</p> <p>Beispiel-Dokumentation: <pre><code>gruppe: web-servers\nzweck: Konfiguration f\u00fcr Apache/Nginx Webserver\nkonfigurationen:\n  - Apache access/error logs\n  - Nginx access/error logs\n  - ModSecurity monitoring\n  - SSL/TLS certificate monitoring\nagenten_count: 12\nerstellt: 2026-01-15\nverantwortlich: security-team@company.com\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#troubleshooting","title":"Troubleshooting","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#problem-agent-erhalt-keine-konfiguration","title":"Problem: Agent erh\u00e4lt keine Konfiguration","text":"<p>Symptom: <pre><code>Agent logs zeigen keine Konfigurationsaktualisierung\n</code></pre></p> <p>Diagnose: <pre><code># 1. Gruppenzugeh\u00f6rigkeit pr\u00fcfen\n/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n\n# 2. merged.mg pr\u00fcfen\nls -la /var/ossec/etc/shared/&lt;agent-id&gt;/merged.mg\n\n# 3. Manager-Logs pr\u00fcfen\ntail -f /var/ossec/logs/ossec.log | grep \"group\"\n\n# 4. Agent-Verbindung pr\u00fcfen\n/var/ossec/bin/agent_control -l\n</code></pre></p> <p>L\u00f6sung: <pre><code># Agent erneut zur Gruppe hinzuf\u00fcgen\n/var/ossec/bin/agent_groups -a -i &lt;agent-id&gt; -g &lt;group-name&gt;\n\n# Manager neu starten\nsystemctl restart wazuh-manager\n\n# Agent-Synchronisation erzwingen\n/var/ossec/bin/agent_control -R &lt;agent-id&gt;\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#problem-mergedmg-wird-nicht-aktualisiert","title":"Problem: merged.mg wird nicht aktualisiert","text":"<p>Symptom: <pre><code>Konfigurations\u00e4nderungen werden nicht an Agenten \u00fcbertragen\n</code></pre></p> <p>Diagnose: <pre><code># 1. Dateiberechtigungen pr\u00fcfen\nls -la /var/ossec/etc/shared/&lt;group-name&gt;/\n\n# 2. Manager-Prozess pr\u00fcfen\nps aux | grep wazuh-remoted\n\n# 3. Queue pr\u00fcfen\nls -la /var/ossec/queue/rids/\n</code></pre></p> <p>L\u00f6sung: <pre><code># 1. Berechtigungen korrigieren\nchown -R wazuh:wazuh /var/ossec/etc/shared/&lt;group-name&gt;/\nchmod 750 /var/ossec/etc/shared/&lt;group-name&gt;/\nchmod 640 /var/ossec/etc/shared/&lt;group-name&gt;/*\n\n# 2. Manager neu starten\nsystemctl restart wazuh-manager\n\n# 3. Agent-Synchronisation erzwingen\n/var/ossec/bin/agent_control -R -a\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#problem-gruppe-kann-nicht-geloscht-werden","title":"Problem: Gruppe kann nicht gel\u00f6scht werden","text":"<p>Symptom: <pre><code>Fehler beim L\u00f6schen einer Gruppe\n</code></pre></p> <p>Diagnose: <pre><code># 1. Agenten in der Gruppe pr\u00fcfen\n/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n\n# 2. Dateisystem-Locks pr\u00fcfen\nlsof | grep /var/ossec/etc/shared/&lt;group-name&gt;\n</code></pre></p> <p>L\u00f6sung: <pre><code># 1. Alle Agenten aus der Gruppe entfernen\n/var/ossec/bin/agent_groups -r -g &lt;group-name&gt;\n\n# 2. Manager stoppen\nsystemctl stop wazuh-manager\n\n# 3. Gruppe l\u00f6schen\nrm -rf /var/ossec/etc/shared/&lt;group-name&gt;\n\n# 4. Manager starten\nsystemctl start wazuh-manager\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#problem-arconf-befehle-funktionieren-nicht","title":"Problem: ar.conf Befehle funktionieren nicht","text":"<p>Symptom: <pre><code>Active Response Befehle werden nicht ausgef\u00fchrt\n</code></pre></p> <p>Diagnose: <pre><code># 1. ar.conf Syntax pr\u00fcfen\ncat /var/ossec/etc/shared/&lt;group-name&gt;/ar.conf\n\n# 2. Befehl auf Agent vorhanden?\n# (auf dem Agent-System)\nls -la /var/ossec/active-response/bin/\n\n# 3. Agent-Logs pr\u00fcfen\n# (auf dem Agent-System)\ntail -f /var/ossec/logs/active-responses.log\n</code></pre></p> <p>L\u00f6sung: <pre><code># 1. ar.conf korrigieren\nvi /var/ossec/etc/shared/&lt;group-name&gt;/ar.conf\n\n# 2. Berechtigungen setzen\nchmod 750 /var/ossec/active-response/bin/*\n\n# 3. Manager neu starten\nsystemctl restart wazuh-manager\n\n# 4. Agent-Synchronisation erzwingen\n/var/ossec/bin/agent_control -R &lt;agent-id&gt;\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#health-check-commands","title":"Health Check Commands","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#gruppen-status-uberprufen","title":"Gruppen-Status \u00fcberpr\u00fcfen","text":"<pre><code># Alle Gruppen mit Anzahl Agenten\n/var/ossec/bin/agent_groups -l\n\n# Spezifische Gruppe mit Details\n/var/ossec/bin/agent_groups -l -g &lt;group-name&gt;\n\n# Alle Agenten mit Gruppenzugeh\u00f6rigkeit\n/var/ossec/bin/manage_agents -l | grep -i \"group\"\n\n# Gruppen-Verzeichnisse pr\u00fcfen\nls -la /var/ossec/etc/shared/\n\n# Konfigurationsdateien pr\u00fcfen\nfind /var/ossec/etc/shared/ -name \"agent.conf\" -o -name \"ar.conf\" -o -name \"merged.mg\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#synchronisations-status","title":"Synchronisations-Status","text":"<pre><code># Agent-Verbindungsstatus\n/var/ossec/bin/agent_control -l\n\n# Letzte Agent-Synchronisation\n/var/ossec/bin/agent_control -i &lt;agent-id&gt;\n\n# Queue-Status\nls -la /var/ossec/queue/rids/\n\n# Manager-Logs f\u00fcr Gruppen-Events\ngrep -i \"group\" /var/ossec/logs/ossec.log | tail -n 50\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#nutzliche-scripts","title":"N\u00fctzliche Scripts","text":""},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#script-alle-agenten-einer-gruppe-auflisten","title":"Script: Alle Agenten einer Gruppe auflisten","text":"<pre><code>#!/bin/bash\n# list-group-agents.sh\n\nGROUP_NAME=\"$1\"\n\nif [ -z \"$GROUP_NAME\" ]; then\n    echo \"Usage: $0 &lt;group-name&gt;\"\n    exit 1\nfi\n\necho \"=== Agents in group: $GROUP_NAME ===\"\n/var/ossec/bin/manage_agents -l | grep \"Groups:.*$GROUP_NAME\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#script-gruppen-backup-erstellen","title":"Script: Gruppen-Backup erstellen","text":"<pre><code>#!/bin/bash\n# backup-groups.sh\n\nBACKUP_DIR=\"/backup/wazuh-groups\"\nTIMESTAMP=$(date +%F-%H%M%S)\n\nmkdir -p \"$BACKUP_DIR\"\n\ntar -czf \"$BACKUP_DIR/groups-backup-$TIMESTAMP.tar.gz\" \\\n    /var/ossec/etc/shared/\n\necho \"Backup created: $BACKUP_DIR/groups-backup-$TIMESTAMP.tar.gz\"\nls -lh \"$BACKUP_DIR/groups-backup-$TIMESTAMP.tar.gz\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#script-konfiguration-auf-alle-gruppen-anwenden","title":"Script: Konfiguration auf alle Gruppen anwenden","text":"<pre><code>#!/bin/bash\n# apply-config-to-all.sh\n\nCONFIG_FILE=\"$1\"\n\nif [ ! -f \"$CONFIG_FILE\" ]; then\n    echo \"Config file not found: $CONFIG_FILE\"\n    exit 1\nfi\n\nfor group_dir in /var/ossec/etc/shared/*/; do\n    group_name=$(basename \"$group_dir\")\n\n    if [ \"$group_name\" != \"default\" ]; then\n        echo \"Applying to: $group_name\"\n        cp \"$CONFIG_FILE\" \"$group_dir/agent.conf\"\n    fi\ndone\n\nsystemctl restart wazuh-manager\necho \"Configuration applied to all groups\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_AGENT_GROUP_MANAGEMENT/#weiterfuhrende-dokumentation","title":"Weiterf\u00fchrende Dokumentation","text":"<ul> <li>Wazuh Official Docs - Agent Groups: https://documentation.wazuh.com/current/user-manual/agent-enrollment/agent-enrollment.html</li> <li>Wazuh Official Docs - Centralized Configuration: https://documentation.wazuh.com/current/user-manual/reference/centralized-configuration.html</li> <li>Wazuh Official Docs - Active Response: https://documentation.wazuh.com/current/user-manual/capabilities/active-response/index.html</li> </ul> <p>Letzte Aktualisierung: 2026-02-17 N\u00e4chste Review: 2026-05-17 Verantwortlich: Security Operations Team</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/","title":"Managed SIEM (Wazuh) \u2013 Runbook Upgrade Central Components (Ubuntu AIO, APT)","text":"<p>Dokumenttyp: SOP / Runbook Geltungsbereich: Wazuh All-in-One auf Ubuntu (APT): Indexer, Manager, Dashboard, Filebeat Ziel: Reproduzierbar, auditierbar, operator-freundlich (Gates + klare Reihenfolge) Version: 1.3 Letzte Aktualisierung: Januar 2026 \u00c4nderungen: Nur via Pull Request (Review required)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#zweck-und-anwendungsbereich","title":"Zweck und Anwendungsbereich","text":"<p>Dieses Runbook beschreibt den vollst\u00e4ndigen Upgrade-Prozess f\u00fcr Wazuh Central Components auf einer Ubuntu All-in-One Installation mit umfassenden Validierungs- und Rollback-Verfahren.</p> <p>Wann zu verwenden: - Upgrade von Wazuh Indexer, Manager, Dashboard und Filebeat - F\u00fcr Ubuntu-basierte APT-Installationen - Bei geplanten Wartungsfenstern (nicht f\u00fcr Notfall-Patches) - Sowohl f\u00fcr Minor- als auch Major-Version-Upgrades</p> <p>Wichtige Hinweise: - Dieses Runbook ist auf den offiziellen Wazuh Upgrade Guide abgestimmt - Alle Schritte sind in der vorgegebenen Reihenfolge auszuf\u00fchren - Abweichungen vom Guide m\u00fcssen dokumentiert werden - Verwenden Sie die zugeh\u00f6rige Checkliste f\u00fcr die Ticket-Dokumentation - Planen Sie ausreichend Zeit ein (typisch 1-2 Stunden f\u00fcr kleinere Upgrades)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#verbindliche-referenz-guide","title":"Verbindliche Referenz (Guide)","text":"<ul> <li>https://documentation.wazuh.com/current/upgrade-guide/upgrading-central-components.html</li> <li>Offizielle Wazuh Dokumentation: https://documentation.wazuh.com/</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#zugehorige-checkliste","title":"Zugeh\u00f6rige Checkliste","text":"<ul> <li><code>../checklists/CHECKLIST_WAZUH_UPGRADE_AIO.md</code></li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#voraussetzungen","title":"Voraussetzungen","text":"<p>Vor Beginn des Upgrades m\u00fcssen folgende Voraussetzungen erf\u00fcllt sein:</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#technische-voraussetzungen","title":"Technische Voraussetzungen","text":"<ul> <li>Root- oder sudo-Zugriff auf den Wazuh AIO Server</li> <li>Aktive Internetverbindung f\u00fcr Paket-Downloads</li> <li>Ausreichend Speicherplatz (mindestens 20% frei auf allen relevanten Partitionen)</li> <li>G\u00fcltige Backup/Snapshot-L\u00f6sung verf\u00fcgbar</li> <li>Zugriff auf das Wazuh Dashboard und API f\u00fcr Validierung</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#organisatorische-voraussetzungen","title":"Organisatorische Voraussetzungen","text":"<ul> <li>Genehmigtes Change-Ticket/Change Request</li> <li>Kommunikation an betroffene Stakeholder/Kunden</li> <li>Definiertes Wartungsfenster mit ausreichend Zeitpuffer</li> <li>Dokumentierte Rollback-Strategie</li> <li>Notfallkontakte verf\u00fcgbar</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#wissensbasis","title":"Wissensbasis","text":"<ul> <li>Grundlegendes Verst\u00e4ndnis von Wazuh-Architektur</li> <li>Erfahrung mit Linux-Systemadministration (systemd, APT)</li> <li>Kenntnisse \u00fcber Elasticsearch/OpenSearch-Konzepte (Shards, Cluster-Health)</li> <li>Zugang zur Wazuh-Dokumentation</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#validierung-der-voraussetzungen","title":"Validierung der Voraussetzungen","text":"<p>F\u00fchren Sie folgende Checks durch, bevor Sie mit dem Upgrade beginnen:</p> <pre><code># System-Ressourcen pr\u00fcfen\ndf -h | egrep -v 'tmpfs|devtmpfs'  # Disk &lt; 85% belegt\nfree -h                             # RAM-Verf\u00fcgbarkeit\nuptime                              # System-Stabilit\u00e4t\n\n# Netzwerk-Konnektivit\u00e4t pr\u00fcfen\nping -c 3 packages.wazuh.com\nping -c 3 raw.githubusercontent.com\n\n# Aktuelle Services-Status pr\u00fcfen\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Aktuelle Versionen dokumentieren\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)|filebeat'\n</code></pre> <p>No-Go Kriterien: - Disk-Belegung &gt; 90% - Services nicht alle im Status \"active (running)\" - Keine Internetverbindung zu Wazuh Repositories - Cluster-Health = RED (falls Multi-Node)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#0-nicht-verhandelbare-regeln-upgrade","title":"0) Nicht verhandelbare Regeln (Upgrade)","text":"<ol> <li>Komponenten-Versionen m\u00fcssen identisch sein (inkl. Patchlevel):</li> <li><code>wazuh-indexer</code>, <code>wazuh-manager</code>, <code>wazuh-dashboard</code></li> <li>Manager-Version \u2265 Agent-Version (Agents k\u00f6nnen \u00e4lter sein, aber nicht neuer)</li> <li>Ohne Snapshot/Backup kein produktives Upgrade (Ausnahme: dokumentiertes Dev/Test-System)</li> <li>Upgrade gem\u00e4\u00df Guide inkl. Pre-/Post-Actions (Shard allocation, Flush, Security re-apply, etc.)</li> <li>Keine Default-Credentials in Produktion (Indexer API Calls m\u00fcssen die realen Credentials verwenden)</li> <li>Dokumentationspflicht: Pre- und Post-Health Snapshots im Change-Ticket erforderlich</li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#1-runbook-0-health-snapshot-immer-vor-und-nach-wartung","title":"1) Runbook 0 \u2013 Health Snapshot (immer VOR und NACH Wartung)","text":"<p>Zweck: in &lt; 5 Minuten einen auditierbaren Zustand erzeugen (copy/paste ins Ticket). WICHTIG: F\u00fchren Sie diesen Check sowohl VOR als auch NACH dem Upgrade aus!</p> <pre><code>set -euo pipefail\n\necho \"=== HEALTH SNAPSHOT START ===\"\necho \"Timestamp: $(date -Is)\"\necho \"Operator: ${USER}\"\n\necho \"\"\necho \"=== DATE/UPTIME ===\"\ndate -Is\nuptime\n\necho \"\"\necho \"=== DISK/MEM ===\"\ndf -h | egrep -v 'tmpfs|devtmpfs'\necho \"\"\nfree -h\n\necho \"\"\necho \"=== SERVICES STATUS ===\"\nsystemctl --no-pager -l status wazuh-indexer wazuh-manager wazuh-dashboard filebeat || true\n\necho \"\"\necho \"=== PORTS (sanity check) ===\"\nss -lntp | egrep '(:1514|:1515|:55000|:9200|:5601)\\s' || echo \"WARN: Not all expected ports listening\"\n\necho \"\"\necho \"=== INSTALLED PACKAGES ===\"\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard|agent)|filebeat' || true\n\necho \"\"\necho \"=== INDEXER CLUSTER HEALTH (if accessible) ===\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty 2&gt;/dev/null || echo \"INFO: Indexer not accessible or stopped\"\n\necho \"\"\necho \"=== INDEXER NODES (if accessible) ===\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/nodes?v 2&gt;/dev/null || echo \"INFO: Indexer not accessible or stopped\"\n\necho \"\"\necho \"=== RECENT ERRORS (last 50 lines per service) ===\"\necho \"--- wazuh-indexer ---\"\njournalctl -u wazuh-indexer -n 50 --no-pager -p err || true\necho \"--- wazuh-manager ---\"\njournalctl -u wazuh-manager -n 50 --no-pager -p err || true\necho \"--- wazuh-dashboard ---\"\njournalctl -u wazuh-dashboard -n 50 --no-pager -p err || true\necho \"--- filebeat ---\"\njournalctl -u filebeat -n 50 --no-pager -p err || true\n\necho \"\"\necho \"=== HEALTH SNAPSHOT END ===\"\n</code></pre> <p>Post-Execution: - Kopieren Sie die gesamte Ausgabe in Ihr Change-Ticket - Markieren Sie ob Pre- oder Post-Upgrade - Bei Post-Upgrade: Vergleichen Sie mit Pre-Upgrade Snapshot</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#2-upgrade-ablauf-central-components-aio","title":"2) Upgrade Ablauf (Central Components, AIO)","text":""},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#21-zielversion-prufen-und-dokumentieren","title":"2.1 Zielversion pr\u00fcfen und dokumentieren","text":"<p>No-Go wenn Versionen nicht identisch sind!</p> <pre><code>set -euo pipefail\napt-get update\n\necho \"=== Candidate versions ===\"\nINDEXER_VER=$(apt-cache policy wazuh-indexer | awk '/Candidate:/ {print $2}')\nMANAGER_VER=$(apt-cache policy wazuh-manager | awk '/Candidate:/ {print $2}')\nDASHBOARD_VER=$(apt-cache policy wazuh-dashboard | awk '/Candidate:/ {print $2}')\nFILEBEAT_VER=$(apt-cache policy filebeat | awk '/Candidate:/ {print $2}')\n\necho \"wazuh-indexer: $INDEXER_VER\"\necho \"wazuh-manager: $MANAGER_VER\"\necho \"wazuh-dashboard: $DASHBOARD_VER\"\necho \"filebeat: $FILEBEAT_VER\"\n\n# Versions-Konsistenz pr\u00fcfen\nif [ \"$INDEXER_VER\" != \"$MANAGER_VER\" ] || [ \"$INDEXER_VER\" != \"$DASHBOARD_VER\" ]; then\n    echo \"\"\n    echo \"ERROR: Wazuh component versions are NOT identical!\"\n    echo \"STOP: Do NOT proceed with upgrade until versions match.\"\n    exit 1\nfi\n\necho \"\"\necho \"OK: Wazuh component versions are identical: $INDEXER_VER\"\necho \"Target upgrade version: $INDEXER_VER\"\n</code></pre> <p>Dokumentieren Sie die Zielversion in Ihrem Change-Ticket!</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#22-backup-snapshot-pflicht-fur-produktion","title":"2.2 Backup / Snapshot (Pflicht f\u00fcr Produktion)","text":"<p>Standard-Methode: VM-/Volume-Snapshot (empfohlen vor Dienste-Stop) Zus\u00e4tzlich empfohlen: Konfigurations-Backup f\u00fcr schnelle Wiederherstellung</p> <pre><code>set -euo pipefail\nBACKUP_DIR=\"/root/wazuh_backup_$(date +%F_%H%M%S)\"\nmkdir -p \"$BACKUP_DIR\"\n\necho \"Creating configuration backup in $BACKUP_DIR\"\n\n# Kritische Konfigurationsdateien sichern\ntar -czf \"$BACKUP_DIR/var_ossec_etc.tgz\" /var/ossec/etc 2&gt;/dev/null || echo \"WARN: Failed to backup /var/ossec/etc\"\ntar -czf \"$BACKUP_DIR/wazuh_indexer_etc.tgz\" /etc/wazuh-indexer 2&gt;/dev/null || echo \"WARN: Failed to backup /etc/wazuh-indexer\"\ntar -czf \"$BACKUP_DIR/wazuh_dashboard_etc.tgz\" /etc/wazuh-dashboard 2&gt;/dev/null || echo \"WARN: Failed to backup /etc/wazuh-dashboard\"\ntar -czf \"$BACKUP_DIR/filebeat_etc.tgz\" /etc/filebeat 2&gt;/dev/null || echo \"WARN: Failed to backup /etc/filebeat\"\n\n# Zus\u00e4tzliche wichtige Dateien\ncp /etc/wazuh-indexer/jvm.options \"$BACKUP_DIR/indexer_jvm.options.backup\" 2&gt;/dev/null || true\ncp /etc/filebeat/filebeat.yml \"$BACKUP_DIR/filebeat.yml.backup\" 2&gt;/dev/null || true\ncp /etc/wazuh-dashboard/opensearch_dashboards.yml \"$BACKUP_DIR/opensearch_dashboards.yml.backup\" 2&gt;/dev/null || true\n\n# Backup-Inventar erstellen\necho \"Backup created at: $(date -Is)\" &gt; \"$BACKUP_DIR/backup_info.txt\"\necho \"Hostname: $(hostname)\" &gt;&gt; \"$BACKUP_DIR/backup_info.txt\"\necho \"Packages before upgrade:\" &gt;&gt; \"$BACKUP_DIR/backup_info.txt\"\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)|filebeat' &gt;&gt; \"$BACKUP_DIR/backup_info.txt\"\n\necho \"\"\necho \"Backup completed successfully!\"\necho \"Backup location: $BACKUP_DIR\"\nls -lah \"$BACKUP_DIR\"\n\n# Backup-Pfad f\u00fcr Rollback dokumentieren\necho \"\"\necho \"IMPORTANT: Document this backup path in your change ticket!\"\necho \"Backup path: $BACKUP_DIR\"\n</code></pre> <p>Validierung: <pre><code># Pr\u00fcfen Sie, dass alle wichtigen Backups erstellt wurden\nls -lh \"$BACKUP_DIR\"\n# Mindestens 4 .tgz Dateien sollten vorhanden sein\n</code></pre></p> <p>F\u00fcr VM-Snapshot (empfohlen): - Erstellen Sie vor dem n\u00e4chsten Schritt einen VM-Snapshot \u00fcber Ihre Virtualisierungsplattform - Dokumentieren Sie die Snapshot-ID im Change-Ticket - Snapshot sollte erstellt werden, w\u00e4hrend Services noch laufen (konsistenter Zustand)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#23-controlled-stop-guide-minimum","title":"2.3 Controlled Stop (Guide-Minimum)","text":"<p>Zweck: Dienste in korrekter Reihenfolge stoppen, um Datenverlust zu vermeiden</p> <pre><code>set -euo pipefail\n\necho \"Stopping services in correct order...\"\n\n# Filebeat zuerst stoppen (verhindert neue Events an Indexer)\necho \"Stopping filebeat...\"\nsystemctl stop filebeat\nsystemctl status filebeat --no-pager || true\n\n# Dashboard stoppen (UI wird nicht mehr erreichbar sein)\necho \"Stopping wazuh-dashboard...\"\nsystemctl stop wazuh-dashboard\nsystemctl status wazuh-dashboard --no-pager || true\n\necho \"\"\necho \"Services stopped successfully.\"\necho \"IMPORTANT: Manager and Indexer are still running for pre-upgrade actions.\"\n</code></pre> <p>Erwartetes Ergebnis: - filebeat: inactive (dead) - wazuh-dashboard: inactive (dead) - wazuh-manager: active (running) - wird sp\u00e4ter gestoppt - wazuh-indexer: active (running) - wird sp\u00e4ter gestoppt</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#3-indexer-pre-actions-guide","title":"3) Indexer Pre-Actions (Guide)","text":"<p>Wichtig: Credentials/PKI je Umgebung anpassen. KEINE Default-Credentials in Produktion verwenden! Hinweis: Ersetzen Sie <code>admin:admin</code> mit den tats\u00e4chlichen Indexer-Credentials aus Ihrem Secret-Store.</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#31-security-config-backup-indexer","title":"3.1 Security Config Backup (Indexer)","text":"<pre><code>set -euo pipefail\n\necho \"Backing up Indexer security configuration...\"\n/usr/share/wazuh-indexer/bin/indexer-security-init.sh --options \"-backup /etc/wazuh-indexer/opensearch-security -icl -nhnv\"\n\n# Validierung\nif [ -d \"/etc/wazuh-indexer/opensearch-security\" ]; then\n    echo \"Security config backup created successfully\"\n    ls -lah /etc/wazuh-indexer/opensearch-security/\nelse\n    echo \"ERROR: Security config backup failed!\"\n    exit 1\nfi\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#32-shard-allocation-auf-primaries-setzen","title":"3.2 Shard Allocation auf <code>primaries</code> setzen","text":"<p>Zweck: Verhindert Shard-Reallocation w\u00e4hrend des Upgrades (spart Netzwerk-Traffic und Zeit)</p> <pre><code>set -euo pipefail\n\n# WICHTIG: Ersetzen Sie admin:admin mit Ihren echten Credentials!\nINDEXER_USER=\"admin\"\nINDEXER_PASS=\"admin\"  # CHANGE THIS!\n\necho \"Setting shard allocation to primaries...\"\nRESPONSE=$(curl -X PUT \"https://127.0.0.1:9200/_cluster/settings\" \\\n  -u \"$INDEXER_USER:$INDEXER_PASS\" -k \\\n  -H 'Content-Type: application/json' -d'\n{\n  \"persistent\": { \"cluster.routing.allocation.enable\": \"primaries\" }\n}\n' 2&gt;/dev/null)\n\necho \"Response: $RESPONSE\"\n\n# Validierung\nCURRENT_SETTING=$(curl -s -u \"$INDEXER_USER:$INDEXER_PASS\" -k \\\n  \"https://127.0.0.1:9200/_cluster/settings?include_defaults=true&amp;filter_path=**.cluster.routing.allocation.enable\" 2&gt;/dev/null)\necho \"Current allocation setting: $CURRENT_SETTING\"\n</code></pre> <p>Erwartetes Ergebnis:  - Response sollte <code>{\"acknowledged\":true}</code> enthalten - Shard allocation ist jetzt auf \"primaries\" gesetzt</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#33-flush-ausfuhren","title":"3.3 Flush ausf\u00fchren","text":"<p>Zweck: Stellt sicher, dass alle Daten aus dem Memory auf Disk geschrieben werden</p> <pre><code>set -euo pipefail\n\n# WICHTIG: Ersetzen Sie admin:admin mit Ihren echten Credentials!\nINDEXER_USER=\"admin\"\nINDEXER_PASS=\"admin\"  # CHANGE THIS!\n\necho \"Flushing all indices...\"\nRESPONSE=$(curl -X POST \"https://127.0.0.1:9200/_flush\" \\\n  -u \"$INDEXER_USER:$INDEXER_PASS\" -k 2&gt;/dev/null)\n\necho \"Flush response: $RESPONSE\"\n\n# Zus\u00e4tzlich: Synced Flush f\u00fcr bessere Konsistenz\necho \"Performing synced flush...\"\ncurl -X POST \"https://127.0.0.1:9200/_flush/synced\" \\\n  -u \"$INDEXER_USER:$INDEXER_PASS\" -k 2&gt;/dev/null || echo \"INFO: Synced flush partially failed (acceptable)\"\n</code></pre> <p>Erwartetes Ergebnis: - Flush sollte erfolgreich sein - Synced flush kann teilweise fehlschlagen (ist akzeptabel)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#34-manager-stoppen-insb-single-node-indexer-cluster","title":"3.4 Manager stoppen (insb. single-node Indexer Cluster)","text":"<p>Zweck: Verhindert neue Daten w\u00e4hrend Indexer-Upgrade</p> <pre><code>set -euo pipefail\n\necho \"Stopping wazuh-manager...\"\nsystemctl stop wazuh-manager\n\n# Validierung\nsleep 2\nsystemctl status wazuh-manager --no-pager || true\n\n# Pr\u00fcfen, ob Manager-Prozesse wirklich gestoppt sind\nMANAGER_PROCS=$(pgrep -f wazuh-manager || true)\nif [ -z \"$MANAGER_PROCS\" ]; then\n    echo \"OK: wazuh-manager stopped successfully\"\nelse\n    echo \"WARN: Manager processes still running: $MANAGER_PROCS\"\n    echo \"Waiting additional 5 seconds...\"\n    sleep 5\nfi\n</code></pre> <p>Erwartetes Ergebnis: - wazuh-manager: inactive (dead) - Keine wazuh-manager Prozesse mehr vorhanden</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#4-indexer-upgrade-guide","title":"4) Indexer Upgrade (Guide)","text":"<pre><code>set -euo pipefail\n\necho \"=== Indexer Upgrade Start ===\"\n\n# Indexer stoppen\necho \"Stopping wazuh-indexer...\"\nsystemctl stop wazuh-indexer\nsleep 3\n\n# Status validieren\nsystemctl status wazuh-indexer --no-pager || true\n\n# JVM Settings sichern (f\u00fcr Vergleich und Rollback)\necho \"Backing up JVM settings...\"\ncp /etc/wazuh-indexer/jvm.options /etc/wazuh-indexer/jvm.options.pre-upgrade\n\n# Aktuelle Version dokumentieren\necho \"Current version before upgrade:\"\ndpkg -l | grep wazuh-indexer\n\n# Upgrade durchf\u00fchren\necho \"Installing wazuh-indexer upgrade...\"\napt-get install -y wazuh-indexer\n\n# Neue Version dokumentieren\necho \"New version after upgrade:\"\ndpkg -l | grep wazuh-indexer\n\n# JVM Settings vergleichen (manuell pr\u00fcfen ob Anpassungen \u00fcbernommen wurden)\necho \"Comparing JVM settings (old vs new)...\"\nif diff /etc/wazuh-indexer/jvm.options.pre-upgrade /etc/wazuh-indexer/jvm.options; then\n    echo \"INFO: JVM settings unchanged\"\nelse\n    echo \"WARN: JVM settings have changed - review if custom settings need to be reapplied\"\n    echo \"See: /etc/wazuh-indexer/jvm.options.pre-upgrade for old settings\"\nfi\n\n# Service neu laden und starten\necho \"Reloading systemd and starting wazuh-indexer...\"\nsystemctl daemon-reload\nsystemctl enable wazuh-indexer\nsystemctl start wazuh-indexer\n\n# Auf Startup warten\necho \"Waiting for indexer to start (up to 60 seconds)...\"\nfor i in {1..60}; do\n    if systemctl is-active --quiet wazuh-indexer; then\n        echo \"Indexer started after $i seconds\"\n        break\n    fi\n    sleep 1\ndone\n\n# Status pr\u00fcfen\nsystemctl --no-pager -l status wazuh-indexer\n\necho \"=== Indexer Upgrade Complete ===\"\n</code></pre> <p>Triage bei Start-Fehlern: <pre><code># Detaillierte Logs anzeigen\njournalctl -u wazuh-indexer -n 300 --no-pager\n\n# Indexer-spezifische Logs\nls -lah /var/log/wazuh-indexer/\ntail -n 100 /var/log/wazuh-indexer/wazuh-cluster.log\n\n# H\u00e4ufige Probleme:\n# - JVM heap size zu gro\u00df/klein\n# - Fehlende Berechtigungen\n# - Port bereits belegt\n# - Disk voll\n</code></pre></p> <p>Plugins Validierung: <pre><code># Installierte Plugins auflisten\n/usr/share/wazuh-indexer/bin/opensearch-plugin list\n\n# Erwartete Plugins sollten vorhanden sein\n# Falls manuell installierte Plugins vorhanden waren, diese ggf. neu installieren\n</code></pre></p> <p>Cluster-Health Check (vor Post-Actions): <pre><code># WICHTIG: Credentials anpassen!\ncurl -k -u admin:admin https://127.0.0.1:9200/_cat/health?v\n\n# Erwartetes Ergebnis: status = yellow (single node) oder green (multi-node)\n# RED = kritisches Problem, nicht fortfahren!\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#5-indexer-post-actions-guide","title":"5) Indexer Post-Actions (Guide)","text":"<p>Zweck: Security-Konfiguration reaktivieren und normale Cluster-Operationen wiederherstellen</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#51-security-erneut-anwenden","title":"5.1 Security erneut anwenden","text":"<pre><code>set -euo pipefail\n\necho \"Re-applying indexer security configuration...\"\n/usr/share/wazuh-indexer/bin/indexer-security-init.sh\n\n# Validierung: Security-Zugriff testen\nsleep 5\necho \"Testing indexer access...\"\n# WICHTIG: Credentials anpassen!\ncurl -sk -u admin:admin https://127.0.0.1:9200/ | head -20\n\nif [ $? -eq 0 ]; then\n    echo \"OK: Indexer security applied successfully\"\nelse\n    echo \"ERROR: Cannot access indexer after security init!\"\n    exit 1\nfi\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#52-nodes-und-cluster-status-prufen","title":"5.2 Nodes und Cluster-Status pr\u00fcfen","text":"<pre><code>set -euo pipefail\n\n# WICHTIG: Credentials anpassen!\nINDEXER_USER=\"admin\"\nINDEXER_PASS=\"admin\"  # CHANGE THIS!\n\necho \"=== Cluster Health ===\"\ncurl -k -u \"$INDEXER_USER:$INDEXER_PASS\" https://127.0.0.1:9200/_cat/health?v\n\necho \"\"\necho \"=== Nodes List ===\"\ncurl -k -u \"$INDEXER_USER:$INDEXER_PASS\" https://127.0.0.1:9200/_cat/nodes?v\n\necho \"\"\necho \"=== Indices Overview ===\"\ncurl -k -u \"$INDEXER_USER:$INDEXER_PASS\" https://127.0.0.1:9200/_cat/indices?v | head -20\n</code></pre> <p>Erwartetes Ergebnis: - Cluster status: green (multi-node) oder yellow (single-node AIO - akzeptabel) - Node sollte in der Liste erscheinen - Indices sollten sichtbar sein</p> <p>No-Go Kriterium: - Cluster status: RED \u2192 Upgrade abbrechen und Rollback durchf\u00fchren!</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#53-shard-allocation-wieder-aktivieren","title":"5.3 Shard Allocation wieder aktivieren","text":"<p>Zweck: Normale Shard-Operationen wiederherstellen</p> <pre><code>set -euo pipefail\n\n# WICHTIG: Credentials anpassen!\nINDEXER_USER=\"admin\"\nINDEXER_PASS=\"admin\"  # CHANGE THIS!\n\necho \"Restoring shard allocation to 'all'...\"\nRESPONSE=$(curl -X PUT \"https://127.0.0.1:9200/_cluster/settings\" \\\n  -u \"$INDEXER_USER:$INDEXER_PASS\" -k \\\n  -H 'Content-Type: application/json' -d'\n{\n  \"persistent\": { \"cluster.routing.allocation.enable\": \"all\" }\n}\n' 2&gt;/dev/null)\n\necho \"Response: $RESPONSE\"\n\n# Validierung\necho \"Verifying shard allocation setting...\"\nCURRENT_SETTING=$(curl -s -u \"$INDEXER_USER:$INDEXER_PASS\" -k \\\n  \"https://127.0.0.1:9200/_cluster/settings?include_defaults=true&amp;filter_path=**.cluster.routing.allocation.enable\" 2&gt;/dev/null)\necho \"Current allocation setting: $CURRENT_SETTING\"\n\n# Kurz warten und erneut Cluster-Health pr\u00fcfen\nsleep 5\necho \"\"\necho \"=== Cluster Health After Allocation Restore ===\"\ncurl -k -u \"$INDEXER_USER:$INDEXER_PASS\" https://127.0.0.1:9200/_cat/health?v\n</code></pre> <p>Erwartetes Ergebnis: - Shard allocation = \"all\" - Cluster sollte stabil bleiben (yellow oder green)</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#6-manager-upgrade-guide","title":"6) Manager Upgrade (Guide)","text":"<pre><code>set -euo pipefail\n\necho \"=== Manager Upgrade Start ===\"\n\n# Aktuelle Version dokumentieren\necho \"Current version before upgrade:\"\ndpkg -l | grep wazuh-manager\n\n# Upgrade durchf\u00fchren\necho \"Installing wazuh-manager upgrade...\"\napt-get install -y wazuh-manager\n\n# Neue Version dokumentieren\necho \"New version after upgrade:\"\ndpkg -l | grep wazuh-manager\n\n# Service neu laden und starten\necho \"Reloading systemd and starting wazuh-manager...\"\nsystemctl daemon-reload\nsystemctl enable wazuh-manager\nsystemctl start wazuh-manager\n\n# Auf Startup warten\necho \"Waiting for manager to start (up to 30 seconds)...\"\nfor i in {1..30}; do\n    if systemctl is-active --quiet wazuh-manager; then\n        echo \"Manager started after $i seconds\"\n        break\n    fi\n    sleep 1\ndone\n\n# Status pr\u00fcfen\nsystemctl --no-pager -l status wazuh-manager\n\necho \"=== Manager Upgrade Complete ===\"\n</code></pre> <p>Triage bei Problemen: <pre><code># Systemd Journal\njournalctl -u wazuh-manager -n 300 --no-pager\n\n# Wazuh-spezifische Logs\ntail -n 200 /var/ossec/logs/ossec.log\n\n# Manager-Prozesse pr\u00fcfen\nps aux | grep wazuh\n\n# H\u00e4ufige Probleme:\n# - Konfigurationsfehler in ossec.conf\n# - Fehlende Berechtigungen auf /var/ossec\n# - Indexer nicht erreichbar (wird Manager starten aber warnings loggen)\n</code></pre></p> <p>Validierung: <pre><code># Manager-Version pr\u00fcfen\n/var/ossec/bin/wazuh-control info\n\n# API-Status pr\u00fcfen (falls konfiguriert)\ncurl -k https://127.0.0.1:55000/ || echo \"INFO: API not yet accessible\"\n\n# Active Agents pr\u00fcfen (sollte nach einigen Minuten wieder Agents zeigen)\n/var/ossec/bin/agent_control -l 2&gt;/dev/null || echo \"INFO: Waiting for agents to reconnect\"\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#7-filebeat-updatesetup-guide","title":"7) Filebeat Update/Setup (Guide)","text":"<p>Ziel: Wazuh Module + Template + Pipelines/Index-Management auf Zielversion aktualisieren.</p> <pre><code>set -euo pipefail\n\necho \"=== Filebeat Update Start ===\"\n\n# Zielversion ermitteln\nTARGET_WAZUH_VERSION=\"$(apt-cache policy wazuh-manager | awk '/Installed:/ {print $2}' | cut -d- -f1)\"\necho \"Target Wazuh version for Filebeat module: $TARGET_WAZUH_VERSION\"\n\n# Wazuh Filebeat Module installieren/aktualisieren\necho \"Downloading and installing Wazuh Filebeat module...\"\ncurl -s https://packages.wazuh.com/4.x/filebeat/wazuh-filebeat-0.5.tar.gz \\\n  | tar -xvz -C /usr/share/filebeat/module\n\n# Validate module installation\nif [ -d \"/usr/share/filebeat/module/wazuh\" ]; then\n    echo \"OK: Wazuh Filebeat module installed\"\n    ls -lah /usr/share/filebeat/module/wazuh/\nelse\n    echo \"ERROR: Failed to install Wazuh Filebeat module!\"\n    exit 1\nfi\n\n# Template passend zur Zielversion laden\necho \"Downloading Wazuh template for version $TARGET_WAZUH_VERSION...\"\ncurl -so /etc/filebeat/wazuh-template.json \\\n  \"https://raw.githubusercontent.com/wazuh/wazuh/v${TARGET_WAZUH_VERSION}/extensions/elasticsearch/7.x/wazuh-template.json\"\n\n# Validate template download\nif [ -f \"/etc/filebeat/wazuh-template.json\" ]; then\n    chmod go+r /etc/filebeat/wazuh-template.json\n    echo \"OK: Wazuh template downloaded\"\n    ls -lh /etc/filebeat/wazuh-template.json\nelse\n    echo \"WARN: Failed to download Wazuh template - proceeding with existing template\"\nfi\n\n# Filebeat Config sichern\necho \"Backing up Filebeat configuration...\"\ncp /etc/filebeat/filebeat.yml /etc/filebeat/filebeat.yml.pre-upgrade\n\n# Aktuelle Version dokumentieren\necho \"Current Filebeat version:\"\ndpkg -l | grep filebeat\n\n# Filebeat upgraden\necho \"Installing Filebeat upgrade...\"\napt-get install -y filebeat\n\n# Config wiederherstellen (apt k\u00f6nnte sie \u00fcberschrieben haben)\necho \"Restoring Filebeat configuration...\"\ncp /etc/filebeat/filebeat.yml.pre-upgrade /etc/filebeat/filebeat.yml\n\n# Neue Version dokumentieren\necho \"New Filebeat version:\"\ndpkg -l | grep filebeat\n\n# Service neu laden und starten\necho \"Reloading systemd and starting filebeat...\"\nsystemctl daemon-reload\nsystemctl enable filebeat\nsystemctl start filebeat\n\n# Auf Startup warten\nsleep 5\nsystemctl --no-pager -l status filebeat\n\n# Pipelines laden\necho \"Loading Filebeat pipelines...\"\nfilebeat setup --pipelines\n\n# Index-Management laden\necho \"Loading Filebeat index management...\"\nfilebeat setup --index-management -E output.logstash.enabled=false\n\necho \"=== Filebeat Update Complete ===\"\n</code></pre> <p>Triage bei Problemen: <pre><code># Filebeat Logs\njournalctl -u filebeat -n 300 --no-pager\n\n# Filebeat Test Config\nfilebeat test config -e\n\n# Filebeat Test Output\nfilebeat test output -e\n\n# H\u00e4ufige Probleme:\n# - Indexer nicht erreichbar\n# - Falsche Credentials in filebeat.yml\n# - Template-Upload fehlgeschlagen\n# - Pipeline-Setup Fehler\n</code></pre></p> <p>Validierung: <pre><code># Filebeat Status\nsystemctl status filebeat\n\n# Pr\u00fcfen ob Events ankommen (nach ein paar Minuten)\n# WICHTIG: Credentials anpassen!\ncurl -sk -u admin:admin 'https://127.0.0.1:9200/wazuh-alerts-*/_search?size=1&amp;sort=@timestamp:desc' | head -50\n\n# Erwartetes Ergebnis: Aktuelle Events sollten sichtbar sein\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#8-dashboard-upgrade-guide","title":"8) Dashboard Upgrade (Guide)","text":"<pre><code>set -euo pipefail\n\necho \"=== Dashboard Upgrade Start ===\"\n\n# Dashboard Config sichern\necho \"Backing up Dashboard configuration...\"\ncp /etc/wazuh-dashboard/opensearch_dashboards.yml /etc/wazuh-dashboard/opensearch_dashboards.yml.pre-upgrade\n\n# Aktuelle Version dokumentieren\necho \"Current Dashboard version:\"\ndpkg -l | grep wazuh-dashboard\n\n# Upgrade durchf\u00fchren\necho \"Installing wazuh-dashboard upgrade...\"\napt-get install -y wazuh-dashboard\n\n# Neue Version dokumentieren\necho \"New Dashboard version:\"\ndpkg -l | grep wazuh-dashboard\n\n# Config vergleichen (pr\u00fcfen ob Anpassungen n\u00f6tig sind)\necho \"Comparing Dashboard configuration (old vs new)...\"\nif diff /etc/wazuh-dashboard/opensearch_dashboards.yml.pre-upgrade /etc/wazuh-dashboard/opensearch_dashboards.yml; then\n    echo \"INFO: Dashboard config unchanged\"\nelse\n    echo \"WARN: Dashboard config has changed - review if custom settings need to be reapplied\"\n    echo \"See: /etc/wazuh-dashboard/opensearch_dashboards.yml.pre-upgrade for old settings\"\nfi\n\n# Service neu laden und starten\necho \"Reloading systemd and starting wazuh-dashboard...\"\nsystemctl daemon-reload\nsystemctl enable wazuh-dashboard\nsystemctl start wazuh-dashboard\n\n# Auf Startup warten (Dashboard kann l\u00e4nger brauchen)\necho \"Waiting for dashboard to start (up to 60 seconds)...\"\nfor i in {1..60}; do\n    if systemctl is-active --quiet wazuh-dashboard; then\n        echo \"Dashboard started after $i seconds\"\n        break\n    fi\n    sleep 1\ndone\n\n# Status pr\u00fcfen\nsystemctl --no-pager -l status wazuh-dashboard\n\necho \"=== Dashboard Upgrade Complete ===\"\n</code></pre> <p>Plugins Validierung (falls manuell installiert): <pre><code># Installierte Plugins auflisten\nsudo -u wazuh-dashboard /usr/share/wazuh-dashboard/bin/opensearch-dashboards-plugin list\n\n# Falls manuell installierte Plugins vorhanden waren:\n# Diese m\u00fcssen m\u00f6glicherweise neu installiert werden, kompatibel zur neuen Version\n</code></pre></p> <p>Dashboard Erreichbarkeit testen: <pre><code># Port-Check\nss -lntp | grep :5601\n\n# HTTP-Zugriff testen (sollte zu Login-Seite umleiten)\ncurl -I http://127.0.0.1:5601 2&gt;&amp;1 | head -10\n\n# HTTPS-Zugriff testen (falls konfiguriert)\ncurl -k -I https://127.0.0.1:5601 2&gt;&amp;1 | head -10\n</code></pre></p> <p>Triage bei Problemen: <pre><code># Dashboard Logs\njournalctl -u wazuh-dashboard -n 300 --no-pager\n\n# Dashboard-spezifische Logs\nls -lah /var/log/wazuh-dashboard/\ntail -n 100 /var/log/wazuh-dashboard/opensearch_dashboards.log\n\n# H\u00e4ufige Probleme:\n# - Indexer nicht erreichbar\n# - Port 5601 bereits belegt\n# - Fehlende Berechtigungen\n# - Config-Fehler in opensearch_dashboards.yml\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#9-post-upgrade-validierung-und-abnahme","title":"9) Post-Upgrade Validierung und Abnahme","text":""},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#91-versionen-verifizieren","title":"9.1 Versionen verifizieren","text":"<p>Zweck: Sicherstellen, dass alle Komponenten erfolgreich aktualisiert wurden</p> <pre><code>set -euo pipefail\n\necho \"=== Installed Versions After Upgrade ===\"\necho \"\"\necho \"Wazuh Indexer:\"\napt list --installed wazuh-indexer 2&gt;/dev/null | grep wazuh-indexer\n\necho \"\"\necho \"Wazuh Manager:\"\napt list --installed wazuh-manager 2&gt;/dev/null | grep wazuh-manager\n/var/ossec/bin/wazuh-control info 2&gt;/dev/null || true\n\necho \"\"\necho \"Wazuh Dashboard:\"\napt list --installed wazuh-dashboard 2&gt;/dev/null | grep wazuh-dashboard\n\necho \"\"\necho \"Filebeat:\"\napt list --installed filebeat 2&gt;/dev/null | grep filebeat\n\necho \"\"\necho \"=== Version Consistency Check ===\"\nINDEXER_VER=$(dpkg -l | awk '/wazuh-indexer/ {print $3}')\nMANAGER_VER=$(dpkg -l | awk '/wazuh-manager/ {print $3}')\nDASHBOARD_VER=$(dpkg -l | awk '/wazuh-dashboard/ {print $3}')\n\nif [ \"$INDEXER_VER\" = \"$MANAGER_VER\" ] &amp;&amp; [ \"$INDEXER_VER\" = \"$DASHBOARD_VER\" ]; then\n    echo \"OK: All Wazuh components are on the same version: $INDEXER_VER\"\nelse\n    echo \"ERROR: Version mismatch detected!\"\n    echo \"Indexer: $INDEXER_VER\"\n    echo \"Manager: $MANAGER_VER\"\n    echo \"Dashboard: $DASHBOARD_VER\"\nfi\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#92-services-health-check","title":"9.2 Services Health Check","text":"<p>Zweck: Alle Services m\u00fcssen aktiv und fehlerfrei laufen</p> <pre><code>set -euo pipefail\n\necho \"=== Services Status Check ===\"\necho \"\"\n\n# Funktion f\u00fcr Service-Check mit Exit-Code\ncheck_service() {\n    SERVICE=$1\n    echo \"Checking $SERVICE...\"\n    if systemctl is-active --quiet $SERVICE; then\n        echo \"\u2713 $SERVICE is active\"\n        return 0\n    else\n        echo \"\u2717 $SERVICE is NOT active!\"\n        systemctl status $SERVICE --no-pager || true\n        return 1\n    fi\n}\n\n# Alle Services pr\u00fcfen\nFAILED=0\ncheck_service wazuh-indexer || FAILED=1\ncheck_service wazuh-manager || FAILED=1\ncheck_service wazuh-dashboard || FAILED=1\ncheck_service filebeat || FAILED=1\n\necho \"\"\nif [ $FAILED -eq 0 ]; then\n    echo \"OK: All services are running\"\nelse\n    echo \"ERROR: One or more services are not running!\"\n    exit 1\nfi\n\n# Ports-Check\necho \"\"\necho \"=== Ports Listening Check ===\"\nss -lntp | egrep '(:1514|:1515|:55000|:9200|:5601)\\s'\n\nREQUIRED_PORTS=(\"1514\" \"1515\" \"55000\" \"9200\" \"5601\")\nfor PORT in \"${REQUIRED_PORTS[@]}\"; do\n    if ss -lntp | grep -q \":$PORT \"; then\n        echo \"\u2713 Port $PORT is listening\"\n    else\n        echo \"\u2717 Port $PORT is NOT listening!\"\n        FAILED=1\n    fi\ndone\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#93-funktionale-validierung","title":"9.3 Funktionale Validierung","text":"<p>Zweck: Sicherstellen, dass alle Komponenten funktional arbeiten</p> <pre><code>set -euo pipefail\n\n# WICHTIG: Credentials anpassen!\nINDEXER_USER=\"admin\"\nINDEXER_PASS=\"admin\"  # CHANGE THIS!\n\necho \"=== Functional Validation ===\"\necho \"\"\n\n# 1. Indexer Cluster Health\necho \"1. Indexer Cluster Health:\"\nCLUSTER_HEALTH=$(curl -sk -u \"$INDEXER_USER:$INDEXER_PASS\" \\\n  'https://127.0.0.1:9200/_cluster/health' | grep -o '\"status\":\"[^\"]*\"')\necho \"$CLUSTER_HEALTH\"\n\nif echo \"$CLUSTER_HEALTH\" | grep -q \"green\\|yellow\"; then\n    echo \"\u2713 Cluster health is acceptable\"\nelse\n    echo \"\u2717 Cluster health is RED or unavailable!\"\n    exit 1\nfi\n\n# 2. Indices pr\u00fcfen\necho \"\"\necho \"2. Active Indices:\"\ncurl -sk -u \"$INDEXER_USER:$INDEXER_PASS\" \\\n  'https://127.0.0.1:9200/_cat/indices?v' | head -10\n\n# 3. Neueste Events pr\u00fcfen\necho \"\"\necho \"3. Recent Events (last 5 minutes):\"\nRECENT_EVENTS=$(curl -sk -u \"$INDEXER_USER:$INDEXER_PASS\" \\\n  'https://127.0.0.1:9200/wazuh-alerts-*/_count?q=timestamp:[now-5m TO now]' 2&gt;/dev/null)\necho \"$RECENT_EVENTS\"\n\nif echo \"$RECENT_EVENTS\" | grep -q '\"count\":[0-9]'; then\n    echo \"\u2713 Events are being indexed\"\nelse\n    echo \"\u26a0 No recent events found (may be normal if no activity)\"\nfi\n\n# 4. Manager API Check (falls konfiguriert)\necho \"\"\necho \"4. Wazuh Manager API:\"\nAPI_STATUS=$(curl -sk https://127.0.0.1:55000/ 2&gt;&amp;1)\nif echo \"$API_STATUS\" | grep -q \"Unauthorized\\|wazuh\"; then\n    echo \"\u2713 Manager API is responding\"\nelse\n    echo \"\u26a0 Manager API not responding (check if configured)\"\nfi\n\n# 5. Dashboard Zugriff\necho \"\"\necho \"5. Dashboard Accessibility:\"\nDASHBOARD_STATUS=$(curl -I http://127.0.0.1:5601 2&gt;&amp;1 | head -1)\necho \"$DASHBOARD_STATUS\"\nif echo \"$DASHBOARD_STATUS\" | grep -q \"200\\|302\"; then\n    echo \"\u2713 Dashboard is accessible\"\nelse\n    echo \"\u2717 Dashboard is not accessible!\"\nfi\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#94-datenfluss-test-empfohlen","title":"9.4 Datenfluss-Test (Empfohlen)","text":"<p>Zweck: Verifizieren, dass neue Events verarbeitet werden</p> <pre><code># Test-Event generieren (auf einem \u00fcberwachten System)\necho \"Creating test event...\"\nlogger -t WAZUH_UPGRADE_TEST \"Upgrade validation test event - $(date -Is)\"\n\n# Warten auf Event-Verarbeitung\necho \"Waiting 60 seconds for event processing...\"\nsleep 60\n\n# Test-Event im Indexer suchen\n# WICHTIG: Credentials anpassen!\necho \"Searching for test event...\"\ncurl -sk -u admin:admin \\\n  'https://127.0.0.1:9200/wazuh-alerts-*/_search?q=WAZUH_UPGRADE_TEST&amp;size=1' | grep -o '\"_id\":\"[^\"]*\"' || echo \"Test event not found (may need more time)\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#95-post-health-snapshot-ausfuhren","title":"9.5 Post-Health Snapshot ausf\u00fchren","text":"<p>Zweck: Dokumentation des erfolgreichen Upgrade-Zustands</p> <pre><code># F\u00fchren Sie Runbook 0 (Health Snapshot) erneut aus\n# und f\u00fcgen Sie die Ausgabe dem Change-Ticket hinzu\n\necho \"EXECUTE RUNBOOK 0 (Section 1) NOW FOR POST-UPGRADE SNAPSHOT\"\necho \"Mark the output as 'POST-UPGRADE HEALTH SNAPSHOT' in your ticket\"\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#96-abnahmekriterien-minimum-fur-produktions-freigabe","title":"9.6 Abnahmekriterien (Minimum f\u00fcr Produktions-Freigabe)","text":"<p>Alle folgenden Kriterien M\u00dcSSEN erf\u00fcllt sein:</p> <ul> <li> Alle Wazuh-Komponenten haben identische Versionen (Indexer, Manager, Dashboard)</li> <li> Alle Services sind aktiv: <code>systemctl status wazuh-*</code> und <code>filebeat</code></li> <li> Alle erforderlichen Ports h\u00f6ren: 1514, 1515, 55000, 9200, 5601</li> <li> Indexer Cluster-Health ist GREEN oder YELLOW (nicht RED)</li> <li> Dashboard ist \u00fcber HTTPS erreichbar</li> <li> Dashboard-Login funktioniert (mit korrekten Credentials)</li> <li> Neue Events werden im Indexer gespeichert (Datenfluss funktioniert)</li> <li> Filebeat l\u00e4uft ohne Fehler (check <code>journalctl -u filebeat</code>)</li> <li> Keine kritischen Fehler in journalctl-Logs (Indexer/Manager/Dashboard/Filebeat)</li> <li> Post-Health Snapshot wurde erstellt und im Ticket dokumentiert</li> <li> Test-Event wurde erfolgreich verarbeitet (optional aber empfohlen)</li> </ul> <p>Dokumentation im Change-Ticket: - Pre-Upgrade Health Snapshot (vollst\u00e4ndig) - Backup/Snapshot-ID dokumentiert - Upgrade-Start und -Ende Zeitstempel - Zielversion dokumentiert - Post-Upgrade Health Snapshot (vollst\u00e4ndig) - Alle Abweichungen und Findings dokumentiert - Abschlussmeldung an Kunde vorbereitet</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#10-rollback-verfahren","title":"10) Rollback-Verfahren","text":"<p>Wann Rollback durchf\u00fchren:</p> <p>F\u00fchren Sie einen Rollback durch, wenn: - Indexer Cluster-Health = RED nach Upgrade - Kritische Services starten nicht (nach mehreren Versuchen) - Datenfluss ist dauerhaft unterbrochen - Dashboard ist nicht erreichbar/nicht funktional - Authentifizierung/Authorization fehlschl\u00e4gt - Performance-Degradation ist inakzeptabel - Kritische Funktionalit\u00e4t ist verloren - Upgrade-Zeitfenster wird \u00fcberschritten ohne erfolgreichen Abschluss</p> <p>Rollback-Entscheidung: - Treffen Sie die Entscheidung schnell (innerhalb von 15-30 Minuten nach Problem-Erkennung) - Dokumentieren Sie den Grund f\u00fcr Rollback im Change-Ticket - Informieren Sie alle Stakeholder \u00fcber Rollback-Entscheidung - Planen Sie Post-Mortem und erneuten Upgrade-Versuch</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#101-rollback-methode-1-vmvolume-snapshot-restore-empfohlen","title":"10.1 Rollback-Methode 1: VM/Volume Snapshot Restore (EMPFOHLEN)","text":"<p>Vorteile: - Schnellste Methode - Garantiert konsistenter Zustand - Kein Risiko durch Paket-Inkompatibilit\u00e4ten - Bew\u00e4hrte Methode</p> <p>Voraussetzungen: - VM- oder Volume-Snapshot wurde vor Upgrade erstellt - Snapshot-ID ist dokumentiert</p> <p>Durchf\u00fchrung:</p> <pre><code># WICHTIG: Diese Schritte erfolgen auf Ihrer Virtualisierungs-/Storage-Plattform!\n\n# 1. Aktuelle VM/Volume stoppen (\u00fcber Hypervisor/Cloud-Console)\n#    - VMware: VM herunterfahren\n#    - Proxmox: VM stoppen\n#    - AWS: Instance stoppen\n#    - Azure: VM stoppen\n\n# 2. Snapshot wiederherstellen (\u00fcber Hypervisor/Cloud-Console)\n#    - W\u00e4hlen Sie den dokumentierten Pre-Upgrade Snapshot\n#    - F\u00fchren Sie Restore durch\n#    - Bei Volume-Snapshots: Volumes wiederherstellen und neu attachieren\n\n# 3. VM/System starten\n\n# 4. Nach dem Start: Services validieren\nssh user@wazuh-server\n\n# Validierung nach Snapshot-Restore:\necho \"=== Validation After Snapshot Restore ===\"\n\n# Versionen pr\u00fcfen (sollten alte Versionen sein)\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)|filebeat'\n\n# Services pr\u00fcfen\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Health-Check durchf\u00fchren\n# F\u00fchren Sie Runbook 0 (Health Snapshot) aus\n\n# Funktionalit\u00e4t best\u00e4tigen\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\ncurl -I http://127.0.0.1:5601\n</code></pre> <p>Erwartetes Ergebnis: - System ist im Pre-Upgrade Zustand - Alle Services laufen - Alte Versionen sind installiert - Funktionalit\u00e4t ist wiederhergestellt</p> <p>Dokumentation: - Rollback-Zeitstempel im Ticket - Rollback-Methode dokumentieren - Grund f\u00fcr Rollback dokumentieren - Post-Rollback Health Snapshot erstellen</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#102-rollback-methode-2-paket-downgrade-nur-wenn-snapshot-nicht-verfugbar","title":"10.2 Rollback-Methode 2: Paket-Downgrade (NUR wenn Snapshot nicht verf\u00fcgbar)","text":"<p>\u26a0\ufe0f WICHTIG: Diese Methode hat Risiken und sollte nur als letzte Option verwendet werden!</p> <p>Risiken: - Konfigurationsdateien k\u00f6nnten inkompatibel sein - Datenbank-Schemas k\u00f6nnten ge\u00e4ndert worden sein - Plugins k\u00f6nnten inkompatibel sein - Nicht garantiert funktionsf\u00e4hig</p> <p>Voraussetzungen: - Alte Versionen sind noch im APT-Repository verf\u00fcgbar - Konfigurations-Backup wurde erstellt (Schritt 2.2)</p> <p>Durchf\u00fchrung:</p> <pre><code>set -euo pipefail\n\necho \"=== PAKET-DOWNGRADE ROLLBACK START ===\"\necho \"WARNING: This is a risky operation. VM snapshot restore is preferred!\"\necho \"\"\n\n# 1. Verf\u00fcgbare Versionen ermitteln\necho \"=== Available Package Versions ===\"\napt-cache madison wazuh-indexer | head -5\napt-cache madison wazuh-manager | head -5\napt-cache madison wazuh-dashboard | head -5\napt-cache madison filebeat | head -5\n\n# 2. Zielversion f\u00fcr Downgrade festlegen\n# WICHTIG: Ersetzen Sie mit der tats\u00e4chlichen alten Version!\nOLD_VERSION=\"4.7.0-1\"  # BEISPIEL - ANPASSEN!\n\necho \"\"\necho \"Downgrading to version: $OLD_VERSION\"\nread -p \"Press Enter to continue or Ctrl+C to abort...\"\n\n# 3. Alle Services stoppen\necho \"Stopping all services...\"\nsystemctl stop filebeat\nsystemctl stop wazuh-dashboard\nsystemctl stop wazuh-manager\nsystemctl stop wazuh-indexer\n\n# 4. Packages downgraden (in umgekehrter Upgrade-Reihenfolge)\necho \"Downgrading packages...\"\n\n# Dashboard\napt-get install -y --allow-downgrades wazuh-dashboard=$OLD_VERSION || echo \"WARN: Dashboard downgrade failed\"\n\n# Filebeat (behalten oder zu passender Version)\n# apt-get install -y --allow-downgrades filebeat=FILEBEAT_VERSION\n\n# Manager\napt-get install -y --allow-downgrades wazuh-manager=$OLD_VERSION || echo \"WARN: Manager downgrade failed\"\n\n# Indexer\napt-get install -y --allow-downgrades wazuh-indexer=$OLD_VERSION || echo \"WARN: Indexer downgrade failed\"\n\n# 5. Konfigurationen wiederherstellen (falls n\u00f6tig)\necho \"Checking if configuration restore is needed...\"\n\n# Backup-Verzeichnis ermitteln (letztes Backup)\nLATEST_BACKUP=$(ls -td /root/wazuh_backup_* 2&gt;/dev/null | head -1)\nif [ -n \"$LATEST_BACKUP\" ]; then\n    echo \"Found backup: $LATEST_BACKUP\"\n\n    # Optional: Configs wiederherstellen\n    # tar -xzf \"$LATEST_BACKUP/wazuh_indexer_etc.tgz\" -C /\n    # tar -xzf \"$LATEST_BACKUP/wazuh_dashboard_etc.tgz\" -C /\n    # etc.\n\n    echo \"Review backup and restore configs if needed\"\nelse\n    echo \"WARN: No backup found!\"\nfi\n\n# 6. Services starten\necho \"Starting services...\"\nsystemctl start wazuh-indexer\nsleep 10\nsystemctl start wazuh-manager\nsleep 5\nsystemctl start wazuh-dashboard\nsleep 5\nsystemctl start filebeat\n\n# 7. Status pr\u00fcfen\necho \"=== Services Status ===\"\nsystemctl status wazuh-indexer --no-pager || true\nsystemctl status wazuh-manager --no-pager || true\nsystemctl status wazuh-dashboard --no-pager || true\nsystemctl status filebeat --no-pager || true\n\necho \"\"\necho \"=== PAKET-DOWNGRADE ROLLBACK COMPLETE ===\"\necho \"IMPORTANT: Perform full validation (Runbook 0) immediately!\"\n</code></pre> <p>Post-Downgrade Validierung: <pre><code># Versionen best\u00e4tigen\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)|filebeat'\n\n# Services validieren\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Indexer Health\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n\n# Dashboard Zugriff\ncurl -I http://127.0.0.1:5601\n\n# F\u00fchren Sie RUNBOOK 0 vollst\u00e4ndig aus\n</code></pre></p> <p>M\u00f6gliche Probleme nach Downgrade: - Indexer startet nicht \u2192 JVM-Settings aus Backup wiederherstellen - Dashboard l\u00e4dt nicht \u2192 opensearch_dashboards.yml aus Backup wiederherstellen - Manager startet nicht \u2192 ossec.conf pr\u00fcfen, ggf. aus Backup wiederherstellen - Security-Init erforderlich \u2192 <code>/usr/share/wazuh-indexer/bin/indexer-security-init.sh</code> ausf\u00fchren</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#103-post-rollback-aktionen","title":"10.3 Post-Rollback Aktionen","text":"<p>Unabh\u00e4ngig von der Rollback-Methode:</p> <ol> <li>Validierung:</li> <li>F\u00fchren Sie Runbook 0 (Health Snapshot) vollst\u00e4ndig aus</li> <li>Dokumentieren Sie Post-Rollback Status im Ticket</li> <li> <p>Best\u00e4tigen Sie Funktionalit\u00e4t (Dashboard Login, Datenfluss)</p> </li> <li> <p>Kommunikation:</p> </li> <li>Informieren Sie alle Stakeholder \u00fcber erfolgreichen Rollback</li> <li>Kommunizieren Sie gesch\u00e4tzten Zeitpunkt f\u00fcr erneuten Upgrade-Versuch</li> <li> <p>Update im Change-Ticket mit Rollback-Zeitstempel</p> </li> <li> <p>Root Cause Analysis:</p> </li> <li>Erstellen Sie Incident-Report</li> <li>Dokumentieren Sie was schief gelaufen ist</li> <li>Identifizieren Sie L\u00fccken in Vorbereitung oder Prozess</li> <li> <p>Planen Sie Ma\u00dfnahmen zur Vermeidung beim n\u00e4chsten Versuch</p> </li> <li> <p>N\u00e4chste Schritte:</p> </li> <li>Erstellen Sie Follow-up Ticket f\u00fcr erneuten Upgrade-Versuch</li> <li>Addressieren Sie identifizierte Probleme vor erneutem Versuch</li> <li>Erw\u00e4gen Sie Upgrade in Test-Umgebung zuerst</li> <li>Planen Sie l\u00e4ngeres Wartungsfenster f\u00fcr erneuten Versuch</li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#104-rollback-vermeidung-praventive-manahmen","title":"10.4 Rollback-Vermeidung (Pr\u00e4ventive Ma\u00dfnahmen)","text":"<p>Vor dem Upgrade: - Test-Upgrade in Staging-Umgebung durchf\u00fchren - Release Notes und Known Issues lesen - Community-Foren f\u00fcr bekannte Probleme pr\u00fcfen - L\u00e4ngeres Wartungsfenster einplanen (Zeitpuffer 50-100%) - Alle Voraussetzungen doppelt pr\u00fcfen</p> <p>W\u00e4hrend des Upgrades: - Jeden Schritt einzeln validieren bevor zum n\u00e4chsten \u00fcbergehen - Bei ersten Warnzeichen stoppen und analysieren - Nicht unter Zeitdruck Schritte \u00fcberspringen - Bei Unsicherheit: Rollback fr\u00fcher als sp\u00e4ter durchf\u00fchren</p> <p>Lessons Learned dokumentieren: - Jedes Upgrade (erfolgreich oder nicht) dokumentieren - Best Practices aktualisieren - Runbook bei Bedarf anpassen - Team-Wissen teilen</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#11-troubleshooting-guide","title":"11) Troubleshooting Guide","text":""},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#haufige-probleme-und-losungen","title":"H\u00e4ufige Probleme und L\u00f6sungen","text":""},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-indexer-startet-nach-upgrade-nicht","title":"Problem: Indexer startet nach Upgrade nicht","text":"<p>Symptome: - <code>systemctl status wazuh-indexer</code> zeigt \"failed\" oder \"inactive\" - Port 9200 nicht erreichbar</p> <p>Diagnose: <pre><code>journalctl -u wazuh-indexer -n 500 --no-pager | less\ntail -100 /var/log/wazuh-indexer/wazuh-cluster.log\n</code></pre></p> <p>H\u00e4ufige Ursachen und L\u00f6sungen:</p> <ol> <li> <p>JVM Heap Size Problem: <pre><code># Pr\u00fcfen Sie verf\u00fcgbaren RAM\nfree -h\n\n# JVM Settings anpassen (falls n\u00f6tig)\nnano /etc/wazuh-indexer/jvm.options\n# Empfohlen: -Xms2g -Xmx2g f\u00fcr 4GB RAM, -Xms4g -Xmx4g f\u00fcr 8GB RAM\n\n# Service neu starten\nsystemctl restart wazuh-indexer\n</code></pre></p> </li> <li> <p>Berechtigungsprobleme: <pre><code># Berechtigungen korrigieren\nchown -R wazuh-indexer:wazuh-indexer /var/lib/wazuh-indexer\nchown -R wazuh-indexer:wazuh-indexer /usr/share/wazuh-indexer\nchown -R wazuh-indexer:wazuh-indexer /etc/wazuh-indexer\nchown -R wazuh-indexer:wazuh-indexer /var/log/wazuh-indexer\n\nsystemctl restart wazuh-indexer\n</code></pre></p> </li> <li> <p>Disk voll: <pre><code>df -h\n# Falls Disk voll: Alte Logs/Indices l\u00f6schen oder Disk erweitern\n</code></pre></p> </li> <li> <p>Port bereits belegt: <pre><code>ss -lntp | grep :9200\n# Falls Port belegt: Anderen Prozess identifizieren und stoppen\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-manager-startet-nicht-nach-upgrade","title":"Problem: Manager startet nicht nach Upgrade","text":"<p>Symptome: - <code>systemctl status wazuh-manager</code> zeigt \"failed\" - Keine Verbindung auf Port 1514/1515</p> <p>Diagnose: <pre><code>journalctl -u wazuh-manager -n 500 --no-pager\ntail -200 /var/ossec/logs/ossec.log\n</code></pre></p> <p>L\u00f6sungen:</p> <ol> <li> <p>Konfigurationsfehler: <pre><code># Konfiguration testen\n/var/ossec/bin/wazuh-control start\n# Fehler werden in Ausgabe angezeigt\n\n# Falls Config-Fehler: Aus Backup wiederherstellen\nLATEST_BACKUP=$(ls -td /root/wazuh_backup_* 2&gt;/dev/null | head -1)\ntar -xzf \"$LATEST_BACKUP/var_ossec_etc.tgz\" -C /\n\nsystemctl restart wazuh-manager\n</code></pre></p> </li> <li> <p>Indexer nicht erreichbar: <pre><code># Manager kann starten aber mit Warnings wenn Indexer nicht da ist\n# Erst Indexer fixen, dann Manager neu starten\nsystemctl restart wazuh-manager\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-dashboard-nicht-erreichbar","title":"Problem: Dashboard nicht erreichbar","text":"<p>Symptome: - Port 5601 antwortet nicht - Browser zeigt \"Connection refused\" oder Timeout</p> <p>Diagnose: <pre><code>systemctl status wazuh-dashboard\njournalctl -u wazuh-dashboard -n 500 --no-pager\ntail -100 /var/log/wazuh-dashboard/opensearch_dashboards.log\n</code></pre></p> <p>L\u00f6sungen:</p> <ol> <li> <p>Indexer-Verbindungsproblem: <pre><code># Dashboard ben\u00f6tigt Indexer zum Starten\n# Pr\u00fcfen Sie Indexer-Status\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health\n\n# Falls Indexer OK: Dashboard Config pr\u00fcfen\ngrep \"opensearch.hosts\" /etc/wazuh-dashboard/opensearch_dashboards.yml\n</code></pre></p> </li> <li> <p>Port-Konflikt: <pre><code>ss -lntp | grep :5601\n# Falls Port belegt: Anderen Prozess stoppen\n</code></pre></p> </li> <li> <p>Berechtigungen: <pre><code>chown -R wazuh-dashboard:wazuh-dashboard /usr/share/wazuh-dashboard\nchown -R wazuh-dashboard:wazuh-dashboard /etc/wazuh-dashboard\nchown -R wazuh-dashboard:wazuh-dashboard /var/lib/wazuh-dashboard\nsystemctl restart wazuh-dashboard\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-filebeat-lauft-aber-keine-events-im-indexer","title":"Problem: Filebeat l\u00e4uft, aber keine Events im Indexer","text":"<p>Symptome: - Filebeat Service l\u00e4uft - Aber keine neuen wazuh-alerts-* Indices oder keine neuen Events</p> <p>Diagnose: <pre><code>journalctl -u filebeat -n 500 --no-pager\nfilebeat test output\nfilebeat test config\n</code></pre></p> <p>L\u00f6sungen:</p> <ol> <li> <p>Verbindungsproblem zum Indexer: <pre><code># Credentials pr\u00fcfen\ngrep -A5 \"output.elasticsearch:\" /etc/filebeat/filebeat.yml\n\n# Manueller Verbindungstest\ncurl -sk -u &lt;user&gt;:&lt;pass&gt; https://127.0.0.1:9200/\n</code></pre></p> </li> <li> <p>Template/Pipeline nicht geladen: <pre><code># Template und Pipelines neu laden\nfilebeat setup --pipelines\nfilebeat setup --index-management -E output.logstash.enabled=false\n\nsystemctl restart filebeat\n</code></pre></p> </li> <li> <p>Falsche Berechtigungen auf Wazuh-Logs: <pre><code># Filebeat muss /var/ossec/logs/alerts/alerts.json lesen k\u00f6nnen\nls -l /var/ossec/logs/alerts/alerts.json\nchmod 644 /var/ossec/logs/alerts/alerts.json\nsystemctl restart filebeat\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-cluster-health-red","title":"Problem: Cluster Health = RED","text":"<p>Symptome: - <code>curl -k -u admin:admin https://127.0.0.1:9200/_cluster/health</code> zeigt \"red\"</p> <p>Diagnose: <pre><code># Detaillierte Cluster-Info\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n\n# Unassigned Shards identifizieren\ncurl -sk -u admin:admin 'https://127.0.0.1:9200/_cat/shards?v&amp;h=index,shard,prirep,state,unassigned.reason' | grep UNASSIGNED\n</code></pre></p> <p>L\u00f6sungen:</p> <ol> <li> <p>Shard Allocation pr\u00fcfen: <pre><code># Allocation Status\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/settings?pretty\n\n# Falls noch auf \"primaries\": Zur\u00fcck auf \"all\"\ncurl -X PUT \"https://127.0.0.1:9200/_cluster/settings\" -u admin:admin -k \\\n  -H 'Content-Type: application/json' -d'\n{\n  \"persistent\": { \"cluster.routing.allocation.enable\": \"all\" }\n}\n'\n</code></pre></p> </li> <li> <p>Disk Watermark Problem: <pre><code>df -h\n# Falls Disk &gt; 85%: Alte Indices l\u00f6schen oder Disk erweitern\n\n# Tempor\u00e4r Watermark anpassen (nur f\u00fcr Recovery!)\ncurl -X PUT \"https://127.0.0.1:9200/_cluster/settings\" -u admin:admin -k \\\n  -H 'Content-Type: application/json' -d'\n{\n  \"transient\": {\n    \"cluster.routing.allocation.disk.watermark.low\": \"95%\",\n    \"cluster.routing.allocation.disk.watermark.high\": \"98%\"\n  }\n}\n'\n</code></pre></p> </li> <li> <p>Corrupted Shards: <pre><code># Als letztes Mittel: Corrupted Index l\u00f6schen\n# ACHTUNG: Datenverlust f\u00fcr diesen Index!\ncurl -X DELETE \"https://127.0.0.1:9200/&lt;index-name&gt;\" -u admin:admin -k\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-login-am-dashboard-funktioniert-nicht","title":"Problem: Login am Dashboard funktioniert nicht","text":"<p>Symptome: - Dashboard l\u00e4dt, aber Login schl\u00e4gt fehl mit \"Incorrect username or password\" - Oder: \"Authentication Exception\"</p> <p>L\u00f6sungen:</p> <ol> <li> <p>Security-Konfiguration neu anwenden: <pre><code>systemctl stop wazuh-dashboard\n/usr/share/wazuh-indexer/bin/indexer-security-init.sh\nsystemctl start wazuh-dashboard\n</code></pre></p> </li> <li> <p>Passwort zur\u00fccksetzen (Admin-User): <pre><code># Hash f\u00fcr neues Passwort generieren\n/usr/share/wazuh-indexer/plugins/opensearch-security/tools/hash.sh -p NewPassword123\n\n# In internal_users.yml eintragen\nnano /etc/wazuh-indexer/opensearch-security/internal_users.yml\n# Ersetzen Sie den Hash beim admin-User\n\n# Security neu laden\n/usr/share/wazuh-indexer/bin/indexer-security-init.sh\n</code></pre></p> </li> </ol>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#problem-version-conflict-oder-compatibility-issues","title":"Problem: \"Version Conflict\" oder \"Compatibility Issues\"","text":"<p>Symptome: - Fehlermeldungen \u00fcber inkompatible Versionen - Dashboard zeigt Warnungen \u00fcber Index-Template Versionen</p> <p>L\u00f6sung: <pre><code># Versionen aller Komponenten pr\u00fcfen\ndpkg -l | egrep 'wazuh-(indexer|manager|dashboard)'\n\n# Falls Versionen nicht identisch: Upgrade/Downgrade auf einheitliche Version\napt-get install wazuh-indexer=X.Y.Z-1 wazuh-manager=X.Y.Z-1 wazuh-dashboard=X.Y.Z-1\n\n# Template neu laden\nTARGET_VERSION=\"X.Y.Z\"\ncurl -so /etc/filebeat/wazuh-template.json \\\n  \"https://raw.githubusercontent.com/wazuh/wazuh/v${TARGET_VERSION}/extensions/elasticsearch/7.x/wazuh-template.json\"\n\nfilebeat setup --index-management -E output.logstash.enabled=false\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#notfall-kommandos","title":"Notfall-Kommandos","text":"<p>Komplett Neustart aller Services (in korrekter Reihenfolge): <pre><code>systemctl stop filebeat wazuh-dashboard wazuh-manager wazuh-indexer\nsleep 5\nsystemctl start wazuh-indexer\nsleep 15\nsystemctl start wazuh-manager\nsleep 10\nsystemctl start wazuh-dashboard\nsleep 10\nsystemctl start filebeat\n\n# Status pr\u00fcfen\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n</code></pre></p> <p>Alle Logs an einer Stelle sammeln (f\u00fcr Support): <pre><code>SUPPORT_DIR=\"/tmp/wazuh_support_$(date +%F_%H%M%S)\"\nmkdir -p \"$SUPPORT_DIR\"\n\n# System-Info\nuname -a &gt; \"$SUPPORT_DIR/system_info.txt\"\ndf -h &gt;&gt; \"$SUPPORT_DIR/system_info.txt\"\nfree -h &gt;&gt; \"$SUPPORT_DIR/system_info.txt\"\n\n# Versionen\ndpkg -l | egrep 'wazuh|filebeat' &gt; \"$SUPPORT_DIR/packages.txt\"\n\n# Services Status\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat &gt; \"$SUPPORT_DIR/services_status.txt\"\n\n# Logs\njournalctl -u wazuh-indexer -n 1000 --no-pager &gt; \"$SUPPORT_DIR/indexer.log\"\njournalctl -u wazuh-manager -n 1000 --no-pager &gt; \"$SUPPORT_DIR/manager.log\"\njournalctl -u wazuh-dashboard -n 1000 --no-pager &gt; \"$SUPPORT_DIR/dashboard.log\"\njournalctl -u filebeat -n 1000 --no-pager &gt; \"$SUPPORT_DIR/filebeat.log\"\n\n# Cluster State\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty &gt; \"$SUPPORT_DIR/cluster_health.json\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/nodes?v &gt; \"$SUPPORT_DIR/nodes.txt\"\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cat/indices?v &gt; \"$SUPPORT_DIR/indices.txt\"\n\n# Archivieren\ntar -czf \"$SUPPORT_DIR.tar.gz\" -C /tmp \"$(basename $SUPPORT_DIR)\"\necho \"Support bundle created: $SUPPORT_DIR.tar.gz\"\n</code></pre></p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#12-anhang","title":"12) Anhang","text":""},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#referenzen","title":"Referenzen","text":"<ul> <li>Offizielle Wazuh Dokumentation:</li> <li>Upgrade Guide: https://documentation.wazuh.com/current/upgrade-guide/</li> <li>Central Components: https://documentation.wazuh.com/current/upgrade-guide/upgrading-central-components.html</li> <li> <p>Release Notes: https://documentation.wazuh.com/current/release-notes/</p> </li> <li> <p>Community-Ressourcen:</p> </li> <li>Wazuh Slack: https://wazuh.com/community/join-us-on-slack/</li> <li>GitHub Issues: https://github.com/wazuh/wazuh/issues</li> <li>Wazuh Google Groups: https://groups.google.com/forum/#!forum/wazuh</li> </ul>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#nutzliche-befehle-quick-reference","title":"N\u00fctzliche Befehle (Quick Reference)","text":"<pre><code># Status aller Wazuh-Services\nsystemctl status wazuh-indexer wazuh-manager wazuh-dashboard filebeat\n\n# Cluster Health\ncurl -sk -u admin:admin https://127.0.0.1:9200/_cluster/health?pretty\n\n# Neueste Alerts anzeigen\ncurl -sk -u admin:admin 'https://127.0.0.1:9200/wazuh-alerts-*/_search?size=5&amp;sort=@timestamp:desc&amp;pretty'\n\n# Aktive Agents\n/var/ossec/bin/agent_control -l\n\n# Wazuh Manager Info\n/var/ossec/bin/wazuh-control info\n\n# Logs in Echtzeit verfolgen\njournalctl -u wazuh-manager -f\ntail -f /var/ossec/logs/ossec.log\n</code></pre>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#kontakte-und-eskalation","title":"Kontakte und Eskalation","text":"<p>Bei kritischen Problemen w\u00e4hrend des Upgrades: 1. Entscheiden Sie schnell: Fortfahren oder Rollback? 2. Dokumentieren Sie alle Schritte und Fehlermeldungen 3. Bei Unsicherheit: Rollback durchf\u00fchren 4. Support kontaktieren mit gesammelten Logs</p> <p>Eskalationsweg: 1. Level 1: Runbook Troubleshooting-Sektion konsultieren 2. Level 2: Wazuh Community (Slack/Forum) fragen 3. Level 3: Wazuh Support kontaktieren (falls Support-Vertrag) 4. Level 4: Post-Mortem und lessons learned dokumentieren</p>"},{"location":"runbooks/RUNBOOK_WAZUH_UPGRADE_AIO_UBUNTU/#anderungshistorie","title":"\u00c4nderungshistorie","text":"Version Datum Autor \u00c4nderungen 1.3 2026-01 System Umfassende \u00dcberarbeitung: Erweiterte Voraussetzungen, verbesserte Validierungsschritte, detailliertes Rollback-Verfahren, neue Troubleshooting-Sektion 1.2 - - Fr\u00fchere Version 1.1 - - Initiale Version <p>Ende des Runbooks</p>"},{"location":"upgrade-guides/","title":"Upgrade Guides","text":"<p>Version-specific upgrade procedures for Wazuh SIEM components. Each guide is tailored to a specific Wazuh release version and includes version-specific considerations, known issues, and validated upgrade paths.</p>"},{"location":"upgrade-guides/#about-versioned-upgrade-guides","title":"\ud83d\udcda About Versioned Upgrade Guides","text":"<p>Upgrade guides are versioned using mike to maintain documentation for multiple Wazuh releases. This allows you to:</p> <ul> <li>Access upgrade procedures for your specific version</li> <li>Review historical upgrade paths</li> <li>Understand version-specific requirements and changes</li> </ul>"},{"location":"upgrade-guides/#available-upgrade-guides","title":"\ud83c\udfaf Available Upgrade Guides","text":""},{"location":"upgrade-guides/#wazuh-4x-series","title":"Wazuh 4.x Series","text":""},{"location":"upgrade-guides/#wazuh-412-upgrade-guide","title":"Wazuh 4.12 Upgrade Guide","text":"<p>Latest stable release with enhanced detection capabilities and performance improvements.</p> <p>Key Changes: - Improved SCA (Security Configuration Assessment) - Enhanced agent communication protocol - Dashboard UI improvements - Performance optimizations for large deployments</p> <p>Upgrade Path: 4.10.x, 4.11.x \u2192 4.12.0</p>"},{"location":"upgrade-guides/#wazuh-411-upgrade-guide-coming-soon","title":"Wazuh 4.11 Upgrade Guide (Coming Soon)","text":"<p>Previous stable release with focus on reliability.</p>"},{"location":"upgrade-guides/#wazuh-410-upgrade-guide-coming-soon","title":"Wazuh 4.10 Upgrade Guide (Coming Soon)","text":"<p>Long-term support release.</p>"},{"location":"upgrade-guides/#version-selection-guide","title":"Version Selection Guide","text":"From Version To Version Guide Complexity Downtime 4.11.x 4.12.x 4.12 Low ~30 min 4.10.x 4.12.x 4.12 Medium ~45 min 4.9.x 4.12.x 4.12 Medium ~45 min 4.8.x or older 4.12.x Contact Support High ~90 min"},{"location":"upgrade-guides/#how-to-use-upgrade-guides","title":"\ud83d\ude80 How to Use Upgrade Guides","text":""},{"location":"upgrade-guides/#1-determine-your-current-version","title":"1. Determine Your Current Version","text":"<pre><code># Check manager version\n/var/ossec/bin/wazuh-control info | grep VERSION\n\n# Check indexer version\ncurl -sk -u admin:admin https://127.0.0.1:9200/ | grep number\n\n# Check dashboard version\ndpkg -l | grep wazuh-dashboard\n</code></pre>"},{"location":"upgrade-guides/#2-select-target-version","title":"2. Select Target Version","text":"<ul> <li>Review release notes for target version</li> <li>Check compatibility requirements</li> <li>Verify your infrastructure meets prerequisites</li> <li>Review known issues and breaking changes</li> </ul>"},{"location":"upgrade-guides/#3-review-upgrade-path","title":"3. Review Upgrade Path","text":"<ul> <li>Ensure your upgrade path is supported</li> <li>Note any intermediate versions required</li> <li>Plan for configuration migrations if needed</li> </ul>"},{"location":"upgrade-guides/#4-follow-version-specific-guide","title":"4. Follow Version-Specific Guide","text":"<ul> <li>Use the guide for your target version</li> <li>Follow all version-specific prerequisites</li> <li>Complete all validation steps</li> <li>Document version numbers in metadata</li> </ul>"},{"location":"upgrade-guides/#version-specific-considerations","title":"\ud83d\udccb Version-Specific Considerations","text":""},{"location":"upgrade-guides/#component-version-compatibility","title":"Component Version Compatibility","text":"<p>Critical Rule: Manager version must be \u2265 Agent version</p> <pre><code>\u2705 SUPPORTED:\n   Manager 4.12.0 + Agent 4.11.0\n   Manager 4.12.0 + Agent 4.12.0\n\n\u274c NOT SUPPORTED:\n   Manager 4.11.0 + Agent 4.12.0\n</code></pre>"},{"location":"upgrade-guides/#upgrade-order-for-central-components","title":"Upgrade Order for Central Components","text":"<p>Always upgrade in this order: 1. Wazuh Indexer first 2. Wazuh Manager second 3. Wazuh Dashboard third 4. Filebeat last</p>"},{"location":"upgrade-guides/#agent-upgrade-strategy","title":"Agent Upgrade Strategy","text":"<p>Two approaches: - Rolling upgrade: Upgrade agents in phases (recommended for large deployments) - Batch upgrade: Upgrade all agents simultaneously (suitable for smaller environments)</p>"},{"location":"upgrade-guides/#version-specific-resources","title":"\ud83d\udd0d Version-Specific Resources","text":""},{"location":"upgrade-guides/#wazuh-412","title":"Wazuh 4.12","text":"<ul> <li>Release Notes</li> <li>Upgrade Guide</li> <li>Known Issues</li> <li>Migration Guide</li> </ul>"},{"location":"upgrade-guides/#official-wazuh-documentation","title":"Official Wazuh Documentation","text":"<ul> <li>Current Documentation</li> <li>Upgrade Guide</li> <li>Compatibility Matrix</li> </ul>"},{"location":"upgrade-guides/#version-metadata-requirements","title":"\ud83d\udcdd Version Metadata Requirements","text":"<p>When following an upgrade guide, always document:</p> <pre><code>current_version:\n  indexer: \"4.11.0\"\n  manager: \"4.11.0\"\n  dashboard: \"4.11.0\"\n  filebeat: \"7.10.2\"\n\ntarget_version:\n  indexer: \"4.12.0\"\n  manager: \"4.12.0\"\n  dashboard: \"4.12.0\"\n  filebeat: \"7.10.2\"\n\nupgrade_path: \"4.11.0 -&gt; 4.12.0\"\nguide_version: \"4.12\"\n</code></pre>"},{"location":"upgrade-guides/#using-mike-for-version-management","title":"\ud83d\udd04 Using Mike for Version Management","text":"<p>This documentation uses mike for managing versioned content. See Deployment Guide for details.</p>"},{"location":"upgrade-guides/#quick-reference","title":"Quick Reference","text":"<pre><code># Deploy a specific version\nmike deploy 4.12 latest\n\n# List all versions\nmike list\n\n# Set default version\nmike set-default latest\n\n# Delete a version\nmike delete 4.11\n</code></pre>"},{"location":"upgrade-guides/#pre-upgrade-checklist","title":"\ud83d\udee1\ufe0f Pre-Upgrade Checklist","text":"<p>Before starting any upgrade:</p> <ul> <li> Review target version release notes</li> <li> Check compatibility matrix</li> <li> Verify upgrade path is supported</li> <li> Review version-specific known issues</li> <li> Create backup/snapshot of current system</li> <li> Document current versions</li> <li> Schedule maintenance window</li> <li> Get change approval</li> <li> Notify stakeholders</li> </ul>"},{"location":"upgrade-guides/#related-resources","title":"\ud83d\udd17 Related Resources","text":"<ul> <li>Runbooks - Detailed upgrade procedures</li> <li>Checklists - Upgrade tracking templates</li> <li>Reference - Command references</li> <li>Official Wazuh Releases</li> </ul>"},{"location":"upgrade-guides/4.12/","title":"Wazuh 4.12 Upgrade Guide","text":"<p>This guide covers upgrading to Wazuh 4.12.x from previous 4.x versions.</p>"},{"location":"upgrade-guides/4.12/#version-information","title":"\ud83d\udcca Version Information","text":"<ul> <li>Target Version: 4.12.0</li> <li>Release Date: January 2026 (example)</li> <li>Support Status: Current stable release</li> <li>Upgrade Type: Minor version upgrade</li> </ul>"},{"location":"upgrade-guides/4.12/#whats-new-in-wazuh-412","title":"\ud83c\udfaf What's New in Wazuh 4.12","text":""},{"location":"upgrade-guides/4.12/#key-features","title":"Key Features","text":"<ul> <li>Enhanced Security Configuration Assessment (SCA)</li> <li>Improved agent communication protocol with better compression</li> <li>Dashboard UI improvements for better user experience</li> <li>Performance optimizations for deployments with &gt;10,000 agents</li> <li>Enhanced threat intelligence integration</li> <li>Improved log analysis capabilities</li> </ul>"},{"location":"upgrade-guides/4.12/#component-updates","title":"Component Updates","text":"<ul> <li>Indexer: OpenSearch-based improvements</li> <li>Manager: Enhanced detection rules and decoders</li> <li>Dashboard: UI/UX improvements, new widgets</li> <li>Agents: Better resource management, improved stability</li> </ul>"},{"location":"upgrade-guides/4.12/#api-changes","title":"API Changes","text":"<ul> <li>New endpoints for agent group management</li> <li>Enhanced authentication mechanisms</li> <li>Improved query performance</li> </ul>"},{"location":"upgrade-guides/4.12/#prerequisites","title":"\ud83d\udd27 Prerequisites","text":""},{"location":"upgrade-guides/4.12/#system-requirements","title":"System Requirements","text":"<p>Minimum Requirements: - OS: Ubuntu 20.04 LTS or later, Rocky/AlmaLinux 8+ - RAM: 4 GB (8 GB recommended for production) - Disk: 50 GB free space (more for larger deployments) - CPU: 2 cores (4+ recommended)</p> <p>Network Requirements: - Outbound internet access to packages.wazuh.com - Proper firewall rules for Wazuh ports (1514, 1515, 55000, 9200, 5601)</p>"},{"location":"upgrade-guides/4.12/#version-compatibility","title":"Version Compatibility","text":"<p>Supported Upgrade Paths: - \u2705 From 4.11.x to 4.12.x - Direct upgrade - \u2705 From 4.10.x to 4.12.x - Direct upgrade - \u2705 From 4.9.x to 4.12.x - Direct upgrade - \u26a0\ufe0f From 4.8.x or older - Review migration guide first</p> <p>Component Compatibility: - Filebeat: 7.10.2 (compatible with 4.12) - OpenSearch: 2.x compatible - Agents: 4.0.x to 4.12.x (Manager must be \u2265 Agent version)</p>"},{"location":"upgrade-guides/4.12/#pre-upgrade-checklist","title":"Pre-Upgrade Checklist","text":"<ul> <li> Current version documented (run version checks)</li> <li> Valid backup/snapshot created and verified</li> <li> Sufficient disk space available (minimum 20% free)</li> <li> All services currently healthy and running</li> <li> Change ticket approved</li> <li> Maintenance window scheduled</li> <li> Rollback plan documented</li> </ul>"},{"location":"upgrade-guides/4.12/#upgrade-procedure","title":"\ud83d\ude80 Upgrade Procedure","text":""},{"location":"upgrade-guides/4.12/#step-by-step-process","title":"Step-by-Step Process","text":"<p>For detailed commands and procedures, refer to: - Runbook: Wazuh Upgrade AIO Ubuntu - Checklist: Wazuh Upgrade AIO</p>"},{"location":"upgrade-guides/4.12/#high-level-overview","title":"High-Level Overview","text":"<ol> <li>Pre-Upgrade Snapshot (Section 1)</li> <li>Document current versions</li> <li>Capture service status</li> <li>Record cluster health</li> <li> <p>Check for errors in logs</p> </li> <li> <p>Upgrade Wazuh Indexer (Section 2)    <pre><code>apt-get update\napt-get install wazuh-indexer=4.12.0-1\nsystemctl restart wazuh-indexer\n</code></pre></p> </li> <li> <p>Upgrade Wazuh Manager (Section 3)    <pre><code>apt-get install wazuh-manager=4.12.0-1\nsystemctl restart wazuh-manager\n</code></pre></p> </li> <li> <p>Upgrade Wazuh Dashboard (Section 4)    <pre><code>apt-get install wazuh-dashboard=4.12.0-1\nsystemctl restart wazuh-dashboard\n</code></pre></p> </li> <li> <p>Verify Filebeat (Section 5)    <pre><code>apt-get install filebeat=7.10.2\nsystemctl restart filebeat\n</code></pre></p> </li> <li> <p>Post-Upgrade Validation (Section 6)</p> </li> <li>Verify all versions updated</li> <li>Check service status</li> <li>Test cluster health</li> <li>Validate API access</li> <li> <p>Review logs for errors</p> </li> <li> <p>Agent Upgrades (Section 7)</p> </li> <li>Plan rolling upgrade strategy</li> <li>Test with pilot group first</li> <li>Use remote upgrade capability or manual upgrade</li> </ol>"},{"location":"upgrade-guides/4.12/#known-issues","title":"\u26a0\ufe0f Known Issues","text":""},{"location":"upgrade-guides/4.12/#issue-1-dashboard-login-delay","title":"Issue #1: Dashboard Login Delay","text":"<p>Symptoms: Dashboard may take longer to respond after upgrade Cause: Index optimization in progress Resolution: Wait 5-10 minutes for initial optimization to complete</p>"},{"location":"upgrade-guides/4.12/#issue-2-agent-disconnections-rare","title":"Issue #2: Agent Disconnections (Rare)","text":"<p>Symptoms: Some agents may disconnect during manager restart Cause: Connection timeout during restart Resolution: Agents will automatically reconnect within 1-2 minutes</p>"},{"location":"upgrade-guides/4.12/#issue-3-apt-package-cache","title":"Issue #3: APT Package Cache","text":"<p>Symptoms: Upgrade fails with package not found Cause: Stale APT cache Resolution: <pre><code>apt-get clean\napt-get update\n</code></pre></p>"},{"location":"upgrade-guides/4.12/#rollback-procedure","title":"\ud83d\udd04 Rollback Procedure","text":"<p>If the upgrade fails or causes issues:</p>"},{"location":"upgrade-guides/4.12/#quick-rollback-from-snapshot","title":"Quick Rollback (from snapshot)","text":"<ol> <li>Stop all Wazuh services</li> <li>Restore from snapshot/backup</li> <li>Verify services start correctly</li> <li>Document rollback reason</li> </ol>"},{"location":"upgrade-guides/4.12/#manual-rollback-downgrade-packages","title":"Manual Rollback (downgrade packages)","text":"<pre><code># Stop services\nsystemctl stop wazuh-dashboard filebeat wazuh-manager wazuh-indexer\n\n# Downgrade packages (example to 4.11.0)\napt-get install --allow-downgrades \\\n  wazuh-indexer=4.11.0-1 \\\n  wazuh-manager=4.11.0-1 \\\n  wazuh-dashboard=4.11.0-1\n\n# Restart services in order\nsystemctl start wazuh-indexer\nsystemctl start wazuh-manager\nsystemctl start wazuh-dashboard\nsystemctl start filebeat\n</code></pre> <p>Note: Always prefer snapshot restore over manual downgrade.</p>"},{"location":"upgrade-guides/4.12/#post-upgrade-tasks","title":"\ud83d\udccb Post-Upgrade Tasks","text":""},{"location":"upgrade-guides/4.12/#immediate-tasks","title":"Immediate Tasks","text":"<ul> <li> Verify all services running</li> <li> Check cluster status</li> <li> Test API connectivity</li> <li> Validate agent connections</li> <li> Review error logs</li> </ul>"},{"location":"upgrade-guides/4.12/#within-24-hours","title":"Within 24 Hours","text":"<ul> <li> Monitor system performance</li> <li> Check agent check-ins</li> <li> Verify alert generation</li> <li> Test integrations (if any)</li> <li> Update documentation</li> </ul>"},{"location":"upgrade-guides/4.12/#within-1-week","title":"Within 1 Week","text":"<ul> <li> Plan agent upgrades</li> <li> Review new features</li> <li> Update operational procedures</li> <li> Training for new capabilities (if needed)</li> </ul>"},{"location":"upgrade-guides/4.12/#configuration-changes","title":"\ud83d\udd27 Configuration Changes","text":""},{"location":"upgrade-guides/4.12/#no-configuration-changes-required","title":"No Configuration Changes Required","text":"<p>Wazuh 4.12 maintains backward compatibility with 4.11 configurations. Existing configurations will continue to work without modifications.</p>"},{"location":"upgrade-guides/4.12/#optional-configuration-enhancements","title":"Optional Configuration Enhancements","text":"<p>Consider reviewing these new configuration options: - Enhanced SCA policies - New agent communication settings - Improved vulnerability detection rules</p> <p>See: Wazuh 4.12 Configuration Reference</p>"},{"location":"upgrade-guides/4.12/#performance-expectations","title":"\ud83d\udcca Performance Expectations","text":""},{"location":"upgrade-guides/4.12/#upgrade-duration","title":"Upgrade Duration","text":"<ul> <li>Small deployment (&lt;100 agents): 30-45 minutes</li> <li>Medium deployment (100-1000 agents): 45-60 minutes</li> <li>Large deployment (&gt;1000 agents): 60-90 minutes</li> </ul>"},{"location":"upgrade-guides/4.12/#expected-downtime","title":"Expected Downtime","text":"<ul> <li>Indexer: ~2-3 minutes</li> <li>Manager: ~5-10 minutes (agents buffer events during this time)</li> <li>Dashboard: ~2-3 minutes</li> <li>Total: ~15-20 minutes for core services</li> </ul>"},{"location":"upgrade-guides/4.12/#post-upgrade-performance","title":"Post-Upgrade Performance","text":"<ul> <li>No significant performance degradation expected</li> <li>May see improved indexing performance</li> <li>Dashboard queries may be faster</li> </ul>"},{"location":"upgrade-guides/4.12/#additional-resources","title":"\ud83d\udcda Additional Resources","text":""},{"location":"upgrade-guides/4.12/#official-documentation","title":"Official Documentation","text":"<ul> <li>Wazuh 4.12 Release Notes</li> <li>Official Upgrade Guide</li> <li>4.12 User Manual</li> </ul>"},{"location":"upgrade-guides/4.12/#ta-siemplus-resources","title":"Ta-SIEMPlus Resources","text":"<ul> <li>Upgrade Runbook</li> <li>Upgrade Checklist</li> <li>Command Reference</li> </ul>"},{"location":"upgrade-guides/4.12/#community-resources","title":"Community Resources","text":"<ul> <li>Wazuh Community Forum</li> <li>GitHub Issues</li> <li>Wazuh Slack</li> </ul>"},{"location":"upgrade-guides/4.12/#getting-help","title":"\ud83c\udd98 Getting Help","text":"<p>If you encounter issues during the upgrade:</p> <ol> <li> <p>Check the logs: <pre><code>journalctl -u wazuh-manager -n 100 --no-pager\njournalctl -u wazuh-indexer -n 100 --no-pager\n</code></pre></p> </li> <li> <p>Review known issues (above)</p> </li> <li> <p>Consult the troubleshooting guide: Reference</p> </li> <li> <p>Contact support: Your organization's support channels</p> </li> <li> <p>Community help: Wazuh forums and Slack</p> </li> </ol>"},{"location":"upgrade-guides/4.12/#success-criteria","title":"\u2705 Success Criteria","text":"<p>Your upgrade to 4.12 is successful when:</p> <ul> <li> All components show version 4.12.0</li> <li> All services are <code>active (running)</code></li> <li> Cluster health is <code>green</code></li> <li> API responds correctly</li> <li> Agents are connected and reporting</li> <li> Dashboard is accessible and functional</li> <li> No critical errors in logs</li> <li> Post-upgrade validation passed</li> </ul> <p>Last Updated: February 2026 Validated On: Ubuntu 22.04 LTS with Wazuh 4.12.0 Maintainer: Ta-SIEMPlus Team</p>"}]}